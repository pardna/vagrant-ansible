/*
 * Copyright Â© 2011-2015 by Animatron.
 * All rights are reserved.
 * 
 * Animatron Player is licensed under the MIT License.
 * 
 * v1.4, built at Tue May 10 2016 12:35:13 GMT-0400 (EDT) / 2016-05-10T16:35:13.340Z
 */
(function e$$0(z,r,b){function e(c,f){if(!r[c]){if(!z[c]){var h="function"==typeof require&&require;if(!f&&h)return h(c,!0);if(a)return a(c,!0);h=Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h;}h=r[c]={exports:{}};z[c][0].call(h.exports,function(a){var b=z[c][1][a];return e(b?b:a)},h,h.exports,e$$0,z,r,b)}return r[c].exports}for(var a="function"==typeof require&&require,f=0;f<b.length;f++)e(b[f]);return e})({1:[function(d,z,r){z.exports={createLink:function(b,e){var a=document.head||
document.getElementsByTagName("head")[0],f=document.createElement("link");f.href=b;f.rel="stylesheet";for(var c in e)e.hasOwnProperty(c)&&f.setAttribute("data-"+c,e[c]);a.appendChild(f)},createStyle:function(b,e){var a=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.type="text/css";for(var c in e)e.hasOwnProperty(c)&&f.setAttribute("data-"+c,e[c]);f.sheet?(f.innerHTML=b,f.sheet.cssText=b,a.appendChild(f)):f.styleSheet?(a.appendChild(f),f.styleSheet.cssText=
b):(f.appendChild(document.createTextNode(b)),a.appendChild(f))}}},{}],2:[function(d,z,r){d("browserify-css").createStyle(".anm-wrapper {\n  position: relative;\n}\n.anm-controls {\n  position: absolute;\n  left: 0;\n  top: 0;\n  vertical-align: top;\n  z-index: 100;\n  cursor: pointer;\n  background-color: rgba(0,0,0,0);\n}\n#anm-text-measurer-container {\n  position: absolute;\n  visibility: hidden;\n  left: -10000px;\n  top: -10000px;\n}\n",{href:"res/player.css"});z.exports=".anm-wrapper {\n  position: relative;\n}\n.anm-controls {\n  position: absolute;\n  left: 0;\n  top: 0;\n  vertical-align: top;\n  z-index: 100;\n  cursor: pointer;\n  background-color: rgba(0,0,0,0);\n}\n#anm-text-measurer-container {\n  position: absolute;\n  visibility: hidden;\n  left: -10000px;\n  top: -10000px;\n}\n"},
{"browserify-css":1}],3:[function(d,z,r){function b(){this.id=e.guid();this.tree=[];this.hash={};this.name="";this.duration=void 0;this.bgfill=null;this.height=this.width=void 0;this.factor=this.speed=this.zoom=1;this.repeat=!1;this.meta={};this.targets={};this.$prefix=null;this.__informEnabled=!0;this.__lastOverElm=null;this._laters=[];this._initHandlers()}var e=d("../utils.js"),a=e.is,f=e.iter;r=d("../constants.js");var c=d("engine"),n=d("../resource_manager.js"),h=d("../../vendor/font_detector.js"),
u=d("./element.js"),w=d("../graphics/brush.js"),m=d("../events.js"),y=m.provideEvents,x=d("../errors.js"),p=d("../loc.js").Errors,A=d("./search.js"),t={click:r.X_MCLICK,dblclick:r.X_MDCLICK,mouseup:r.X_MUP,mousedown:r.X_MDOWN,mousemove:r.X_MMOVE,mouseover:r.X_MOVER,mouseout:r.X_MOUT,keypress:r.X_KPRESS,keyup:r.X_KUP,keydown:r.X_KDOWN};b.DEFAULT_DURATION=10;y(b,[r.A_START,r.A_PAUSE,r.A_STOP,r.X_MCLICK,r.X_MDCLICK,r.X_MUP,r.X_MDOWN,r.X_MMOVE,r.X_MOVER,r.X_MOUT,r.X_KPRESS,r.X_KUP,r.X_KDOWN,r.X_ERROR]);
b.prototype.add=function(c,b,m){b?(c=new u(c,b),m&&c.changeTransform(m),this.addToTree(c)):a.arr(c)?((new u).add(c),this.addToTree(_clip)):this.addToTree(c);return this};b.prototype.remove=function(a){a.parent?a.parent.remove(a):this._unregister(a);return this};b.prototype.traverse=function(a,c){e.keys(this.hash,function(b,m){return a(m,c)});return this};b.prototype.each=function(a,c){for(var b=0,m=this.tree.length;b<m&&!1!==a(this.tree[b],c);b++);return this};b.prototype.reverseEach=function(a,c){for(var b=
this.tree.length;b--&&!1!==a(this.tree[b],c););return this};b.prototype.iter=function(a,c){f(this.tree).each(a,c);return this};b.prototype.render=function(a,c,b){a.save();this.time=c;var m=this.zoom;1!=m&&a.scale(m,m);this.bgfill&&(this.bgfill instanceof w||(this.bgfill=w.fill(this.bgfill)),this.bgfill.apply(a),a.fillRect(0,0,this.width,this.height));c=this.$prefix?this.$prefix(c,a):c;this.each(function(k){k.render(a,c,b)});a.restore()};b.prototype.jump=function(a){this.jumping||(this.jumping=!0,
e.keys(this.targets,function(c,b){b&&b.seek(a)}),this.jumping=!1)};b.prototype.jumpTo=function(c){(c=a.str(c)?this.find(c):c)&&this.jump(c.gband[0])};b.prototype.getFittingDuration=function(){var a=-Infinity;this.each(function(c){c=c._max_tpos();c>a&&(a=c)});return a};b.prototype.reset=function(){this.__informEnabled=!0;this.time=null;this.each(function(a){a.reset()});return this};b.prototype.playedIn=function(a){this.targets[a.id]=a;return this};b.prototype.dispose=function(a){a&&(this.targets[a.id]=
null);this.disposeHandlers();var c=this;this.iter(function(a){c._unregister_no_rm(a);a.dispose();return!1});return this};b.prototype.isEmpty=function(){return 0===this.tree.length};b.prototype.toString=function(){return"[ Animation "+(this.name?"'"+this.name+"'":"")+"]"};b.prototype.subscribeEvents=function(a){c.subscribeAnimationToEvents(a,this,t)};b.prototype.unsubscribeEvents=function(a){c.unsubscribeAnimationFromEvents(a,this)};b.prototype.filterEvent=function(c,b){function h(q,g){return q.firstParent(function(q){return q.subscribedTo(g)})}
var p=this;if(m.mouse(c)){var k=p.adapt(b.pos.x,b.pos.y),g=!1;p.reverseEach(function(q){q.inside(k,function(q){return a.defined(q.cur_t)&&q.fits(q.cur_t)},function(q,a){g=!0;if("mousemove"!==c){var D=h(q,c);D&&D.fire(c,b)}else if(D=h(q,"mousemove"),p.__lastOverElm)if(q.id===p.__lastOverElm.id)D&&D.fire(c,b);else{m=h(q,"mouseover");if(p.__lastOverElm){var k=h(p.__lastOverElm,"mouseout");k&&k.fire("mouseout",b);p.__lastOverElm=null}p.__lastOverElm=q;m&&m.fire("mouseover",b);D&&D.fire("mousemove",b)}else{p.__lastOverElm=
q;var m=h(q,"mouseover");m&&m.fire("mouseover",b);D&&D.fire("mousemove",b)}return!1});if(g)return!1});if("mousemove"===c&&!g&&p.__lastOverElm){var q=!1;p.__lastOverElm.inside(k,null,function(){q=!0});if(!q){var D=h(p.__lastOverElm,"mouseout");p.__lastOverElm=null;D&&D.fire("mouseout",b)}}return!1}return!0};b.prototype.addToTree=function(a){if(!a.children)throw x.animation(p.A.OBJECT_IS_NOT_ELEMENT,this);this._register(a);this.tree.push(a)};b.prototype.handlePause=function(){this.traverse(function(a){a.__resetBandEvents()})};
b.prototype._register=function(a){if(this.hash[a.id])throw x.animation(p.A.ELEMENT_IS_REGISTERED,this);a.registered=!0;a.anim=this;this.hash[a.id]=a;var c=this;a.each(function(a){c._register(a)})};b.prototype._unregister_no_rm=function(a){this._unregister(a,!0)};b.prototype._unregister=function(a,c){if(!a.registered)throw x.animation(p.A.ELEMENT_IS_NOT_REGISTERED,this);var b=this;a.each(function(a){b._unregister(a)});var m=-1;if(!c)for(;0<=(m=this.tree.indexOf(a));)this.tree.splice(m,1);delete this.hash[a.id];
a.registered=!1;a.anim=null};b.prototype._collectRemoteResources=function(a){var c=[],b=this;this.traverse(function(m){m._hasRemoteResources(b,a)&&(c=c.concat(m._collectRemoteResources(b,a)))});this.fonts&&this.fonts.length&&(c=c.concat(this.fonts.map(function(a){return a.url})));return c};b.prototype._loadRemoteResources=function(a){var c=this;this.traverse(function(b){b._hasRemoteResources(c,a)&&b._loadRemoteResources(c,a)});c.loadFonts(a)};b.prototype.find=function(a,c){return A.one(a).over(c?
c.children:this.tree)};b.prototype.findAll=function(a,c){return A.all(a).over(c?c.children:this.tree)};b.prototype.findById=function(a){return this.hash[a]};b.prototype.prefix=function(a){this.$prefix=a};b.prototype.adapt=function(a,c){return{x:a/this.factor,y:c/this.factor}};b.prototype.invokeAllLaters=function(){for(var a=0;a<this._laters.length;a++)this._laters[a].call(this)};b.prototype.clearAllLaters=function(){this._laters=[]};b.prototype.invokeLater=function(a){this._laters.push(a)};b.prototype.loadFonts=
function(a){if(this.fonts&&this.fonts.length){for(var b=this.fonts,m=c.getWebfontStyleObject(),p="",k=[],g=new h,q=0;q<b.length;q++){var D=b[q];if(D.url&&D.face){var f=c.checkMediaUrl(D.url),e=c.checkMediaUrl(D.woff);k.push(D);p+='@font-face {\nfont-family: "'+D.face+'";\nsrc:'+(e?' url("'+e+'") format("woff"),\n':"")+' url("'+f+'") format("truetype");\n'+(D.style?"font-style: "+D.style+";\n":"")+(D.weight?"font-weight: "+D.weight+";\n":"")+"}\n"}}if(0!==k.length)for(m.innerHTML+=p,b=function(q){var a=
k[q];return function(q){var c=0,b;b=setInterval(function(){c+=100;if(g.detect(a)||1E4<c)clearInterval(b),q()},100)}},q=0;q<k.length;q++)n.loadOrGet(a.id,k[q].url,b(q))}};z.exports=b},{"../../vendor/font_detector.js":42,"../constants.js":12,"../errors.js":13,"../events.js":14,"../graphics/brush.js":17,"../loc.js":27,"../resource_manager.js":35,"../utils.js":39,"./element.js":6,"./search.js":9,engine:40}],4:[function(d,z,r){var b={recalc:function(e,a){a=a||(e.parent?e.parent.gband:[0,0]);e.gband=[a[0]+
e.lband[0],a[0]+e.lband[1]];e.each(function(a){b.recalc(a,e.gband)})},wrap:function(b,a){return b?[b[0]+a[0],b[0]+a[1]<=b[1]?b[0]+a[1]:b[1]]:a},expand:function(b,a){return b?[a[0]<b[0]?a[0]:b[0],a[1]>b[1]?a[1]:b[1]]:a},reduce:function(b,a){return b?[a[0]>b[0]?a[0]:b[0],a[1]<b[1]?a[1]:b[1]]:a}};z.exports=b},{}],5:[function(d,z,r){function b(a,b){f["E_"+a]=a;var e=new c(b),d=function(a){return e.atT([0,0],a)[1]};h[a]=d;n[a]=function(){return d}}function e(a){for(var c=1,b=0,h=0,p;100>=h;h++)p=a(h/100),
c=Math.min(c,p),b=Math.max(b,p);return[c,b]}function a(a){var c=e(a);return function(b){return(a(b)-c[0])/(c[1]-c[0])}}var f=d("../constants.js"),c=d("../graphics/segments.js").CSeg,n={};n[f.E_PATH]=function(a){return function(c){return a.pointAt(c)[1]}};n[f.E_FUNC]=function(a){return a};n[f.E_CSEG]=function(a){return function(c){return a.atT([0,0],c)[1]}};n[f.E_STDF]=function(a){return u[a]};var h={};b("default",[.25,.1,.25,1,1,1]);b("in",[.42,0,1,1,1,1]);b("out",[0,0,.58,1,1,1]);b("inout",[.42,
0,.58,1,1,1]);b("sinein",[.47,0,.745,.715,1,1]);b("sineout",[.39,.575,.565,1,1,1]);b("sineinout",[.445,.05,.55,.95,1,1]);b("quadin",[.55,.085,.68,.53,1,1]);b("quadout",[.25,.46,.45,.94,1,1]);b("quadinout",[.455,.03,.515,.955,1,1]);b("cubicin",[.55,.055,.675,.19,1,1]);b("cubicout",[.215,.61,.355,1,1,1]);b("cubicinout",[.645,.045,.355,1,1,1]);b("quartin",[.895,.03,.685,.22,1,1]);b("quartout",[.165,.84,.44,1,1,1]);b("quartinout",[.77,0,.175,1,1,1]);b("quintin",[.755,.05,.855,.06,1,1]);b("quintout",[.23,
1,.32,1,1,1]);b("quintinout",[.86,0,.07,1,1,1]);b("expoin",[.95,.05,.795,.035,1,1]);b("expoout",[.19,1,.22,1,1,1]);b("expoinout",[1,0,0,1,1,1]);b("circin",[.6,.04,.98,.335,1,1]);b("circout",[.075,.82,.165,1,1,1]);b("circinout",[.785,.135,.15,.86,1,1]);b("backin",[.6,-.28,.735,.045,1,1]);b("backout",[.175,.885,.32,1.275,1,1]);b("backinout",[.68,-.55,.265,1.55,1,1]);var u=[function(a){return h["default"](a)},function(a){return h["in"](a)},function(a){return h.out(a)},function(a){return h.inout(a)},
function(a){return a*a},function(a){return a*(2-a)},function(a){if(.5>a)return 2*a*a;a=2*(a-.5);return-(a*(a-2)-1)/2},function(a){return a*a*a},function(a){--a;return a*a*a+1},function(a){if(.5>a)return a*=2,a*a*a/2;a=2*(a-.5)-1;return(a*a*a+2)/2},function(a){return 1-Math.cos(Math.PI/2*a)},function(a){return Math.sin(Math.PI/2*a)},function(a){return-(Math.cos(Math.PI*a)-1)/2},function(a){return 0>=a?0:Math.pow(2,10*(a-1))},function(a){return 1<=a?1:-Math.pow(2,-10*a)+1},function(a){return 0>=a?0:
1<=a?1:.5>a?Math.pow(2,10*(2*a-1))/2:(-Math.pow(2,-20*(a-.5))+2)/2},function(a){return 1-Math.sqrt(1-a*a)},function(a){--a;return Math.sqrt(1-a*a)},function(a){return 1>(a*=2)?-(Math.sqrt(1-a*a)-1)/2:(Math.sqrt(1-(a-=2)*a)+1)/2},a(function(a){return a*a*(2.70158*a-1.70158)}),function(a){return function(c){return(a(c)- -.2)/1.4}}(function(a){return--a*a*(2.70158*a+1.70158)+1}),a(function(a){var c=1.70158;return 1>(a*=2)?a*a*(((c*=1.525)+1)*a-c)/2:((a-=2)*a*(((c*=1.525)+1)*a+c)+2)/2}),function(a){return 1-
u[23](1-a)},a(function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}),function(a){return.5>a?.5*u[22](2*a):.5*u[23](2*a-1)+.5},function(a){return 0},function(a){return 1},function(a){return.5>a?0:1}];z.exports=n},{"../constants.js":12,"../graphics/segments.js":20}],6:[function(d,z,r){function b(q){return f.roundTo(q,9)}function e(q,a){return b(q)>b(a)?1:b(q)<b(a)?-1:0}function a(q,a,g){this.id=f.guid();
this.name=q||"";this.type=w.ET_EMPTY;this.children=[];this.parent=null;this.level=0;this.anim=null;this.disabled=!1;this.affectsChildren=this.visible=!0;this.$data=null;this.rendering=this.registered=this.shown=!1;this.initState();this.initVisuals();this.initTime();this.initEvents();this.$modifiers={};this.$painters={};g&&this.modify(g);a&&this.paint(a);this.__painting=this.__modifying=null;this.__modifiers_hash={};this.__painters_hash={};this.__detachQueue=[];this.__frameProcessors=[];this._initHandlers();
var b=this,k=this.on;this.on=function(q,a){return k.call(b,q,a)};this.addSysModifiers();this.addSysPainters();c.liveDebug&&this.addDebugRender()}d("../log.js");var f=d("../utils.js"),c=d("../global_opts.js"),n=f.iter,h=f.is,u=d("engine"),w=d("../constants.js");r=d("../events.js");var m=r.provideEvents,y=r.EventState,x=d("../../vendor/transform.js"),p=d("../render.js"),A=d("../graphics/brush.js"),t=d("../graphics/color.js"),B=d("../graphics/bounds.js"),C=d("./modifier.js"),F=d("./painter.js"),v=d("./band.js"),
k=d("../errors.js"),g=d("../loc.js").Errors;a.DEFAULT_PVT=[.5,.5];a.DEFAULT_REG=[0,0];a._$=function(q,g,c){return new a(q,g,c)};a.NO_TIME=null;a.NO_BAND=null;a.DEFAULT_LEN=Infinity;a._customImporters=[];m(a,[w.X_MCLICK,w.X_MDCLICK,w.X_MUP,w.X_MDOWN,w.X_MMOVE,w.X_MOVER,w.X_MOUT,w.X_START,w.X_STOP]);a.prototype.is=function(q){return this.type==q};a.prototype.initState=function(){this.y=this.x=0;this.sy=this.sx=1;this.angle=this.hy=this.hx=0;this.alpha=1;this.matrix?this.matrix.reset():this.matrix=new x;
this._y=this._x=0;this._hy=this._hx=this._sy=this._sx=1;this._angle=0;this._alpha=1;this._matrix?this._matrix.reset():this._matrix=new x;this.$reg=a.DEFAULT_REG;this.$pivot=a.DEFAULT_PVT;return this};a.prototype.resetState=a.prototype.initState;a.prototype.initVisuals=function(){this.$video=this.$audio=this.$my_bounds=this.lastBoundsSavedAt=this.$bounds=this.$mpath=this.$mask=this.composite_op=this.$image=this.$text=this.$path=this.$shadow=this.$stroke=this.$fill=null;return this};a.prototype.resetVisuals=
a.prototype.initVisuals;a.prototype.initTime=function(){this.mode=w.R_ONCE;this.nrep=Infinity;this.lband=[0,a.DEFAULT_LEN];this.gband=[0,a.DEFAULT_LEN];this.keys={};this["switch"]=this.rt=this.t=this.key=this.tf=null;this.__resetTimeCache();this.__resetBandEvents();return this};a.prototype.resetTime=a.prototype.initTime;a.prototype.__resetTimeCache=function(){this.__lastJump=this.cur_rt=this.cur_t=null;this.__jumpLock=!1};a.prototype.__resetBandEvents=function(){this.__firedStop=this.__firedStart=
!1;this.__lastRender=null};a.prototype.initEvents=function(){this.evts={};this.__evt_st=new y;this.__evtCache=[];return this};a.prototype.resetEvents=a.prototype.initEvents;a.prototype.path=function(q){return q?(this.invalidate(),this.type=w.ET_PATH,this.$path=h.str(q)?new Path(q):q,this):this.$path};a.prototype.text=function(q){return q?(this.invalidate(),this.type=w.ET_TEXT,this.$text=h.str(q)||h.arr(q)?new Text(q):q,this):this.$text};a.prototype.image=function(q,a){return q?(this.invalidate(),
this.type=w.ET_SHEET,this.$image=h.str(q)?new Image(q,a):q,this):this.$image};a.prototype.fill=function(q){return q?(this.$fill=q instanceof A?q:A.fill(q),this):this.$fill};a.prototype.noFill=function(){this.$fill=t.TRANSPARENT;return this};a.prototype.stroke=function(q,a){return q?(q instanceof A?(this.$stroke=q,h.defined(a)&&(this.$stroke.width=a)):this.$stroke=A.stroke(q,a),this):this.$stroke};a.prototype.noStroke=function(){this.$stroke=null;return this};a.prototype.shadow=function(q,a,g,c){return q?
(this.$shadow=q instanceof A?q:A.shadow(q,a,g,c),this):this.$shadow};a.prototype.modifiers=function(q,g,c){c=c||C.ALL_MODIFIERS;g=g||0;this.applyPrevState(this);this.cur_t=q;this.cur_rt=q/(this.lband[1]-this.lband[0]);h.num(this.__appliedAt)&&(this._t=this.__appliedAt,this._rt=this.__appliedAt/(this.lband[1]-this.lband[0]));this.__loadEvents();for(var b=this.$modifiers,k,m,p,f,v=0,e=c.length;v<e;v++){this.__modifying=k=c[v];this.__mbefore(k);if(m=b[k])for(var t=0,d=m.length;t<d;t++)if(p=m[t],f=this.__adaptModTime(p,
q),null!==f&&(!1===f||!1===p.apply(this,f[0],g,f[1])))return this.__mafter(q,this.__modifying,!1),this.__modifying=null,!1;this.__mafter(q,k,!0)}this.matrix=a.getMatrixOf(this,this.matrix);this.__modifying=null;this.__appliedAt=q;this.resetEvents();return!0};a.prototype.painters=function(q,a){for(var g=a||F.ALL_PAINTERS,c=this.$painters,b,k,m,p=0,h=g.length;p<h;p++){this.__painting=b=g[p];this.__pbefore(q,b);if(k=c[b])for(var f=0,v=k.length;f<v;f++)m=k[f],m.apply(this,q);this.__pafter(q,b)}this.__painting=
null};a.prototype.forAllModifiers=function(q){for(var a=C.ALL_MODIFIERS,g=this.$modifiers,c,b,k=0,m=a.length;k<m;k++)if(c=a[k],b=g[c])for(var p=0,h=b.length;p<h;p++)q(b[p],c)};a.prototype.forAllPainters=function(q){for(var a=F.ALL_PAINTERS,g=this.$painters,c,b,k=0,m=a.length;k<m;k++)if(c=a[k],b=g[c])for(var p=0,h=b.length;p<h;p++)q(b[p],c)};a.prototype.draw=a.prototype.painters;a.prototype.transform=function(q){q.globalAlpha*=this.alpha;this.matrix.apply(q);return this.matrix};a.prototype.invTransform=
function(q){var g=a.getIMatrixOf(this);q.globalAlpha*=this.alpha;g.apply(q);return g};a.prototype.render=function(q,g,c){if(!this.disabled){this.rendering=!0;var b=!1,k=this.ltime(g);if(k!==a.NO_TIME){this.cur_rt=this.cur_t=null;b=this.__preRender(g,k,q);this.anim&&this.anim.__informEnabled&&this.inform(g,k);b&&(b=this.fits(k)&&this.modifiers(k,c)&&this.visible);if(b){q.save();g=this.affectsChildren?this.gtime(k):g;var m=this.$mask,p=!1,h,f;m&&(h=m.ltime(k),f=m.gtime(h),p=m.fits(h)&&m.modifiers(h,
c)&&m.visible);if(p){m.ensureHasMaskCanvas();var k=m.__maskCvs,v=m.__maskCtx,p=m.__backCvs,t=m.__backCtx,e=m.bounds(h).toPoints(),d=Number.MAX_VALUE;h=Number.MAX_VALUE;for(var x=Number.MIN_VALUE,y=Number.MIN_VALUE,n,A=0,w=e.length;A<w;A++)n=e[A],n.x<d&&(d=n.x),n.y<h&&(h=n.y),n.x>x&&(x=n.x),n.y>y&&(y=n.y);e=u.PX_RATIO;n=d;A=h;d=Math.round(x-d);h=Math.round(y-h);y=this._maskCvsSize||u.getCanvasSize(k);y[0]<d||y[1]<h?(this._maskCvsSize=u.setCanvasSize(k,d,h),u.setCanvasSize(p,d,h)):this._maskCvsSize=
y;t.clearRect(0,0,d*e,h*e);v.clearRect(0,0,d*e,h*e);t.save();v.save();t.setTransform(e,0,0,e,-n*e,-A*e);v.setTransform(e,0,0,e,-n*e,-A*e);this.transform(t);this.painters(t);this.each(function(q){q.render(t,g,c)});m.transform(v);m.painters(v);m.each(function(q){q.render(v,f,c)});t.globalCompositeOperation="destination-in";t.setTransform(1,0,0,1,0,0);t.drawImage(k,0,0);q.drawImage(p,0,0,Math.floor(d*e),Math.floor(h*e),n,A,d,h);v.restore();t.restore()}else this.transform(q),this.painters(q),this.each(function(a){a.render(q,
g,c)});q.restore()}this.shown=b;this.__postRender();this.rendering=!1;return this}}};a.prototype.pivot=function(q,a){this.$pivot=[q,a];return this};a.prototype.reg=function(q,a){this.$reg=[q,a];return this};a.prototype.move=function(q,a){this.x=q;this.y=a;return this};a.prototype.rotate=function(q){this.angle=q;return this};a.prototype.rotateInDeg=function(q){return this.rotate(q/180*Math.PI)};a.prototype.scale=function(q,a){this.sx=q;this.sy=a;return this};a.prototype.skew=function(q,a){this.hx=
q;this.hy=a;return this};a.prototype.repeat=function(q,a){this.mode=q;this.nrep=h.num(a)?a:Infinity;return this};a.prototype.once=function(){this.mode=w.R_ONCE;this.nrep=Infinity;return this};a.prototype.stay=function(){this.mode=w.R_STAY;this.nrep=Infinity;return this};a.prototype.loop=function(q){this.mode=w.R_LOOP;this.nrep=h.num(q)?q:Infinity;return this};a.prototype.bounce=function(q){this.mode=w.R_BOUNCE;this.nrep=h.num(q)?q:Infinity;return this};a.prototype.jump=function(q){h.defined(this.pausedAt)&&
(this.pausedAt=q);this.t=q;return this};a.prototype.jumpTo=function(q){if(q=h.str(selector)?this.find(selector):selector)return this.anim?this.anim.jump(q.gband[0]):this.jump(q.lband[0]),this};a.prototype.play=function(){if(this.paused)return this.paused=!1,this.t=null,this.pausedAt=void 0,this.__m_stop&&this.removeModifier(this.__m_stop),this};a.prototype.stop=function(){if(this.paused)return this;this.paused=!0;this.__m_stop=new C(function(q){this.paused&&(h.defined(this.pausedAt)?this.t=this.pausedAt:
this.pausedAt=q)});this.modify(this.__m_stop);return this};a.prototype.at=function(q,a){return this.modify((new C(a)).time(q))};a.prototype.modify=function(q,a){h.arr(q)||(a=q,q=null);if(!a)throw k.element("No modifier was passed to .modify() method",this);if(!h.modifier(a)&&h.fun(a))a=new C(a,w.MOD_USER);else if(!h.modifier(a))throw k.element("Modifier should be either a function or a Modifier instance",this);if(!a.type)throw k.element("Modifier should have a type defined",this);q&&(a.$band=q);if(a.__applied_to&&
a.__applied_to[this.id])throw k.element("This modifier is already applied to this Element",this);this.$modifiers[a.type]||(this.$modifiers[a.type]=[]);this.$modifiers[a.type].push(a);this.__modifiers_hash[a.id]=a;a.__applied_to||(a.__applied_to={});a.__applied_to[this.id]=this.$modifiers[a.type].length;return this};a.prototype.removeModifier=function(a){if(!h.modifier(a))throw k.element("Please pass Modifier instance to removeModifier",this);if(!this.__modifiers_hash[a.id])throw k.element("Modifier wasn't applied to this element",
this);if(!a.__applied_to||!a.__applied_to[this.id])throw k.element(g.A.MODIFIER_NOT_ATTACHED,this);f.removeElement(this.__modifiers_hash,a.id);f.removeElement(this.$modifiers[a.type],a);f.removeElement(a.__applied_to,this.id);return this};a.prototype.paint=function(a){if(!a)throw k.element("No painter was passed to .paint() method",this);if(!h.painter(a)&&h.fun(a))a=new F(a,w.MOD_USER);else if(!h.painter(a))throw k.element("Painter should be either a function or a Painter instance",this);if(!a.type)throw k.element("Painter should have a type defined",
this);if(a.__applied_to&&a.__applied_to[this.id])throw k.element("This painter is already applied to this Element",this);this.$painters[a.type]||(this.$painters[a.type]=[]);this.$painters[a.type].push(a);this.__painters_hash[a.id]=a;a.__applied_to||(a.__applied_to={});a.__applied_to[this.id]=this.$painters[a.type].length;return this};a.prototype.removePainter=function(a){if(!h.painter(a))throw k.element("Please pass Painter instance to removePainter",this);if(!this.__painters_hash[a.id])throw k.element("Painter wasn't applied to this element",
this);if(!a.__applied_to||!a.__applied_to[this.id])throw k.element(g.A.PAINTER_NOT_ATTACHED,this);f.removeElement(this.__painters_hash,a.id);f.removeElement(this.$painters[a.type],a);f.removeElement(a.__applied_to,this.id);return this};a.prototype.tween=function(a){if(!h.tween(a))throw k.element("Please pass Tween instance to .tween() method",this);return this.modify(a)};a.prototype.removeTween=function(a){if(!h.tween(a))throw k.element("Please pass Tween instance to .removeTween() method",this);
return this.removeModifier(a)};a.prototype.add=function(q,g,c){if(g)q=new a(q,g),c&&q.changeTransform(c),this._addChild(q);else if(h.arr(q))for(c=0,q=elms.length;c<q;c++)this._addChild(elms[c]);else this._addChild(q);this.invalidate();return this};a.prototype.remove=function(a){if(!a)throw k.element(g.A.NO_ELEMENT_TO_REMOVE);if(0===this.__safeDetach(a))throw k.element(g.A.NO_ELEMENT);this.invalidate();return this};a.prototype._unbind=function(){if(this.parent.__unsafeToRemove||this.__unsafeToRemove)throw k.element(g.A.UNSAFE_TO_REMOVE);
this.parent=null;this.anim&&this.anim._unregister(this)};a.prototype.detach=function(){if(0===this.parent.__safeDetach(this))throw k.element(g.A.ELEMENT_NOT_ATTACHED,this);};a.prototype.makeBandFit=function(){var a=this.findWrapBand();this.gband=a;this.lband[1]=a[1]-a[0]};a.prototype.fits=function(q){return 0>q||q===a.NO_TIME?!1:0>=e(q,this.lband[1]-this.lband[0])};a.prototype.gtime=function(a){return this.gband[0]+a};a.prototype.ltime=function(q){return this.__checkJump(a.checkRepeatMode(this.__checkSwitcher(q),
this.gband,this.mode,this.nrep))};a.prototype.inform=function(a,g){var c=this.lband[1]-this.lband[0];0>e(g,0)||(h.defined(this.__lastRender)?h.defined(this.__lastRender)&&0<e(g,c)?(this.__firedStop||(this.modifiers(c,c-this.__lastRender),this.fire(w.X_STOP,g,c),this.traverse(function(g){g.inform(g.ltime(a),a)}),this.__firedStop=!0),this.__lastRender=void 0):this.__lastRender=g:(this.__lastRender=g,this.__firedStart||(this.fire(w.X_START,g,c),this.__firedStart=!0)))};a.prototype.band=function(a,g){if(!h.defined(a))return this.lband;
h.arr(a)&&(a=a[0],g=a[1]);h.defined(g)||(g=Infinity);this.lband=[a,g];if(this.parent){var c=this.parent;this.gband=[c.gband[0]+a,c.gband[0]+g]}return this};a.prototype.duration=function(a){if(!h.defined(a))return this.lband[1]-this.lband[0];this.gband=[this.gband[0],this.gband[0]+a];this.lband=[this.lband[0],this.lband[0]+a];return this};a.prototype._max_tpos=function(){return 0<=this.gband[1]?this.gband[1]:0};a.prototype.m_on=function(a,g){this.modify(new C(function(c){if(this.__evt_st.check(a))for(var b=
this.evts[a],k=0,m=b.length;k<m;k++)if(!1===g.call(this,b[k],c))return!1},w.MOD_EVENT))};a.prototype.findWrapBand=function(){if(0===this.children.length)return this.gband;var a=[Infinity,0];this.each(function(g){a=v.expand(a,g.gband)});return Infinity!==a[0]?a:null};a.prototype.dispose=function(){this.disposeHandlers();this.disposeVisuals();this.each(function(a){a.dispose()})};a.prototype.disposeVisuals=function(){this.$path&&this.$path.dispose();this.$text&&this.$text.dispose();this.$image&&this.$image.dispose();
this.$video&&this.$video.dispose();this.$mpath&&this.$mpath.dispose()};a.prototype.reset=function(){this.resetEvents();this.__resetTimeCache();this.__resetBandEvents();var a=this;this.forAllModifiers(function(g){g.__wasCalled&&(g.__wasCalled[a.id]=!1);h.defined(g.__wasCalledAt)&&(g.__wasCalledAt[a.id]=-1)});this.each(function(a){a.reset()})};a.prototype.each=function(a){var g=this.children;this.__unsafeToRemove=!0;for(var c=0,b=g.length;c<b&&!1!==a(g[c]);c++);this.__unsafeToRemove=!1;return this};
a.prototype.reverseEach=function(a){var g=this.children;this.__unsafeToRemove=!0;for(var c=g.length;c--&&!1!==a(g[c]););this.__unsafeToRemove=!1;return this};a.prototype.firstParent=function(a){if(a(this))return this;for(var g=this.parent;g&&!a(g);)g=g.parent;return g};a.prototype.traverse=function(a){var g=this.children;this.__unsafeToRemove=!0;for(var c=0,b=g.length;c<b;c++){var k=g[c];if(!1===a(k))break;k.traverse(a)}this.__unsafeToRemove=!1;return this};a.prototype.iter=function(a,g){this.__unsafeToRemove=
!0;n(this.children).each(a,g);this.__unsafeToRemove=!1;return this};a.prototype.hasChildren=function(){return 0<this.children.length};a.prototype.deepIterateChildren=function(a,g){this.__unsafeToRemove=!0;n(this.children).each(function(c){c.deepIterateChildren(a,g);return a(c)},g);this.__unsafeToRemove=!1};a.prototype.__performDetach=function(){var a=this.children;n(this.__detachQueue).each(function(g){0<=(idx=a.indexOf(g))&&(a.splice(idx,1),g._unbind())});this.__detachQueue=[]};a.prototype.clear=
function(){if(this.__unsafeToRemove)throw k.element(g.A.UNSAFE_TO_REMOVE,this);if(this.rendering)this.__detachQueue=this.__detachQueue.concat(this.children);else{var a=this.children;this.children=[];n(a).each(function(a){a._unbind()})}return this};a.prototype.lock=function(){this.__jumpLock=!0;this.__state=this.extractState();this.__pstate=this.extractPrevState()};a.prototype.unlock=function(a){a=a?this.extractState():void 0;this.applyState(this.__state);this.applyPrevState(this.__pstate);this.__pstate=
this.__state=null;this.__jumpLock=!1;return a};a.prototype.extractState=function(){return{x:this.x,y:this.y,sx:this.sx,sy:this.sy,hx:this.hx,hy:this.hy,angle:this.angle,alpha:this.alpha,t:this.t,rt:this.rt,key:this.key}};a.prototype.extractPrevState=function(){return{x:this._x,y:this._y,sx:this._sx,sy:this._sy,hx:this._hx,hy:this._hy,angle:this._angle,alpha:this._alpha,t:this._t,rt:this._rt,key:this._key}};a.prototype.applyState=function(a){this.x=a.x;this.y=a.y;this.sx=a.sx;this.sy=a.sy;this.hx=
a.hx;this.hy=a.hy;this.angle=a.angle;this.alpha=a.alpha;this.t=a.t;this.rt=a.rt;this.key=a.key};a.prototype.applyPrevState=function(a){this._x=a.x;this._y=a.y;this._sx=a.sx;this._sy=a.sy;this._hx=a.hx;this._hy=a.hy;this._angle=a.angle;this._alpha=a.alpha;this._t=a.t;this._rt=a.rt;this._key=a.key};a.prototype.stateAt=function(g){this.lock();return this.unlock(this.modifiers(g,0,a.NOEVT_MODIFIERS))};a.prototype.pos=function(a,g){return h.defined(a)?this.move(a,g):{x:this.x,y:this.y}};a.prototype.offset=
function(){for(var a=0,g=0,c=this.parent;c;)a+=c.x,g+=c.y,c=c.parent;return[a,g]};a.prototype.invalidate=function(){this.lastBoundsSavedAt=this.$bounds=this.$my_bounds=null;this.parent&&this.parent.invalidate();return this};a.prototype.invalidateVisuals=function(){var a=this.$path||this.$text||this.$image||this.$video;a&&a.invalidate()};a.prototype.bounds=function(a){if(h.defined(this.lastBoundsSavedAt)&&0==e(this.lastBoundsSavedAt,a))return this.$bounds;var g=this.myBounds();this.children.length&&
(g=g.clone(),this.each(function(c){g.add(c.bounds(a))}));g=this.adaptBounds(g);this.lastBoundsSavedAt=a;return this.$bounds=g};a.prototype.myBounds=function(){if(this.$my_bounds)return this.$my_bounds;var a=this.$path||this.$text||this.$image||this.$video;return a?this.$my_bounds=a.bounds():this.$my_bounds=B.NONE};a.prototype.inside=function(a,g,c){if(!g||g(this)){var b=this.adapt(a.x,a.y);if(this.myBounds().inside(b)&&(a=this.$path||this.$text||this.$image||this.$video)&&a.inside(b))return c(this,
b);this.reverseEach(function(a){return a.inside(b,g,c)})}};a.prototype.adapt=function(a,g){return this.matrix.transformPointInverse(a,g)};a.prototype.adaptBounds=function(a){var g=this.matrix,c=g.transformPoint(a.x,a.y),b=g.transformPoint(a.x+a.width,a.y),k=g.transformPoint(a.x+a.width,a.y+a.height);a=g.transformPoint(a.x,a.y+a.height);var g=Math.min(c.x,b.x,a.x,k.x),m=Math.min(c.y,b.y,a.y,k.y);return new B(g,m,Math.max(c.x,b.x,a.x,k.x)-g,Math.max(c.y,b.y,a.y,k.y)-m)};a.prototype.inverseAdaptBounds=
function(a){var g=this.matrix,c=g.transformPointInverse(a.x,a.y),b=g.transformPointInverse(a.x+a.width,a.y),k=g.transformPointInverse(a.x+a.width,a.y+a.height);a=g.transformPointInverse(a.x,a.y+a.height);var g=Math.min(c.x,b.x,a.x,k.x),m=Math.min(c.y,b.y,a.y,k.y);return new B(g,m,Math.max(c.x,b.x,a.x,k.x)-g,Math.max(c.y,b.y,a.y,k.y)-m)};a.prototype.isEmpty=function(){var a=this.myBounds();return 0===a.width&&0===a.height};a.prototype.applyVisuals=function(a){var g=this.$path||this.$text||this.$image||
this.$video;g&&g.apply(a,this.$fill,this.$stroke,this.$shadow)};a.prototype.applyBrushes=function(a){this.$shadow&&this.$shadow.apply(a);this.$fill&&(this.$fill.apply(a),a.fill());this.$shadow&&A.clearShadow(a);this.$stroke&&(this.$stroke.apply(a),a.stroke())};a.prototype.applyAComp=function(a){this.composite_op&&(a.globalCompositeOperation=w.AC_NAMES[this.composite_op])};a.prototype.mask=function(a){if(!a)return this.$mask;this.$mask=a;return this};a.prototype.noMask=function(){this.$mask=null;return this};
a.prototype.ensureHasMaskCanvas=function(a){this.__maskCvs&&this.__backCvs||(this.__maskCvs=u.createCanvas(1,1),this.__maskCtx=u.getContext(this.__maskCvs,"2d"),this.__backCvs=u.createCanvas(1,1),this.__backCtx=u.getContext(this.__backCvs,"2d"))};a.prototype.removeMaskCanvases=function(){this.__maskCvs&&u.disposeElement(this.__maskCvs);this.__backCvs&&u.disposeElement(this.__backCvs);this.__backCtx=this.__maskCtx=null};a.prototype.data=function(a){if(!h.defined(a))return this.$data;this.$data=a;return this};
a.prototype.toString=function(){var a=["[ Element "];a.push("'"+(this.name||this.id)+"' ");a.push("]");return a.join("")};a.prototype.find=function(a){return this.anim.find(a,this)};a.prototype.findAll=function(a){return this.anim.findAll(a,this)};a.prototype.clone=function(){var g=new a;g.name=this.name;g.children=[].concat(this.children);g.$modifiers=[].concat(this.$modifiers);g.$painters=[].concat(this.$painters);g.level=this.level;a.transferState(this,g);a.transferVisuals(this,g);a.transferTime(this,
g);g.__u_data=this.__u_data;return g};a.prototype.shallow=function(){var a=this.clone();a.children=[];for(var g=this.children,c=a.children,b=0,k=g.length;b<k;b++){var m=g[b].shallow();m.parent=a;c.push(m)}a.$modifiers={};this.forAllModifiers(function(g,c){a.modify(g)});a.$painters={};this.forAllPainters(function(g,c){a.paint(g)});a.__u_data=f.obj_clone(this.__u_data);return a};a.prototype.asClip=function(a,g,c){if(g!=w.R_ONCE)return this.clip_band=a,this.clip_mode=g,this.clip_nrep=c,this};a.prototype._addChild=
function(a){a.parent=this;a.level=this.level+1;this.children.push(a);this.anim&&this.anim._register(a);v.recalc(this)};a.prototype._stateStr=function(){return"x: "+this.x+" y: "+this.y+"\nsx: "+this.sx+" sy: "+this.sy+"\nangle: "+this.angle+" alpha: "+this.alpha+"\np: "+this.p+" t: "+this.t+" key: "+this.key+"\n"};a.prototype.__mbefore=function(a,g){};a.prototype.__mafter=function(a,g,c){};a.prototype.__adaptModTime=function(g,c){var k=this.lband[1]-this.lband[0],m=g.$easing,p=g.$band||g.$time,f=
g.$relative,v=g.is_tween;if(this.clip_band&&(c=a.checkRepeatMode(c,this.clip_band,this.clip_mode||w.R_ONCE,this.clip_nrep),0>c))return!1;if(null===p)p=c;else if(h.arr(p)){if(f&&(p=[p[0]*k,p[1]*k]),k=p[1]-p[0],p=c-p[0],0>e(p,0)||0<e(p,k))return null}else{if(h.num(p)){if(g.__wasCalled&&g.__wasCalled[this.id]||!(0<=e(c,f?p*k:p)))return null;g.__wasCalled||(g.__wasCalled={});g.__wasCalledAt||(g.__wasCalledAt={});g.__wasCalled[this.id]=!0;g.__wasCalledAt[this.id]=c}p=c}f||v?h.finite(k)&&(p=b(p)/b(k),k=
b(k)):(p=b(p),k=b(k));return m?[m(p,k),k]:[p,k]};a.prototype.__pbefore=function(a,g){};a.prototype.__pafter=function(a,g){};a.prototype.__checkJump=function(g){if(g===a.NO_TIME)return a.NO_TIME;if(this.tf)return this.tf(g);var c=null,b=this.lband[1]-this.lband[0],c=h.defined(this.p)?this.p:null,c=null===c&&null!==this.t?this.t:c,c=null===c&&null!==this.rt&&h.finite(b)?this.rt*b:c,c=null===c&&h.defined(this.key)?this.keys[this.key]:c;if(null!==c){if(0>c||c>b)throw k.element("Failed to calculate jump",
this);if(!this.__jumpLock)return this.__lastJump=[g,c],this.key=this.t=this.p=null,c}c=null!==c?c:g;return h.defined(this.__lastJump)?(h.finite(this.__lastJump[1])?this.__lastJump[1]:0)+(c-this.__lastJump[0]):null!==c?c:a.NO_TIME};a.prototype.__checkSwitcher=function(g){if(!this.parent||!this.parent["switch"])return g;var c=this.parent;return c["switch"]===w.SWITCH_OFF?a.NO_TIME:c["switch"]===this.name&&c.switch_band?g===a.NO_TIME?a.NO_TIME:g-c.switch_band[0]:a.NO_TIME};a.prototype.filterEvent=function(a,
g){if(a!=w.X_START&&a!=w.X_STOP)if(this.shown)this.__saveEvt(a,g);else return a===w.X_STOP&&this.__resetBandEvents(),!1;return!0};a.prototype.__saveEvt=function(a,g){this.__evtCache.push([a,g])};a.prototype.__loadEvents=function(){var a=this.__evtCache,g=a.length;this.resetEvents();if(0<g){for(var c,b,k,m=0;m<g;m++)c=a[m],b=c[0],this.__evt_st.save(b),k=this.evts,k[b]||(k[b]=[]),k[b].push(c[1]);this.__evtCache=[]}};a.prototype.__preRender=function(a,g,c){for(var b=this.__frameProcessors,k=0,m=b.length;k<
m;k++)if(!1===b[k].call(this,a,g,c))return!1;return!0};a.prototype.__safeDetach=function(a,c){var b=-1,m=c||0,p=this.children;if(0<=(b=p.indexOf(a))){if(this.rendering||a.rendering)this.__detachQueue.push(a);else{if(this.__unsafeToRemove)throw k.element(g.A.UNSAFE_TO_REMOVE,this);a._unbind();p.splice(b,1)}return 1}this.each(function(g){m+=g.__safeDetach(a,m)});return m};a.prototype.__postRender=function(){this.__performDetach()};a.prototype._hasRemoteResources=function(a,g){return g.imagesEnabled&&
this.$image||this.is(w.ET_AUDIO)&&g.audioEnabled||this.is(w.ET_VIDEO)&&g.videoEnabled?!0:this.$mask?this.$mask._hasRemoteResources(a,g):!1};a.prototype._collectRemoteResources=function(a,g){var c=[];g.imagesEnabled&&this.$image&&c.push(this.$image.src);g.audioEnabled&&this.is(w.ET_AUDIO)&&c.push(this.$audio.url);g.videoEnabled&&this.is(w.ET_VIDEO)&&c.push(this.$video.url);this.$mask&&(c=c.concat(this.$mask._collectRemoteResources(a,g)));return c};a.prototype._loadRemoteResources=function(a,g){g.imagesEnabled&&
this.$image&&this.$image.load(this.id,g);this.is(w.ET_AUDIO)&&g.audioEnabled&&this.$audio.load(this.id,g);this.is(w.ET_VIDEO)&&g.videoEnabled&&this.$video.load(this.id,g);this.$mask&&this.$mask._loadRemoteResources(this,g)};a.mergeStates=function(a,g,c){c.x=a.x+g.x;c.y=a.y+g.y;c.sx=a.sx*g.sx;c.sy=a.sy*g.sy;c.hx=a.hx+g.hx;c.hy=a.hy+g.hy;c.angle=a.angle+g.angle;c.alpha=a.alpha+g.alpha};a.transferState=function(a,g){g.x=a.x;g.y=a.y;g.sx=a.sx;g.sy=a.sy;g.hx=a.hx;g.hy=a.hy;g.angle=a.angle;g.alpha=a.alpha;
g.$reg=[].concat(a.$reg);g.$pivot=[].concat(a.$pivot)};a.transferVisuals=function(a,g){g.$fill=A.clone(a.$fill);g.$stroke=A.clone(a.$stroke);g.$shadow=A.clone(a.$shadow);g.$path=a.$path?a.$path.clone():null;g.$text=a.$text?a.$text.clone():null;g.$image=a.$image?a.$image.clone():null;g.$audio=a.$audio?a.$audio.clone():null;g.$video=a.$video?a.$video.clone():null;g.$mask=a.$mask?a.$mask:null;g.$mpath=a.$mpath?a.$mpath.clone():null;g.composite_op=a.composite_op};a.transferTime=function(a,g){g.mode=a.mode;
g.nrep=a.nrep;g.lband=[].concat(a.lband);g.gband=[].concat(a.gband);g.keys=[].concat(a.keys);g.tf=a.tf};a.getMatrixOf=function(a,g){var c=g?(g.reset(),g):new x,b=a.getTranslate();c.translate(b.x,b.y);c.rotate(a.getRotate());c.shear(a.hx,a.hy);c.scale(a.sx,a.sy);c.translate(-a.$reg[0],-a.$reg[1]);b=a.$pivot;if(0===b[0]&&0===b[1])return c;var k=a.myBounds();if(!k||k===B.NONE)return c;c.translate(-(b[0]*(k.width||0)),-(b[1]*(k.height||0)));return c};a.prototype.getTranslate=function(){if(this.parent&&
this.parent.layer2Bone){for(var a=this.bonePath(),g={x:0,y:0},c=0,b=null,k=0;k<a.length;k++)b=a[k],c+=b.bonerotate,g.x+=b.bonelength*Math.cos(c),g.y+=b.bonelength*Math.sin(c);a=b?this.parent.children[a[0].$from]:this;g.x+=a.x;g.y+=a.y;return g}return this};a.prototype.getRotate=function(){if(this.parent&&this.parent.layer2Bone){this.$bonePath=this.$bonePath||a.bonePath(this);for(var g=0,c=this.$bonePath.length;c--;)g+=this.$bonePath[c].bonerotate;return g+this.angle}return this.angle};a.prototype.bonePath=
function(){if(!this.$bonePath){for(var a=this.parent.layer2Bone,g=[],c=a[this.parent.children.indexOf(this)];c;)g.push(c),c=a[c.$from];this.$bonePath=g.reverse()}return this.$bonePath};a.getIMatrixOf=function(g,c){var b=a.getMatrixOf(g,c);b.invert();return b};a.checkRepeatMode=function(g,c,b,k){if(g===a.NO_TIME)return a.NO_TIME;if(!h.finite(c[1]))return g-c[0];var m,p;switch(b){case w.R_ONCE:return g-c[0];case w.R_STAY:return 0>=e(g,c[1])?g-c[0]:c[1]-c[0];case w.R_LOOP:b=c[1]-c[0];if(0>b)return-1;
m=(g-c[0])/b;p=Math.floor(m);return 0>p||m>k?-1:g=g-c[0]-p*b;case w.R_BOUNCE:b=c[1]-c[0];if(0>b)return-1;m=(g-c[0])/b;p=Math.floor(m);if(0>p||m>k)return-1;g=g-c[0]-p*b;return 0===p%2?g:b-g}};a.prototype.addSysModifiers=function(){};a.prototype.addSysPainters=function(){this.paint(p.p_applyAComp);this.paint(p.p_drawVisuals)};a.prototype.addDebugRender=function(){this.paint(p.p_drawPivot);this.paint(p.p_drawBounds);this.paint(p.p_drawReg);this.paint(p.p_drawName);this.paint(p.p_drawMPath)};z.exports=
a},{"../../vendor/transform.js":43,"../constants.js":12,"../errors.js":13,"../events.js":14,"../global_opts.js":15,"../graphics/bounds.js":16,"../graphics/brush.js":17,"../graphics/color.js":18,"../loc.js":27,"../log.js":28,"../render.js":34,"../utils.js":39,"./band.js":4,"./modifier.js":7,"./painter.js":8,engine:40}],7:[function(d,z,r){function b(a,c){this.id=f();this.type=c||e.MOD_USER;this.func=a;this.$easing=this.$data=this.$time=this.$band=null;this.$relative=!1;this.is_tween=c==e.MOD_TWEEN}
var e=d("../constants.js");r=d("../utils.js");var a=r.is,f=r.guid,c=d("./easing.js");b.ORDER=[e.MOD_SYSTEM,e.MOD_TWEEN,e.MOD_USER,e.MOD_EVENT];b.FIRST_MOD=e.MOD_SYSTEM;b.LAST_MOD=e.MOD_EVENT;b.ALL_MODIFIERS=[e.MOD_SYSTEM,e.MOD_TWEEN,e.MOD_USER,e.MOD_EVENT];b.NOEVT_MODIFIERS=[e.MOD_SYSTEM,e.MOD_TWEEN,e.MOD_USER];b.prototype.band=function(c,b){if(!a.defined(c))return this.$band;a.arr(c)&&(b=c[1],c=c[0]);a.defined(b)||(b=Infinity);this.$band=[c,b];return this};b.prototype.start=function(c){if(!a.defined(c))return this.$band[0];
this.$band=this.$band?[c,this.$band[1]]:[c,Infinity];return this};b.prototype.stop=function(c){if(!a.defined(c))return this.$band[1];this.$band=this.$band?[this.$band[0],c]:[0,c];return this};b.prototype.time=function(c){if(!a.num(c))return this.$time;this.$time=c;return this};b.prototype.relative=function(c){if(!a.defined(c))return this.$relative;this.$relative=c;return this};b.prototype.easing=function(a,c){if(!a)return this.$easing;this.$easing=n(a,c,this.$relative||this.is_tween);return this};
b.prototype.clone=function(){var a=new b(this.$func,this.$type);a.$time=this.$time;a.$band=this.$band;a.$data=this.$data;a.$easing=this.$easing;a.$relative=this.$relative;a.is_tween=this.is_tween;return a};b.prototype.apply=function(a,c,b,m){return this.func.call(a,c,b,m)};b.prototype.data=function(a){this.$data=a};var n=function(b,f,e){if(!b)return null;var m;if(a.str(b)){if(!c[b])throw Error("Unknown easing: "+b);m=c[b](f);return e?m:function(a,c){return m(a/c,c)*c}}if(a.fun(b)&&!f)return b;if(a.fun(b)&&
f)return b(f);if(b.type)return m=c[b.type](b.data||f),e?m:function(a,c){return m(a/c,c)*c};if(b.f)return b.f(b.data||f)};z.exports=b},{"../constants.js":12,"../utils.js":39,"./easing.js":5}],8:[function(d,z,r){function b(b,c){this.id=a();this.func=b;this.type=c||e.PNT_USER}var e=d("../constants.js"),a=d("../utils.js").guid;b.ORDER=[e.PNT_SYSTEM,e.PNT_USER,e.PNT_DEBUG];b.FIRST_PNT=e.PNT_SYSTEM;b.LAST_PNT=e.PNT_DEBUG;b.ALL_PAINTERS=[e.PNT_SYSTEM,e.PNT_USER,e.PNT_DEBUG];b.NODBG_PAINTERS=[e.PNT_SYSTEM,
e.PNT_USER];b.prototype.apply=function(a,c){return this.func.call(a,c)};z.exports=b},{"../constants.js":12,"../utils.js":39}],9:[function(d,z,r){function b(a){this.selector=a.selector;this.multiple=a.multiple;this.anywhere="/"!==a.selector[0];this.tokens="/"===a.selector[0]?a.selector.split("/").slice(1):[a.selector]}function e(a,c,b){return":"===c[0]&&b===parseInt(c.slice(1))||c===a.name}function a(c,b){for(var f=0;f<c.length;f++){if(e(c[f],b,f))return c[f];var m=a(c[f].children,b);if(m)return m}return null}
function f(a,c,b){for(var m=0;m<c.length;m++)e(c[m],b,m)&&a.push(c[m]),f(a,c[m].children,b);return a}function c(a,b,f){f=f||0;if(0===b.length||f>=b.length)return null;for(var m=b[f],d=f===b.length-1,x=0;x<a.length;x++)if(e(a[x],m,x)){if(d)return a[x];var p=c(a[x].children,b,f+1);if(p)return p}return null}function n(a,c,b,m){m=m||0;if(0===b.length||m>=b.length)return a;for(var f=b[m],d=m===b.length-1,p=0;p<c.length;p++)e(c[p],f,p)&&(d?a.push(c[p]):n(a,c[p].children,b,m+1));return a}b.prototype.over=
function(b){if(!this.multiple&&this.anywhere)return a(b,this.tokens[0]);if(this.multiple&&this.anywhere)return f([],b,this.tokens[0]);if(!this.multiple&&!this.anywhere)return c(b,this.tokens);if(this.multiple&&!this.anywhere)return n([],b,this.tokens)};b.one=function(a){return new b({selector:a,multiple:!1})};b.all=function(a){return new b({selector:a,multiple:!0})};z.exports=b},{}],10:[function(d,z,r){function b(c,b){var d=new f(null,a.MOD_TWEEN),p=w[c];d.def=p;d.func=function(a,c,b){d.$tween&&d.$tween.call(this,
a,c,b)};d.is_tween=!0;d.tween_type=c;h.defined(b)?d.value(b):p.from===e&&p.to===e&&(d.$tween=p.func(void 0,d));return d}function e(){}var a=d("../constants.js"),f=d("./modifier.js"),c=d("../graphics/brush.js"),n=d("../graphics/path.js"),h=d("../utils.js").is;d("../errors.js");var u=f,w={};u.DEFAULT_FROM=function(a,c){return h.defined(c)?[a,c[1]]:[a,null]};u.DEFAULT_TO=function(a,c){return h.defined(a)?[c[0],a]:[null,a]};u.register=function(a,c){c=h.fun(c)?{func:c}:c;c.from=c.from||u.DEFAULT_FROM;
c.to=c.to||u.DEFAULT_TO;w[a]=c;u[a]=function(c){return b(a,c)}};u._$=b;u.prototype.values=function(a,c){if(!h.defined(a)&&this.$value)return this.$value;this.$value=this.def.to(c,this.def.from(a,null));this.$tween=this.def.func(this.$value,this);return this};u.prototype.value=function(a){if(!h.defined(a)&&this.$value)return this.$value;this.$value=a;this.$tween=this.def.func(this.$value,this);return this};u.prototype.from=function(a,c){this.$value=this.def.from(h.defined(c)?[a,c]:a,this.$value);this.$tween=
this.def.func(this.$value,this);return this};u.prototype.to=function(a,c){this.$value=this.def.to(h.defined(c)?[a,c]:a,this.$value);this.$tween=this.def.func(this.$value,this);return this};u.register(a.T_TRANSLATE,{func:function(a){return function(c){var b=a.pointAt(c);b&&(this.x=b[0],this.y=b[1],this.$mpath_t=c,this.$mpath=0<a.length()?a:null)}},from:function(a,c){return c?c.line(a[0],a[1]):(new n).move(a[0],a[1])},to:function(a,c){return c?c.line(a[0],a[1]):(new n).move(a[0],a[1])}});u.register(a.T_SCALE,
{func:function(a){var c=a[0],b=a[1];return function(a){this.sx=c[0]*(1-a)+b[0]*a;this.sy=c[1]*(1-a)+b[1]*a}},from:function(a,c){a=a.length?a:[a,a];return c?[a,c[1]]:[a,[1,1]]},to:function(a,c){a=a.length?a:[a,a];return c?[c[0],a]:[[1,1],a]}});u.register(a.T_ROTATE,function(a){var c=a[0],b=a[1];return function(a){this.angle=c*(1-a)+b*a}});u.register(a.T_BONE_ROTATE,function(a){var c=a[0],b=a[1];return function(a){this.bonerotate=c*(1-a)+b*a}});u.register(a.T_BONE_LENGTH,function(a){var c=a[0],b=a[1];
return function(a){this.bonelength=c*(1-a)+b*a}});u.register(a.T_ROT_TO_PATH,{func:function(){return function(a){if(a=this.$mpath)this.angle+=a.tangentAt(this.$mpath_t||.001)}},from:e,to:e});u.register(a.T_ALPHA,function(a){var c=a[0],b=a[1];return function(a){this.alpha=c*(1-a)+b*a}});u.register(a.T_SHEAR,{func:function(a){var c=a[0],b=a[1];return function(a){this.hx=c[0]*(1-a)+b[0]*a;this.hy=c[1]*(1-a)+b[1]*a}},from:function(a,c){a=a.length?a:[a,a];return c?[a,c[1]]:[a,[1,1]]},to:function(a,c){a=
a.length?a:[a,a];return c?[c[0],a]:[[1,1],a]}});u.register(a.T_FILL,function(a){var b=c.interpolateBrushes(a[0],a[1]);return function(a){this.$fill=b(a)}});u.register(a.T_STROKE,function(a){var b=c.interpolateBrushes(a[0],a[1]);return function(a){this.$stroke=b(a)}});u.register(a.T_SHADOW,function(a){var b=c.interpolateBrushes(a[0],a[1]);return function(a){this.$shadow=b(a)}});u.register(a.T_VOLUME,function(a){var c=a[0],b=a[1];return function(a){this.$audio&&this.$audio.ready&&this.$audio.setVolume(c*
(1-a)+b*a)}});u.register(a.T_DISPLAY,{func:function(a){return function(c){this.visible=a}},from:function(a,c){return a},to:function(a,c){return a}});u.register(a.T_SWITCH,{func:function(a,c){return function(b){this.switch_band=c.$band;this["switch"]=a}},from:e,to:e});z.exports=u},{"../constants.js":12,"../errors.js":13,"../graphics/brush.js":17,"../graphics/path.js":19,"../utils.js":39,"./modifier.js":7}],11:[function(d,z,r){r="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==
typeof window?window:{};d=d("./constants.js");d=r.__anm_conf||{logImport:!1,logResMan:!1,logEvents:!1,logLevel:d.L_ERROR|d.L_WARN|d.L_INFO,doNotLoadAudio:!1,doNotLoadImages:!1,doNotRenderShadows:!1,engine:null};r.__anm_conf=d;z.exports=d},{"./constants.js":12}],12:[function(d,z,r){d={L_DEBUG:1,L_INFO:2,L_WARN:4,L_ERROR:8,NOTHING:-1,STOPPED:0,PLAYING:1,PAUSED:2,LOADING:3,RES_LOADING:4,ERROR:5,M_CONTROLS_ENABLED:1,M_CONTROLS_DISABLED:2,M_INFO_ENABLED:4,M_INFO_DISABLED:8,M_HANDLE_EVENTS:16,M_DO_NOT_HANDLE_EVENTS:32,
M_DRAW_STILL:64,M_DO_NOT_DRAW_STILL:128,M_INFINITE_DURATION:256,M_FINITE_DURATION:512};d.M_PREVIEW=d.M_CONTROLS_DISABLED|d.M_INFO_DISABLED|d.M_DO_NOT_HANDLE_EVENTS|d.M_DRAW_STILL|d.M_FINITE_DURATION;d.M_DYNAMIC=d.M_CONTROLS_DISABLED|d.M_INFO_DISABLED|d.M_HANDLE_EVENTS|d.M_DO_NOT_DRAW_STILL|d.M_INFINITE_DURATION;d.M_VIDEO=d.M_CONTROLS_ENABLED|d.M_INFO_DISABLED|d.M_DO_NOT_HANDLE_EVENTS|d.M_DRAW_STILL|d.M_FINITE_DURATION;d.M_SANDBOX=d.M_CONTROLS_DISABLED|d.M_INFO_DISABLED|d.M_DO_NOT_HANDLE_EVENTS|d.M_DO_NOT_DRAW_STILL|
d.M_FINITE_DURATION;d.LT_ANIMATION=1;d.LT_ELEMENTS=2;d.LT_IMPORT=3;d.LT_URL=4;d.LM_ONREQUEST="onrequest";d.LM_ONPLAY="onplay";d.LM_DEFAULT=d.LM_ONREQUEST;d.ET_EMPTY="empty";d.ET_PATH="path";d.ET_TEXT="text";d.ET_SHEET="image";d.ET_AUDIO="audio";d.ET_VIDEO="video";d.R_ONCE=0;d.R_STAY=1;d.R_LOOP=2;d.R_BOUNCE=3;d.C_SRC_OVER=1;d.C_SRC_ATOP=2;d.C_SRC_IN=3;d.C_SRC_OUT=4;d.C_DST_OVER=5;d.C_DST_ATOP=6;d.C_DST_IN=7;d.C_DST_OUT=8;d.C_LIGHTER=9;d.C_DARKER=10;d.C_COPY=11;d.C_XOR=12;d.AC_NAMES=[];d.AC_NAMES[d.C_SRC_OVER]=
"source-over";d.AC_NAMES[d.C_SRC_ATOP]="source-atop";d.AC_NAMES[d.C_SRC_IN]="source-in";d.AC_NAMES[d.C_SRC_OUT]="source-out";d.AC_NAMES[d.C_DST_OVER]="destination-over";d.AC_NAMES[d.C_DST_ATOP]="destination-atop";d.AC_NAMES[d.C_DST_IN]="destination-in";d.AC_NAMES[d.C_DST_OUT]="destination-out";d.AC_NAMES[d.C_LIGHTER]="lighter";d.AC_NAMES[d.C_DARKER]="darker";d.AC_NAMES[d.C_COPY]="copy";d.AC_NAMES[d.C_XOR]="xor";d.BT_NONE="none";d.BT_FILL="fill";d.BT_STROKE="stroke";d.BT_SHADOW="shadow";d.TA_LEFT=
"left";d.TA_CENTER="center";d.TA_RIGHT="right";d.BL_TOP="top";d.BL_MIDDLE="middle";d.BL_BOTTOM="bottom";d.BL_ALPHABETIC="alphabetic";d.BL_HANGING="hanging";d.BL_IDEOGRAPHIC="ideographic";d.PC_ROUND="round";d.PC_BUTT="butt";d.PC_MITER="miter";d.PC_SQUARE="square";d.PC_BEVEL="bevel";d.E_PATH="path";d.E_FUNC="function";d.E_CSEG="segment";d.E_STDF="standard";d.T_TRANSLATE="translate";d.T_SCALE="scale";d.T_ROTATE="rotate";d.T_ROT_TO_PATH="rotatetopath";d.T_ALPHA="alpha";d.T_SHEAR="shear";d.T_FILL="fill";
d.T_STROKE="stroke";d.T_SHADOW="shadow";d.T_VOLUME="volume";d.T_DISPLAY="display";d.T_SWITCH="switch";d.T_BONE_ROTATE="bonerotate";d.T_BONE_LENGTH="bonelength";d.MOD_SYSTEM="system";d.MOD_TWEEN="tween";d.MOD_USER="user";d.MOD_EVENT="event";d.PNT_SYSTEM="system";d.PNT_USER="user";d.PNT_DEBUG="debug";d.SWITCH_OFF="[None]";z.exports=d},{}],13:[function(d,z,r){function b(a){return function(c){Error.captureStackTrace&&Error.captureStackTrace(this,this);c=Error(c||"");c.name=a;return c}}var e=d("./constants.js"),
a=b("SystemError"),f=b("PlayerError"),c=b("AnimationError");z.exports={system:function(c,b){var f=new a(c);b&&b.fire(e.S_ERROR,f);return f},player:function(a,c){var b=new f(a);c&&c.fire(e.S_ERROR,b);return b},animation:function(a,b){var f=new c(a);b&&b.fire(e.X_ERROR,f);return f},element:function(a,b){var f=new c(a);b&&b.anim&&b.anim.fire(e.X_ERROR,f);return f},SystemError:a,PlayerError:f,AnimationError:c}},{"./constants.js":12}],14:[function(d,z,r){function b(a){return 0===a.indexOf("mouse")}function e(a){return 0===
a.indexOf("key")}function a(){this.reset()}var f=d("./constants.js"),c=d("./errors.js");f.S_NEW_PLAYER="new";f.S_PLAYER_DETACH="detach";f.X_MCLICK="mouseclick";f.X_MDCLICK="mousedoubleclick";f.X_MUP="mouseup";f.X_MDOWN="mousedown";f.X_MMOVE="mousemove";f.X_MOVER="mouseover";f.X_MOUT="mouseout";f.X_KPRESS="keypress";f.X_KUP="keyup";f.X_KDOWN="keydown";f.X_START="bandstart";f.X_STOP="bandstop";f.X_ERROR="error";f.A_START="animationstart";f.A_STOP="animationstop";f.A_PAUSE="animationpause";f.S_CHANGE_STATE=
"statechange";f.S_PLAY="play";f.S_PAUSE="pause";f.S_STOP="stop";f.S_COMPLETE="complete";f.S_REPEAT="repeat";f.S_IMPORT="import";f.S_LOAD="load";f.S_RES_LOAD="loadresources";f.S_LOADING_PROGRESS="loadprogress";f.S_TIME_UPDATE="timeupdate";f.S_REPORT_STATS="reportstats";f.S_INTERACTIVITY="interactivity";f.S_ERROR="error";var n={mouseclick:1,mousedoubleclick:2,mouseup:4,mousedown:8,mousemove:16,mouseover:32,mouseout:64,keypress:128,keyup:256,keydown:512};a.prototype.reset=function(){this.state=0};a.prototype.save=
function(a){this.state|=n[a]};a.prototype.check=function(a){return this.state&n[a]};z.exports={mouse:b,keyboard:e,mouseOrKeyboard:function(a){return b(a)||e(a)},registerEvent:function(a,c){f[a]=c},provideEvents:function(a,b){a.prototype._initHandlers=function(a){return function(){var c={};this.handlers=c;for(var b=0,f=a.length;b<f;b++)c[a[b]]=[]}}(b);a.prototype.on=function(a,b){if(!this.handlers)throw c.system("Instance is not initialized with handlers, call __initHandlers in its constructor");if(!this.provides(a))throw c.system("Event '"+
a+"' is not provided by "+this);if(b)return this.handlers[a].push(b),this.handlers[a].length-1};a.prototype.subscribedTo=function(a){return this.handlers&&this.handlers[a]&&this.handlers[a].length};a.prototype.fire=function(a){if(!this.disabled){if(!this.handlers)throw c.system("Instance is not initialized with handlers, call __initHandlers in its constructor");if(!this.provides(a))throw c.system("Event '"+a+"' is not provided by "+this);if(!this.filterEvent||this.filterEvent.apply(this,arguments))if(this["handle_"+
a]||this.handlers[a].length){for(var b=Array(arguments.length-1),f=1;f<arguments.length;f++)b[f-1]=arguments[f];this["handle_"+a]&&this["handle_"+a].apply(this,b);for(var f=this.handlers[a],d=0,e=f.length;d<e;d++)f[d].apply(this,b)}}};a.prototype.provides=function(a){return function(b){if(!this.handlers)throw c.system("Instance is not initialized with handlers, call __initHandlers in its constructor");return b?this.handlers.hasOwnProperty(b):a}}(b);a.prototype.unbind=function(a,b){if(!this.handlers)throw c.system("Instance is not initialized with handlers, call __initHandlers in its constructor");
this.provides(a)&&this.handlers[a][b]&&this.handlers[a].splice(b,1)};a.prototype.disposeHandlers=function(){if(!this.handlers)throw c.system("Instance is not initialized with handlers, call __initHandlers in its constructor");var a=this.handlers,b;for(b in a)a.hasOwnProperty(b)&&(a[b]=[])};for(var f=function(a){return function(c){this.fire(a,c)}},d=0,e=b.length;d<e;d++)a.prototype["e_"+b[d]]=f(b[d])},EventState:a}},{"./constants.js":12,"./errors.js":13}],15:[function(d,z,r){z.exports={liveDebug:!1,
autoFocus:!0,setTabindex:!0}},{}],16:[function(d,z,r){function b(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d}var e=d("../utils.js").is;b.prototype.load=function(a){this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height};b.prototype.loadDiag=function(a,b,c,d){var e;c<a&&(e=a,a=c,c=e);d<b&&(e=b,b=d,d=e);this.x=a;this.y=b;this.width=c-a;this.height=d-b};b.prototype.minX=function(){return this.x};b.prototype.minY=function(){return this.y};b.prototype.maxX=function(){return this.x+this.width};
b.prototype.maxY=function(){return this.y+this.height};b.prototype.add=function(a){a.exist()&&(this.exist()?this.loadDiag(Math.min(this.minX(),a.minX()),Math.min(this.minY(),a.minY()),Math.max(this.maxX(),a.maxX()),Math.max(this.maxY(),a.maxY())):this.load(a))};b.prototype.addPoint=function(a){this.loadDiag(Math.min(this.minX(),a.x),Math.min(this.minY(),a.y),Math.max(this.maxX(),a.x),Math.max(this.maxY(),a.y))};b.prototype.toPoints=function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},
{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]};b.prototype.exist=function(){return!e.nan(this.x)};b.prototype.inside=function(a){return this.exist()?a.x>=this.x&&a.x-this.x<=this.width&&a.y>=this.y&&a.y-this.y<=this.height:!1};b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)};b.NONE=new b(NaN,NaN,NaN,NaN);z.exports=b},{"../utils.js":39}],17:[function(d,z,r){function b(c){this.type=a.BT_NONE;c&&b.value(c,this)}function e(){this.$radial=!1;
this.$stops={};this.$radius=null;this.$bounds=[0,0,1,1];this.$direction=[[.5,0],[.5,1]]}var a=d("../constants.js"),f=d("../conf.js"),c=d("../utils.js"),n=c.is,h=d("engine"),u=d("../errors.js"),w=d("./color.js");b.DEFAULT_CAP=a.PC_ROUND;b.DEFAULT_JOIN=a.PC_ROUND;b.DEFAULT_FILL="#ffbc05";b.DEFAULT_STROKE=w.TRANSPARENT;b.DEFAULT_SHADOW=w.TRANSPARENT;b.prototype.apply=function(c){if(this.type!=a.BT_NONE){var d=this._style||(this._style=this.adapt(c));if(this.type==a.BT_FILL)c.fillStyle=d;else if(this.type==
a.BT_STROKE)0<this.width?(c.lineWidth=this.width,c.strokeStyle=d||b.DEFAULT_STROKE,c.lineCap=this.cap||b.DEFAULT_CAP,c.lineJoin=this.join||b.DEFAULT_JOIN):b.clearStroke(c);else if(this.type==a.BT_SHADOW&&!f.doNotRenderShadows){var e=h.getAnmProps(c);e.skip_shadows||(e=h.PX_RATIO*(e.factor||1),c.shadowColor=d,c.shadowBlur=this.blurRadius*e||0,c.shadowOffsetX=this.offsetX*e||0,c.shadowOffsetY=this.offsetY*e||0)}}};b.prototype.invalidate=function(){this._converted=!1;this._style=null};b.prototype.convertColorsToRgba=
function(){if(!this._converted){if(this.color&&n.str(this.color))this.color=w.fromStr(this.color);else if(this.grad)for(var a=this.grad.stops,c=0,b=a.length;c<b;c++)n.str(a[c][1])&&(a[c][1]=w.from(a[c][1]));this._converted=!0}};b.prototype.adapt=function(a){if(this.color&&n.str(this.color))return this.color;if(this.color)return w.toRgbaStr(this.color);if(this.grad){var c=this.grad,b=c.stops,f=c.dir||[[.5,0],[.5,1]],d=c.r||[1,1];bounds=c.bounds||[0,0,1,1];a=n.defined(c.r)?bounds?a.createRadialGradient(bounds[0]+
f[0][0]*bounds[2],bounds[1]+f[0][1]*bounds[3],Math.max(bounds[2],bounds[3])*d[0],bounds[0]+f[1][0]*bounds[2],bounds[1]+f[1][1]*bounds[3],Math.max(bounds[2],bounds[3])*d[1]):a.createRadialGradient(f[0][0],f[0][1],d[0],f[1][0],f[1][1],d[1]):bounds?a.createLinearGradient(bounds[0]+f[0][0]*bounds[2],bounds[1]+f[0][1]*bounds[3],bounds[0]+f[1][0]*bounds[2],bounds[1]+f[1][1]*bounds[3]):a.createLinearGradient(f[0][0],f[0][1],f[1][0],f[1][1]);c=0;for(f=b.length;c<f;c++)d=b[c],a.addColorStop(d[0],w.adapt(d[1]));
return a}return this.pattern?(b=this.pattern.elm,c=h.createCanvas(this.pattern.w,this.pattern.h,null,1),f=c.getContext("2d"),b.pivot(0,0),b.disabled=!1,b.render(f,0,0),b.disabled=!0,a.createPattern(c,this.pattern.repeat)):null};b.prototype.clone=function(){var a=new b;a.type=this.type;this.color&&n.str(this.color)?a.color=this.color:this.color&&(a.color={r:this.color.r,g:this.color.g,b:this.color.b,a:this.color.a||1});if(this.grad){var c=this.grad,f={stops:[]};for(i=0;i<c.stops.length;i++)f.stops[i]=
[].concat(c.stops[i]);f.dir=[];for(i=0;i<c.dir.length;i++)f.dir[i]=[].concat(c.dir[i]);c.r&&(f.r=[].concat(c.r));a.grad=f}this.hasOwnProperty("width")&&(a.width=this.width);this.hasOwnProperty("cap")&&(a.cap=this.cap);this.hasOwnProperty("join")&&(a.join=this.join);this.hasOwnProperty("blurRadius")&&(a.blurRadius=this.blurRadius);this.hasOwnProperty("offsetX")&&(a.offsetX=this.offsetX);this.hasOwnProperty("offsetY")&&(a.offsetY=this.offsetY);return a};b.fill=function(c){var f=new b;f.type=a.BT_FILL;
n.obj(c)?c instanceof e?f.grad=c.get():c.stops?f.grad=c:c.elm&&(f.pattern=c):f.color=c;return f};b.stroke=function(c,f,d,p,e){c=c&&c instanceof b?c.clone():b.fill(c);c.type=a.BT_STROKE;c.width=f||0;c.cap=d||b.DEFAULT_CAP;c.join=p||b.DEFAULT_JOIN;c.mitter=e;return c};b.shadow=function(c,f,d,e){c=b.fill(c);c.type=a.BT_SHADOW;c.blurRadius=f||0;c.offsetX=d||0;c.offsetY=e||0;return c};b.value=function(c,f){var d=f||new b;if(c)if(n.str(c))d.type=a.BT_FILL,d.color=c;else if(n.obj(c))if(c=c instanceof e?
c.get():c,n.defined(c.r)&&n.defined(c.g)&&n.defined(c.b))d.type=a.BT_FILL,d.color=c;else if(c.color||c.grad){n.defined(c.width)?d.type=a.BT_STROKE:n.defined(c.blurRadius)||n.defined(c.offsetX)?d.type=a.BT_SHADOW:d.type=a.BT_FILL;for(var p in c)c.hasOwnProperty(p)&&(d[p]=c[p])}else throw u.element("Unknown type of brush");else throw u.element("Use Brush.fill, Brush.stroke or Brush.shadow to create brush from values");else d.type=a.BT_NONE};b.gradient=function(){return new e};b.qfill=function(a,c){a.fillStyle=
c};b.qstroke=function(a,c,f){a.lineWidth=f||1;a.strokeStyle=c;a.lineCap=b.DEFAULT_CAP;a.lineJoin=b.DEFAULT_JOIN};b.clearFill=function(a){a.fillStyle=b.DEFAULT_FILL};b.clearStroke=function(a){a.strokeStyle=b.DEFAULT_STROKE;a.lineWidth=0;a.lineCap=b.DEFAULT_CAP;a.lineJoin=b.DEFAULT_JOIN};b.clearShadow=function(a){a.shadowColor=b.DEFAULT_SHADOW;a.shadowBlur=0;a.shadowOffsetX=0;a.shadowOffsetY=0};b.interpolateBrushes=function(f,d){var e=n.equal(f,d);f=f instanceof b?f:b.value(f);f._converted||f.convertColorsToRgba();
if(e)return function(){return f};d=d instanceof b?d:b.value(d);d._converted||d.convertColorsToRgba();var p=f.clone();return function(b){n.defined(f.width)&&n.defined(d.width)&&(p.width=c.interpolateFloat(f.width,d.width,b));f.type===a.BT_SHADOW&&(p.offsetX=c.interpolateFloat(f.offsetX,d.offsetX,b),p.offsetY=c.interpolateFloat(f.offsetY,d.offsetY,b),p.blurRadius=c.interpolateFloat(f.blurRadius,d.blurRadius,b));if(f.color)p.grad=null,p.color=w.toRgbaStr(w.interpolate(f.color,d.color,b));else if(f.grad){p.color=
null;p.grad||(p.grad={});var e=p.grad,h=f.grad,x=d.grad,u;for(u=0;u<h.dir.length;u++)e.dir[u]||(e.dir[u]=[]),e.dir[u][0]=c.interpolateFloat(h.dir[u][0],x.dir[u][0],b),e.dir[u][1]=c.interpolateFloat(h.dir[u][1],x.dir[u][1],b);e.stops&&e.stops.length===h.stops.length||(e.stops=[]);for(u=0;u<h.stops.length;u++)e.stops[u]||(e.stops[u]=[]),e.stops[u][0]=c.interpolateFloat(h.stops[u][0],x.stops[u][0],b),e.stops[u][1]=w.toRgbaStr(w.interpolate(h.stops[u][1],x.stops[u][1],b));h.r?(e.r||(e.r=[]),e.r[0]=c.interpolateFloat(h.r[0],
x.r[0],b),e.r[1]=c.interpolateFloat(h.r[1],x.r[1],b)):e.r=null}p.invalidate();return p}};e.prototype.stops=function(a){if(n.defined(a)){var c=[],b;for(b in a)c.push([parseFloat(b),a[b]]);this.$stops=c;return this}a={};c=this.$stops;for(b=0;b<c.length;b++)a[c[b][0]]=c[b][1];return a};e.prototype.radial=function(){this.$radial=!0;return this};e.prototype.radius=function(a){if(!n.defined(a))return this.$radius;this.$radial=!0;this.$radius=a;return this};e.prototype.start=function(a,c){if(!n.defined(a))return[this.$bounds[0],
this.$bounds[1]];this.$bounds[0]=a;this.$bounds[1]=c;return this};e.prototype.size=function(a,c){if(!n.defined(a))return[this.$bounds[2],this.$bounds[3]];this.$bounds[2]=a;this.$bounds[3]=c;return this};e.prototype.from=function(a,c){if(!n.defined(a))return this.$direction[0];this.$direction[0][0]=a;this.$direction[0][1]=c;return this};e.prototype.to=function(a,c){if(!n.defined(a))return this.$direction[1];this.$direction[1][0]=a;this.$direction[1][1]=c;return this};e.prototype.get=function(){return{r:this.$radial?
this.$radius||[1,1]:null,stops:this.$stops,bounds:this.$bounds,dir:this.$direction}};z.exports=b},{"../conf.js":11,"../constants.js":12,"../errors.js":13,"../utils.js":39,"./color.js":18,engine:40}],18:[function(d,z,r){var b=d("../utils.js"),e=b.is,a={TRANSPARENT:"transparent",HEX_RE:/^#?([a-fA-F\d]{2})([a-fA-F\d]{2})([a-fA-F\d]{2})$/i,HEX_SHORT_RE:/^#?([a-fA-F\d])([a-fA-F\d])([a-fA-F\d])$/i,RGB_RE:/^rgb\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)$/i,RGBA_RE:/^rgba\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*(\d*[.]?\d+)\s*\)$/i,
HSL_RE:/^hsl\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*%\s*,\s*([0-9]{1,3})\s*%\s*\)$/i,HSLA_RE:/^hsla\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*%\s*,\s*([0-9]{1,3})\s*%\s*,\s*(\d*[.]?\d+)\s*\)$/i,from:function(b){return e.str(b)?a.fromStr(b):b.r&&b},fromStr:function(b){return a.fromHex(b)||a.fromRgb(b)||a.fromRgba(b)||a.fromHsl(b)||{r:0,g:0,b:0,a:0}},fromHex:function(b){if("#"!==b[0])return null;var c=a.HEX_RE.exec(b);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16),a:1}:(c=a.HEX_SHORT_RE.exec(b))?
{r:parseInt(c[1]+c[1],16),g:parseInt(c[2]+c[2],16),b:parseInt(c[3]+c[3],16),a:1}:null},fromRgb:function(b){return 0!==b.indexOf("rgb(")?null:(b=a.RGB_RE.exec(b))?{r:parseInt(b[1]),g:parseInt(b[2]),b:parseInt(b[3]),a:1}:null},fromRgba:function(b){return 0!==b.indexOf("rgba(")?null:(b=a.RGBA_RE.exec(b))?{r:parseInt(b[1]),g:parseInt(b[2]),b:parseInt(b[3]),a:parseFloat(b[4])}:null},fromHsl:function(b){return 0!==b.indexOf("hsl(")?null:(b=a.HSL_RE.exec(b))?a.fromHslVal(parseInt(b[1])/180*Math.PI,parseInt(b[2])/
100,parseInt(b[3])/100):null},fromHsla:function(b){if(0!==b.indexOf("hsla("))return null;b=a.HSLA_RE.exec(hsl);if(!b)return null;b=a.fromHslVal(parseInt(b[1])/180*Math.PI,parseInt(b[2])/100,parseInt(b[3])/100);b.a=parseFloat(b[4]);return b},fromHslVal:function(b,c,d){var e=a.hueToRgb;c=.5>=d?d*(c+1):d+c-d*c;d=2*d-c;return{r:e(d,c,b+2),g:e(d,c,b),b:e(d,c,b-2),a:1}},hueToRgb:function(a,c,b){0>b&&(b+=6);6<=b&&(b-=6);return 1>b?(c-a)*b+a:3>b?c:4>b?(c-a)*(4-b)+a:a},rgb:function(a,c,b){return"rgb("+a+","+
c+","+b+")"},rgba:function(a,c,b,d){return"rgba("+a+","+c+","+b+","+(e.defined(d)?d.toFixed(2):1)+")"},hsl:function(b,c,d){return a.dhsl(b/Math.PI*180,c,d)},dhsl:function(a,c,b){return"hsl("+Math.floor(a)+","+Math.floor(100*c)+"%,"+Math.floor(100*b)+"%)"},hsla:function(b,c,d,e){return a.dhsla(b/Math.PI*180,c,d,e)},dhsla:function(a,c,b,d){return"hsla("+Math.floor(a)+","+Math.floor(100*c)+"%,"+Math.floor(100*b)+"%,"+(e.defined(d)?d.toFixed(2):1)+")"},adapt:function(b){if(!b)return null;if(e.str(b))return b;
if(e.defined(b.g))return a.toRgbaStr(b);if(e.defined(b.h))return a.toHslaStr(b)},toRgbaStr:function(b){return a.rgba(b.r,b.g,b.b,b.a)},toHslaStr:function(b){return a.hsla(b.h,b.s,b.l,b.a)},interpolate:function(a,c,d){return{r:Math.round(b.interpolateFloat(a.r,c.r,d)),g:Math.round(b.interpolateFloat(a.g,c.g,d)),b:Math.round(b.interpolateFloat(a.b,c.b,d)),a:b.interpolateFloat(a.a,c.a,d)}}};z.exports=a},{"../utils.js":39}],19:[function(d,z,r){function b(c){this.segs=[];this.closed=!1;a.str(c)?(this.parse(c),
this.updatePath2D(c)):a.arr(c)&&(this.segs=c);this.cached_hits={}}d("../constants.js");var e=d("../utils.js"),a=e.is;r=d("./segments.js");var f=r.MSeg,c=r.LSeg,n=r.CSeg,h=r.Crossings,u=d("engine"),w=!!u.Path2D,m=d("./brush.js"),y=d("./bounds.js");b.prototype.visit=function(a,c){for(var b=this.segs,d=0,e=b.length;d<e;d++)a(b[d],c);return this};b.prototype.length=function(){if(a.defined(this.cached_len))return this.cached_len;var c=0,b=this.start();this.visit(function(a){c+=a.length(b);b=a.last()});
return this.cached_len=c};b.prototype.add=function(a){this.segs.push(a);this._p2dCurrent=!1;return this};b.prototype.move=function(a,c){return this.add(new f([a,c]))};b.prototype.line=function(a,b){return this.add(new c([a,b]))};b.prototype.curve=function(a,c,b,d,e,f){return this.add(new n([a,c,b,d,e,f]))};b.prototype.close=function(){this.closed=!0;return this};b.prototype.apply=function(a,c,b,d){if(w)return this.updatePath2D(),d&&d.apply(a),c&&(c.apply(a),a.fill(this.path2d)),d&&m.clearShadow(a),
b&&(b.apply(a),a.stroke(this.path2d)),this;a.beginPath();for(var e=this.segs,f=0,v=e.length;f<v;f++)e[f].draw(a);this.closed&&a.closePath();d&&d.apply(a);c&&(c.apply(a),a.fill());d&&m.clearShadow(a);b&&(b.apply(a),a.stroke());return this};b.prototype.parse=function(a){a&&b.parse(a,this);return this};b.prototype.hitAt=function(c){if(a.defined(this.cached_hits[c]))return this.cached_hits[c];var b=this.length();if(0===b||0>c||1<c)return null;var d=this.start(),f=e.roundTo(c,3);if(0===c)return this.cached_hits[f]=
{seg:this.segs[0],start:d,slen:0,segt:0};var h=this.segs.length;if(0===h)return null;c*=b;for(var n=0,v,k=0;k<h;k++){b=this.segs[k];v=b.length(d);if(c<=n+v)return h=c-n,this.cached_hits[f]={seg:b,start:d,slen:v,segt:0!=v?b.findT(d,h):0};n+=v;d=b.last()}return null};b.prototype.pointAt=function(a){return(a=this.hitAt(a))?a.seg.atT(a.start,a.segt):this.start()};b.prototype.inside=function(a){var c=a.x;a=a.y;var b=this.segs.length;if(2>b)return!1;for(var d=this.start(),e=d,f=0,v=0;v<b;v++)var k=this.segs[v],
f=f+k.crossings(e,c,a),e=k.last();d!==e&&(f+=h.line(c,a,e[0],e[1],d[0],d[1]));return 0!==(f&-1)};b.prototype.tangentAt=function(a){return(a=this.hitAt(a))?a.seg.tangentAt(a.start,a.segt):0};b.prototype.start=function(){return 1>this.segs.length?null:[this.segs[0].pts[0],this.segs[0].pts[1]]};b.prototype.end=function(){return 1>this.segs.length?null:this.segs[this.segs.length-1].last()};b.prototype.bounds=function(){if(this.$bounds)return this.$bounds;if(0>=this.segs.length)return y.NONE;var a=this.segs[0].pts[0],
c=this.segs[0].pts[0],b=this.segs[0].pts[1],d=this.segs[0].pts[1];this.visit(function(e){e=e.pts;var f=e.length,v;for(v=0;v<f;v+=2)a=Math.min(a,e[v]),c=Math.max(c,e[v]);for(v=1;v<f;v+=2)b=Math.min(b,e[v]),d=Math.max(d,e[v])});return this.$bounds=new y(a,b,c-a,d-b)};b.prototype.vpoints=function(a){this.visit(function(c){c=c.pts;for(var b=c.length,d=0;d<b;d+=2){var e=a(c[d],c[d+1]);e&&(c[d]=e[0],c[d+1]=e[1])}})};b.prototype.shift=function(a){this.vpoints(function(c,b){return[c+a[0],b+a[1]]});return this};
b.prototype.zoom=function(a){this.vpoints(function(c,b){return[c*a[0],b*a[1]]});return this};b.prototype.normalize=function(){var a=this.bounds(),c=Math.floor(a.width/2),b=Math.floor(a.height/2),d=a.x,e=a.y;this.vpoints(function(a,f){return[a-d-c,f-e-b]});return[c,b]};b.prototype.getPoints=function(){var a=[];this.visit(function(c){a=a.concat(c.pts)});return a};b.prototype.toString=function(){return"[ Path '"+b.toSVGString(this)+"' ]"};b.prototype.clone=function(){var a=new b;this.visit(function(c){a.add(c.clone())});
clone.closed=this.closed;return a};b.prototype.invalidate=function(){this.cached_len=void 0;this.cached_hits={};this.$bounds=null};b.prototype.reset=function(){this.segs=[];this.closed=!1};b.prototype.dispose=function(){};b.prototype.updatePath2D=function(a){w&&!this._p2dCurrent&&(a=a||b.toSVGString(this),this.path2d=new u.Path2D(a),this._p2dCurrent=!0)};b.toSVGString=function(a){var c=[];a.visit(x,c);c.push("Z");return c.join(" ")};var x=function(a,c){c.push(a.toString())};b.parse=function(a,c){c=
c||new b;c.segs=[];for(var d=a.match(/[a-z][^a-z]*/ig),e=0;e<d.length;e++){var f=b.parseSegment(d[e]);f&&c.segs.push(f)}c.str=a;return c};b.parseSegment=function(a){a=a.toUpperCase();var b=a.substring(1).trim().replace(/,/g," ").split(" ").map(function(a){return parseFloat(a)});switch(a[0]){case "M":return new f(b);case "L":return new c(b);case "C":return new n(b);default:return null}};z.exports=b},{"../constants.js":12,"../utils.js":39,"./bounds.js":16,"./brush.js":17,"./segments.js":20,engine:40}],
20:[function(d,z,r){function b(a){this.pts=a}function e(a){this.pts=a}function a(a){this.pts=a;this._cachedStart=null;this._length=0}d("../constants.js");b.prototype.draw=function(a){a.moveTo(this.pts[0],this.pts[1])};b.prototype.length=function(a){return 0};b.prototype.findT=function(a,b){return 0};b.prototype.atDist=function(a,b){return this.atT(a,null)};b.prototype.atT=function(a,b){return[this.pts[0],this.pts[1]]};b.prototype.tangentAt=function(a,b){return 0};b.prototype.crossings=function(a,
b,d){return 0};b.prototype.last=function(){return[this.pts[0],this.pts[1]]};b.prototype.toString=function(){return"M"+this.pts.join(" ")};b.prototype.clone=function(){return new b(this.pts)};e.prototype.draw=function(a){a.lineTo(this.pts[0],this.pts[1])};e.prototype.length=function(a){var b=this.pts[0]-a[0];a=this.pts[1]-a[1];return Math.sqrt(b*b+a*a)};e.prototype.findT=function(a,b){if(0>=b)return 0;var d=this.length(a);return b>=d?1:b/d};e.prototype.atDist=function(a,b){return this.atT(a,this.findT(a,
b))};e.prototype.atT=function(a,b){var d=a[0],e=a[1];return[d+(this.pts[0]-d)*b,e+(this.pts[1]-e)*b]};e.prototype.tangentAt=function(a,b){return Math.atan2(this.pts[1]-a[1],this.pts[0]-a[0])};e.prototype.crossings=function(a,b,d){return f.line(b,d,a[0],a[1],this.pts[0],this.pts[1])};e.prototype.last=function(){return[this.pts[0],this.pts[1]]};e.prototype.toString=function(){return"L"+this.pts.join(" ")};e.prototype.clone=function(){return new e(this.pts)};a.prototype.draw=function(a){a.bezierCurveTo(this.pts[0],
this.pts[1],this.pts[2],this.pts[3],this.pts[4],this.pts[5])};a.prototype.length=function(a){if(this._cachedStart&&this._cachedStart[0]===a[0]&&this._cachedStart[1]===a[1])return this._length;this._cachedStart=a;return this._length=this.findLengthAndT(a,Number.MAX_VALUE)[0]};a.prototype.findT=function(a,b){return this.findLengthAndT(a,b)[1]};a.prototype.findLengthAndT=function(a,b){for(var d=this.pts,e=a[0],f=a[1],m=d[0],y=d[1],x=d[2],p=d[3],A=d[4],t=d[5],d=Math.sqrt(Math.pow(m-e,2)+Math.pow(y-f,
2))+Math.sqrt(Math.pow(x-m,2)+Math.pow(p-y,2))+Math.sqrt(Math.pow(A-x,2)+Math.pow(t-p,2))+1,B=1/d,C=3*B,r=C*B,v=B*B*B,k=2*r,g=6*v,q=e-2*m+x,D=f-2*y+p,A=3*(m-x)-e+A,t=3*(y-p)-f+t,p=e,x=f,e=(m-e)*C+q*r+v*A,f=(y-f)*C+D*r+v*t,y=q*k+A*g,k=D*k+t*g,D=A*g,g=t*g,A=q=0;A<d;A++)if(m=p,C=x,p+=e,x+=f,e+=y,f+=k,y+=D,k+=g,q+=Math.sqrt((p-m)*(p-m)+(x-C)*(x-C)),q>=b)return[q,B*A];return[q,1]};a.prototype.atDist=function(a,b){return this.atT(a,this.findT(a,b))};a.prototype.atT=function(a,b){var d=b*b,e=d*b,f=1-b,m=
f*f,y=m*f,m=3*b*m,d=3*d*f;return[a[0]*y+this.pts[0]*m+this.pts[2]*d+this.pts[4]*e,a[1]*y+this.pts[1]*m+this.pts[3]*d+this.pts[5]*e]};a.prototype.tangentAt=function(a,b){0>b&&(b=0);1<b&&(b=1);var d=3*(1-b)*(1-b),e=6*(1-b)*b,f=3*b*b;return Math.atan2(d*(this.pts[1]-a[1])+e*(this.pts[3]-this.pts[1])+f*(this.pts[5]-this.pts[3]),d*(this.pts[0]-a[0])+e*(this.pts[2]-this.pts[0])+f*(this.pts[4]-this.pts[2]))};a.prototype.crossings=function(a,b,d){var e=this.pts;return f.curve(b,d,a[0],a[1],e[0],e[1],e[2],
e[3],e[4],e[5],0)};a.prototype.last=function(){return[this.pts[4],this.pts[5]]};a.prototype._ensure_params=function(a){this._lstart&&this._lstart[0]===a[0]&&this._lstart[1]===a[1]||(this._lstart=a,this._params=this._calc_params(a))};a.prototype._calc_params=function(a){var b=this.pts,d=[],e=a[0];a=a[1];var f=b[0],m=b[1],y=b[2],x=b[3],p=b[5];d[0]=b[4]-3*y+3*f-e;d[1]=3*y-6*f+3*e;d[2]=3*f-3*e;d[3]=e;d[4]=p-3*x+3*m-a;d[5]=3*x-6*m+3*a;d[6]=3*m-3*a;d[7]=a;return d};a.prototype.clone=function(){return new a(this.pts)};
a.prototype.toString=function(){return"C"+this.pts.join(" ")};var f={curve:function(a,b,d,e,w,m,y,x,p,A,t){if(b<e&&b<m&&b<x&&b<A||b>=e&&b>=m&&b>=x&&b>=A||a>=d&&a>=w&&a>=y&&a>=p)return 0;if(a<d&&a<w&&a<y&&a<p){if(b>=e){if(b<A)return 1}else if(b>=A)return-1;return 0}if(52<t)return f.line(a,b,d,e,p,A);var B=(w+y)/2,C=(m+x)/2;w=(d+w)/2;m=(e+m)/2;y=(y+p)/2;x=(x+A)/2;var r=(w+B)/2,v=(m+C)/2,k=(B+y)/2,g=(C+x)/2,B=(r+k)/2,C=(v+g)/2;return isNaN(B)||isNaN(C)?0:f.curve(a,b,d,e,w,m,r,v,B,C,t+1)+f.curve(a,b,
B,C,k,g,y,x,p,A,t+1)},line:function(a,b,d,e,f,m){return b<e&&b<m||b>=e&&b>=m||a>=d&&a>=f?0:a<d&&a<f?e<m?1:-1:a>=d+(b-e)*(f-d)/(m-e)?0:e<m?1:-1}};z.exports={MSeg:b,LSeg:e,CSeg:a,Crossings:f}},{"../constants.js":12}],21:[function(d,z,r){r=d("../animation/element.js");var b=d("./path.js");d=d("./segments.js");var e=d.MSeg,a=d.LSeg;r.prototype.dot=function(){var a=this;this.paint(function(b){b.beginPath();b.arc(0,0,3,0,2*Math.PI,!1);b.closePath();a.applyBrushes(b)});return this};r.prototype.rect=function(d,
c){c=c||d;var n=new b;n.add(new e([0,0]));n.add(new a([0+d,0]));n.add(new a([0+d,0+c]));n.add(new a([0,0+c]));n.add(new a([0,0]));this.path(n);return this};r.prototype.oval=function(a,b){var d=this,e=a/2,u=b?b/2:e;this.paint(function(a){a.ellipse&&(a.beginPath(),a.ellipse(0,0,e,u,0,0,2*Math.PI,!1),a.closePath(),d.applyBrushes(a))});return this};r.prototype.triangle=function(d,c){c=c||d;var n=d/2,h=new b;h.add(new e([0+n,0]));h.add(new a([0+d,0+c]));h.add(new a([0,0+c]));h.add(new a([0+n,0]));this.path(h);
return this};z.exports={}},{"../animation/element.js":6,"./path.js":19,"./segments.js":20}],22:[function(d,z,r){function b(a,c,d){this.id=b.instances++;this.src=a;this._dimen=[0,0];this.regions=[[0,0,1,1]];this.regions_f=null;this.cur_region=d||0;this.wasError=this.ready=!1;this._image=null;this._callback=c;this._thumbnail=!1}var e=d("../conf.js"),a=d("../log.js"),f=d("engine"),c=d("../resource_manager.js"),n=d("../errors.js"),h=d("./bounds.js");b.instances=0;b.MISSED_SIDE=50;b.prototype.load=function(b,
d,h,y){h=h||this._callback;if(this._image)throw n.element("Image already loaded",b);var x=this;x.src?c.loadOrGet(b,x.src,function(a,b,c){c=f.checkMediaUrl(x.src);if(!x._thumbnail&&e.doNotLoadImages)b("Loading images is turned off");else{var d=new Image,h=f.getAnmProps(d);d.onload=d.onreadystatechange=function(){h.ready||(this.readyState&&"complete"!==this.readyState&&b(this.readyState),h.ready=!0,d.isReady=!0,a(d))};d.onerror=b;d.addEventListener("error",b,!1);try{d.src=c}catch(m){b(m)}}},function(a){x._image=
a;x._dimen=[a.width,a.height];x.ready=!0;h&&h.call(x,a)},function(b){a.error(b.srcElement||b.path,b.message||b);x.ready=!0;var c=x.wasError=!0;y&&(c=!y.call(x,b));if(c)throw n.element(b?b.message:"Unknown",elm);}):(a.error("Empty source URL for image"),x.ready=!0,x.wasError=!0,y&&y.call(x,"Empty source"))};b.prototype.updateRegion=function(){if(!(0>this.cur_region)){var a;if(this.region_f)a=this.region_f(this.cur_region);else{a=this.regions[this.cur_region];var b=this._dimen;a=[a[0]*b[0],a[1]*b[1],
a[2]*b[0],a[3]*b[1]]}this.region=a}};b.prototype.apply=function(a){if(this.ready)if(this.wasError)this.applyMissed(a);else{this.updateRegion();var b=this.region;a.drawImage(this._image,b[0],b[1],b[2],b[3],0,0,b[2],b[3])}};b.prototype.applyMissed=function(a){a.save();a.strokeStyle="#900";a.lineWidth=1;a.beginPath();var c=b.MISSED_SIDE;a.moveTo(0,0);a.lineTo(c,0);a.lineTo(0,c);a.lineTo(c,c);a.lineTo(0,0);a.lineTo(0,c);a.lineTo(c,0);a.lineTo(c,c);a.stroke();a.restore()};b.MISSED_BOUNDS=new h(0,0,b.MISSED_SIDE,
b.MISSED_SIDE);b.prototype.bounds=function(){if(this.wasError)return b.MISSED_BOUNDS;if(!this.ready)return h.NONE;this.region||this.updateRegion();var a=this.region;return new h(0,0,a[2],a[3])};b.prototype.inside=function(a){return!0};b.prototype.clone=function(){return new b(this.src)};b.prototype.invalidate=function(){};b.prototype.reset=function(){};b.prototype.dispose=function(){};z.exports=b},{"../conf.js":11,"../errors.js":13,"../log.js":28,"../resource_manager.js":35,"./bounds.js":16,engine:40}],
23:[function(d,z,r){function b(c,d,e,f,y){this.lines=c;this.$font=d||b.DEFAULT_FONT;this.$align=e||b.DEFAULT_ALIGN;this.baseline=f||b.DEFAULT_BASELINE;this.underlined=a.defined(y)?y:b.DEFAULT_UNDERLINE;this.size=-1;this.$bounds=null}var e=d("../constants.js"),a=d("../utils.js").is,f=d("../errors.js");r=d("engine");var c=d("./brush.js"),n=d("./bounds.js");b.DEFAULT_FFACE="sans-serif";b.DEFAULT_FSIZE=24;b.DEFAULT_FONT=b.DEFAULT_FSIZE+"px "+b.DEFAULT_FFACE;b.DEFAULT_ALIGN=e.TA_LEFT;b.DEFAULT_BASELINE=
e.BL_MIDDLE;b.DEFAULT_UNDERLINE=!1;b.__measuring_f=r.createTextMeasurer();b.prototype.apply=function(a,d,e,f){var y=this.bounds(),x=y.height/this.lineCount(),p=this.underlined;a.font=this.$font;a.textBaseline=this.baseline||b.DEFAULT_BASELINE;a.textAlign=this.$align||b.DEFAULT_ALIGN;var n=this.ascent(x,a.textBaseline),t=this.xOffset(y.width,a.textAlign),B;f?f.apply(a):c.clearShadow(a);d?(d.apply(a),B=0,this.visitLines(function(b){a.fillText(b,t,B+n);B+=x})):c.clearFill(a);f&&c.clearShadow(a);e?(e.apply(a),
B=0,this.visitLines(function(b){a.strokeText(b,t,B+n);B+=x})):c.clearStroke(a);if(p&&d){B=0;e=c.stroke(d,1);e.apply(a);var C=null,r=0,v=this;this.visitLines(function(c){C=b.bounds(v,c);r=C.width;a.beginPath();a.moveTo(t,B+x);a.lineTo(r,B+x);a.stroke();B+=x})}};b.prototype.font=function(a){if(!a)return this.$font;this.$font=a;return this};b.prototype.align=function(a){if(!a)return this.$align;this.$align=a;return this};b.prototype.bounds=function(){return this.$bounds?this.$bounds:this.$bounds=b.bounds(this,
this.lines)};b.prototype.inside=function(a){return!0};b.prototype.ascent=function(a,b){return b==e.BL_MIDDLE?a/2:a};b.prototype.xOffset=function(a,b){return b==e.TA_LEFT?0:b==e.TA_CENTER?a/2:b==e.TA_RIGHT?a:0};b.prototype.lineCount=function(){var b=this.lines;return a.arr(b)?b.length:1};b.prototype.visitLines=function(b,c){var d=this.lines;if(a.arr(d))for(var e,f=0,x=d.length;f<x;f++)e=d[f],b(e);else b(d.toString())};b.prototype.clone=function(){var a=new b(this.lines,this.$font);this.lines&&Array.isArray(this.lines)&&
(a.lines=[].concat(this.lines));return a};b.prototype.invalidate=function(){this.$bounds=null};b.prototype.reset=function(){};b.prototype.dispose=function(){};b.bounds=function(a,c){if(!b.__measuring_f)throw f.system("no Text buffer, bounds call failed");var d=b.__measuring_f(a,c);return new n(0,0,d[0],d[1])};z.exports=b},{"../constants.js":12,"../errors.js":13,"../utils.js":39,"./bounds.js":16,"./brush.js":17,engine:40}],24:[function(d,z,r){var b=d("./errors.js"),e={register:function(a,d){if(e[a])throw b.system("Importer "+
a+" is already registered!");e[a]=d},get:function(a){if(!e[a])throw b.system("Importer "+a+" is not registered!");return e[a]},create:function(a){if(!e[a])throw b.system("Importer "+a+" is not registered!");return new e[a]},isAccessible:function(a){return"undefined"!==typeof e[a]}};z.exports=e},{"./errors.js":13}],25:[function(d,z,r){var b=d("engine"),e=d("../constants.js"),a={play:function(){this.play()},pause:function(){this.pause()},getPaused:function(){return this.state.happens===e.PAUSED},mute:function(){this.mute()},
unmute:function(){this.unmute()},isMuted:function(){return this.muted},setVolume:function(a){x.volume(a.value/100)},getVolume:function(){return 100*x.volume()},getDuration:function(){return x.state.duration},setCurrentTime:function(a){a=a.value;this.pause().play(a)},getCurrentTime:function(){return this.state.time},setLoop:function(a){this.repeat=a.value},getLoop:function(){return this.repeat},addEventListener:function(a){var b=a.value;a=a.listener;if(f[b]&&-1===f[b].indexOf(a))return f[b].push(a),
{}},removeEventListener:function(a){var b=a.value;a=a.listener;f[b]&&(a?(a=f[b].indexOf(a),-1!==a&&f[b].splice(a,1)):f[b]=[])}},f={progress:[],timeupdate:[],play:[],pause:[],ended:[]},c=["ready"],n;for(n in f)c.push(n);var h=[],u;for(u in a)h.push(u);var w=b.getIframeOrigin();d=function(c){var d;try{d=JSON.parse(c.data)}catch(e){d={}}c.origin===w&&"player.js"===d.context&&a[d.method]&&x&&(c=a[d.method].call(x,d),b.postToContentWindow({context:"player.js",version:"0.0.10",event:d.method,listener:d.listener,
value:c}))};b.isInIframe()&&b.addMessageListener(d);var m=function(a,c,d){c={context:"player.js",version:"0.0.10",event:a,value:c||{}};if(d)b.postToContentWindow(c);else if(f[a]&&0!==f[a].length)for(d=0;d<f[a].length;d++)c.listener=f[a][d],b.postToContentWindow(c)},y=function(a){b.isInIframe()&&(a.on(e.S_LOAD,function(){m("ready",{src:b.getIframeSrc(),events:c,methods:h},!0)}),a.on(e.S_LOADING_PROGRESS,function(a){m("progress",{percent:100*a})}),a.on(e.S_PLAY,function(){m("play")}),a.on(e.S_PAUSE,
function(){m("pause")}),a.on(e.S_COMPLETE,function(){m("ended")}),a.on(e.S_TIME_UPDATE,function(b){m("timeupdate",{seconds:b,duration:a.state?a.state.duration:b})}))},x;z.exports={setPlayer:function(a){x=a;y(a)}}},{"../constants.js":12,engine:40}],26:[function(d,z,r){var b=d("./utils.js"),e=b.is,a=d("./loc.js").Errors,f=d("./errors.js"),c=d("./constants.js"),n=d("./global_opts.js"),h=d("engine"),u=d("./animation/animation.js"),w={loadAnimation:function(a,b,c){a.anim&&a.anim.dispose(a);b.playedIn(a);
a.debug&&!n.liveDebug&&b.traverse(function(a){a.addDebugRender()});b.width&&b.height?a.forceAnimationSize&&a._resize(b.width,b.height):(b.width=a.width,b.height=a.height);a.anim=b;b.actions&&w.applyActions(a,b,b.actions);c&&c.call(a,b);a._checkOpts()},loadFromUrl:function(c,d,e,n){if(!JSON)throw f.system(a.S.NO_JSON_PARSER,c);e=e||anm.importers.create("animatron");var t=d.split("?");d=t[0];var u=(t=t[1])&&0<t.length?b.paramsToObj(t):{};if(t=m(u))c._addOpts(t),c._checkOpts();var C=function(c){throw f.system(b.strf(a.P.SNAPSHOT_LOADING_FAILED,
[c?c.message||c:"\u00bfPor qu\u00e9?"]));},t=h.getCookie("_animatronauth");h.ajax(d,function(a){try{w.loadFromObj(c,JSON.parse(a.responseText),e,function(a){n&&n.call(c,a);c._applyUrlParamsToAnimation(u)})}catch(b){C(b)}},C,"GET",t?{"Animatron-Security-Token":t}:null)},loadFromObj:function(b,d,e,h){if(!e)throw f.player(a.P.NO_IMPORTER_TO_LOAD_WITH,b);var t=e.load(d);b.fire(c.S_IMPORT,e,t,d);w.loadAnimation(b,t,h)},loadElements:function(a,b,c){var d=new u;d.add(b);w.loadAnimation(a,d,c)},applyActions:function(a,
b,c){eval("(function(p, a){"+c+";actions.call(p,a);})")(a,b);a.handleEvents=!0}},m=function(a){function b(a){if(!a||0===a||"0"==a)return!1;if(1==a)return!0;if("false"==a)return!1;if("true"==a)return!0;if("off"==a)return!1;if("on"==a)return!0;if("no"==a)return!1;if("yes"==a)return!0}function c(){for(var d=arguments,f=0;f<d.length;f++)if(e.defined(a[d[f]]))return b(a[d[f]])}var d={};d.debug=e.defined(a.debug)?b(a.debug):void 0;d.muteErrors=c("me","muterrors");d.repeat=c("r","repeat");d.autoPlay=c("a",
"auto","autoplay");d.mode=a.m||a.mode||void 0;d.zoom=a.z||a.zoom;d.speed=a.v||a.speed;d.width=a.w||a.width;d.height=a.h||a.height;d.infiniteDuration=c("i","inf","infinite");d.audioEnabled=c("s","snd","sound","audio");d.handleEvents=c("he","events");d.controlsEnabled=c("c","controls");d.controlsInvisible=c("controlsInvisible");d.infoEnabled=c("info");d.loadingMode=a.lm||a.lmode||a.loadingmode||void 0;d.thumbnail=a.th||a.thumb||void 0;d.bgColor=a.bg||a.bgcolor;d.ribbonsColor=a.rc||a.ribbons||a.ribcolor;
return d};z.exports=w},{"./animation/animation.js":3,"./constants.js":12,"./errors.js":13,"./global_opts.js":15,"./loc.js":27,"./utils.js":39,engine:40}],27:[function(d,z,r){d={S:{},P:{},A:{}};d.S.CANVAS_NOT_SUPPORTED="Your browser does not support HTML5 canvas, so we cannot play anything for you.";d.S.SAD_SMILEY_HTML='<span style="font-size: 4em;">:(</span><br>'+d.S.CANVAS_NOT_SUPPORTED;d.S.NO_JSON_PARSER="JSON parser is not accessible";d.S.ERROR_HANDLING_FAILED="Error-handling mechanics were broken with error {0}";
d.S.NO_METHOD_FOR_PLAYER="No method '{0}' exist for player";d.P.NO_IMPORTER_TO_LOAD_WITH="Cannot load this project without importer. Please define it";d.P.NO_WRAPPER_WITH_ID="No element found with given id: {0}";d.P.NO_WRAPPER_WAS_PASSED="No element was passed to player initializer";d.P.CANVAS_NOT_VERIFIED="Canvas is not verified by the provider";d.P.CANVAS_NOT_PREPARED="Canvas is not prepared, don't forget to call 'init' method";d.P.ALREADY_PLAYING="Player is already in playing mode, please call 'stop' or 'pause' before playing again";
d.P.PAUSING_WHEN_STOPPED="Player is stopped, so it is not allowed to pause";d.P.NO_ANIMATION_PASSED="No animation passed to load method";d.P.NO_STATE="There's no player state defined, nowhere to draw, please load something in player before calling its playing-related methods";d.P.NO_ANIMATION="There's nothing at all to manage with, please load something in player before calling its playing-related methods";d.P.COULD_NOT_LOAD_WHILE_PLAYING="Could not load any animation while playing or paused, please stop player before loading";
d.P.LOAD_WAS_ALREADY_POSTPONED="Load was called while loading process was already in progress";d.P.NO_LOAD_CALL_BEFORE_PLAY="No animation was loaded into player before the request to play";d.P.BEFOREFRAME_BEFORE_PLAY="Please assign beforeFrame callback before calling play()";d.P.AFTERFRAME_BEFORE_PLAY="Please assign afterFrame callback before calling play()";d.P.BEFORERENDER_BEFORE_PLAY="Please assign beforeRender callback before calling play()";d.P.AFTERRENDER_BEFORE_PLAY="Please assign afterRender callback before calling play()";
d.P.PASSED_TIME_VALUE_IS_NO_TIME="Given time is not allowed, it is treated as no-time";d.P.PASSED_TIME_NOT_IN_RANGE="Passed time ({0}) is not in animation range";d.P.DURATION_IS_NOT_KNOWN="Duration is not known";d.P.ALREADY_ATTACHED="Player is already attached to this canvas, please use another one";d.P.INIT_TWICE="Initialization was called twice";d.P.INIT_AFTER_LOAD="Initialization was called after loading a animation";d.P.SNAPSHOT_LOADING_FAILED="Snapshot failed to load ({0})";d.P.IMPORTER_CONSTRUCTOR_PASSED=
"You've passed importer constructor to snapshot loader, but not an instance! Probably you used anm.importers.get instead of anm.importers.create.";d.P.DOM_NOT_READY="Document in not yet ready, please consider moving your initialization script to the bottom of your web page";d.A.OBJECT_IS_NOT_ELEMENT="It appears that you've passed not an instance of anm.Element";d.A.ELEMENT_IS_REGISTERED="This element is already registered in animation";d.A.ELEMENT_IS_NOT_REGISTERED="There is no such element registered in animation";
d.A.UNSAFE_TO_REMOVE="Unsafe to remove, please use iterator-based looping (with returning false from iterating function) to remove safely";d.A.NO_ELEMENT_TO_REMOVE="Please pass some element or use detach() method";d.A.NO_ELEMENT="No such element found";d.A.ELEMENT_NOT_ATTACHED="Element is not attached to something at all";d.A.MODIFIER_NOT_ATTACHED="Modifier wasn't applied to anything";d.A.NO_MODIFIER_PASSED="No modifier was passed";d.A.NO_PAINTER_PASSED="No painter was passed";d.A.MODIFIER_REGISTERED=
"Modifier was already added to this element";d.A.PAINTER_REGISTERED="Painter was already added to this element";d.A.RESOURCES_FAILED_TO_LOAD="Some of resources required to play this animation were failed to load";d.A.MASK_SHOULD_BE_ATTACHED_TO_ANIMATION="Element to be masked should be attached to animation when rendering";z.exports={Strings:{COPYRIGHT:"Animatron Player",LOADING:"Loading...",LOADING_ANIMATION:"Loading {0}..."},Errors:d}},{}],28:[function(d,z,r){(function(b){var e,a,f,c,n=d("./conf.js"),
h=d("./constants.js"),u=function(){},w=b.console||{log:u,info:u,warn:u,error:u};b.console&&(e=w.debug||w.log,a=w.info||w.log,f=w.warn||w.log,c=w.error||w.log,w.log.apply||(e=Function.prototype.bind.call(e,w),a=Function.prototype.bind.call(a,w),f=Function.prototype.bind.call(f,w),c=Function.prototype.bind.call(e,w)));z.exports={debug:function(){n.logLevel&h.L_DEBUG&&e.apply(w,arguments)},info:function(){n.logLevel&h.L_INFO&&a.apply(w,arguments)},warn:function(){n.logLevel&h.L_WARN&&f.apply(w,arguments)},
error:function(){n.logLevel&h.L_ERROR&&c.apply(w,arguments)}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./conf.js":11,"./constants.js":12}],29:[function(d,z,r){(function(b){function e(a){this.url=/\.\w+$/i.test(a)?a:a+w;this.canPlay=this.playing=this.ready=!1;this.volume=1;this.audio=null}function a(a,b){return function(c){b(Error("Failed to load audio file from "+a+" with error code: "+(c&&c.currentTarget&&c.currentTarget.error)?
c.currentTarget.error.code:"Unknown"))}}d("../conf.js");var f=d("../log.js");d("../utils.js");var c=d("../constants.js");d("../errors.js");var n=d("engine"),h=d("../resource_manager.js"),u=n.createAudio(),w=u.canPlayType&&u.canPlayType("audio/ogg;").replace(/no/,"")?".ogg":".mp3",m=function(){if(n.isLocal)return null;var a=b.AudioContext||b.webkitAudioContext;if(!a)return null;if(b.anmAudioContext)return b.anmAudioContext;try{var c=new a;return b.anmAudioContext=c}catch(d){return null}}();e.prototype.load=
function(b,c){var d=this;h.loadOrGet(b,d.url,function(b,c,e){var f=n.checkMediaUrl(d.url);if(anm.conf.doNotLoadAudio)c("Loading audio is turned off");else if(m){var h={},v=function(a,g){try{m.decodeAudioData(a.buf,function(a){b(a)},function(b){var c=new Uint8Array(a.buf);c.indexOf=Array.prototype.indexOf;for(b=a.sync;;){a.retry++;b=c.indexOf(255,b);if(-1==b||c[b+1]&1)break;b++}-1!=b?(c=a.buf.slice(b),delete a.buf,a.buf=null,a.buf=c,a.sync=b,b=!0):b=!1;b&&v(a,g)})}catch(d){c("Unable to load audio "+
g+": "+d.message)}};h.xhr=new XMLHttpRequest;h.xhr.open("GET",f,!0);h.xhr.responseType="arraybuffer";h.xhr.addEventListener("load",function(a){a=a.target;200==a.status?(h.buf=a.response,h.sync=0,h.retry=0,v(h)):c("Unable to load audio "+f+": "+a.statusText)},!1);h.xhr.addEventListener("error",a(f,c),!1);h.xhr.send()}else{var k=n.createAudio();k.setAttribute("preload","auto");var g=function(a){a=k.buffered;1==a.length?4===k.readyState||3===k.readyState?(n.unsubscribeElementEvents(k,{progress:x,loadedmetadata:q,
canplay:u}),b(k),e(1)):d.canPlay&&window.chrome&&(k.volume=0,k.currentTime=a.end(0),k.play(),k.pause()):d.canPlay&&1!=a.length&&(n.unsubscribeElementEvents(k,{progress:x,loadedmetadata:q,canplay:u}),b(k),e(1))},q=function(a){a=[];for(var b=0;b<k.buffered.length;b++)a.push([k.buffered.start(b),k.buffered.end(b)]);for(progress=b=0;b<k.buffered.length;b++)progress+=1/k.duration*(a[b][1]-a[b][0]);e(progress)},x=function(a){g(a);q(a)},u=function(a){d.canPlay=!0;g(a)};n.subscribeElementEvents(k,{progress:x,
loadedmetadata:q,canplay:u,error:a(f,c)});var E=function(a,b,g){var d=n.createSource();d.addEventListener("error",c,!1);d.type=g;d.src=b;a.appendChild(d)};try{var w=d.url.substring(d.url.lastIndexOf(".")+1);E(k,f,"ogg"===w?"audio/ogg":"audio/mp3");n.appendToBody(k)}catch(y){c(y)}}},function(a){d.audio=a;d.ready=!0;d.shouldPlayWhenReady&&(d.play(d.shouldPlayParams.ltime,d.shouldPlayParams.duration),d.shouldPlayWhenReady=!1);c.muted&&d.mute()},function(a){f.error(a?a.message||a:"Unknown error")})};
e.prototype.play=function(a,b){if(this.playing)return!1;if(this.ready){this.playing=!0;var c=this.offset+a;m?c>this.audio.duration?this._audio_is_playing=!1:(this._source=m.createBufferSource(),this._source.buffer=this.audio,this._gain=m.createGain(),this._source.connect(this._gain),this._gain.connect(m.destination),this._gain.gain.value=this.volume,this._source.play?this._source.play(0,c):this._source.start?this._source.start(0,c,this._source.buffer.duration-c):this._source.noteGrainOn(0,c,this._source.buffer.duration-
c)):(this.audio.currentTime=c,this.audio.volume=this.volume,this.audio.play())}else this.shouldPlayWhenReady=!0,this.shouldPlayParams={ltime:a,duration:b}};e.prototype.stop=function(){if(this.playing){try{m?(this._source.stop?this._source.stop(0):this._source.noteOff(0),this._source=null):(this.audio.pause(),this.audio.volume=0)}catch(a){}this.playing=!1}};e.prototype.stopIfNotMaster=function(){this.master||this.stop()};e.prototype.setVolume=function(a){if(this.muted)this.unmuteVolume=a;else return this.volume=
a,this._gain?this._gain.gain.value=a:this.audio&&(this.audio.volume=a),this};e.prototype.mute=function(){this.muted||(this.unmuteVolume=this.volume,this.setVolume(0),this.muted=!0)};e.prototype.unmute=function(){this.muted&&(this.muted=!1,this.setVolume(this.unmuteVolume))};e.prototype.toggleMute=function(){this.muted?this.unmute():this.mute()};e.prototype.connect=function(a,b){var d=this;a.on(c.X_START,function(){d.play.apply(d,arguments)});a.on(c.X_STOP,function(){d.stopIfNotMaster()});var e=function(){d.stop()};
b.on(c.A_STOP,e);b.on(c.A_PAUSE,e)};e.prototype.clone=function(){var a=new e("");a.url=this.url;a.offset=this.offset;return a};z.exports=e}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../conf.js":11,"../constants.js":12,"../errors.js":13,"../log.js":28,"../resource_manager.js":35,"../utils.js":39,engine:40}],30:[function(d,z,r){function b(a,b,c){this.url=a;this.formats=b;this.size=c;this.playing=this.ready=!1}function e(a,
b){return function(c){b(Error("Failed to load video file from "+a+" with error code: "+(c&&c.currentTarget&&c.currentTarget.error)?c.currentTarget.error.code:"Unknown"))}}d("../conf.js");var a=d("../log.js"),f=d("../constants.js");d("../errors.js");var c=d("engine"),n=d("../resource_manager.js"),h=d("../graphics/bounds.js");b.prototype.connect=function(a,b){var c=this;a.on(f.X_START,function(){c.play.apply(c,arguments)});var d=function(){c.stop()};a.on(f.X_STOP,d);b.on(f.A_STOP,d);b.on(f.A_PAUSE,
d)};b.prototype.load=function(b,d){var f=this;n.loadOrGet(b,f.url,function(a,b,d){var h=c.checkMediaUrl(f.url),t=f.formats,n=c.createVideo(f.size[0],f.size[1]);n.setAttribute("preload","auto");n.style.display="none";var u=function(b){1==n.buffered.length&&4===n.readyState&&(c.unsubscribeElementEvents(n,{progress:v,loadedmetadata:w,canplay:k}),a(n),d(1))},w=function(a){a=[];for(var b=0;b<n.buffered.length;b++)a.push([n.buffered.start(b),n.buffered.end(b)]);for(var c=b=0;b<n.buffered.length;b++)c+=
1/n.duration*(a[b][1]-a[b][0]);d(c)},v=function(a){u(a);w(a)},k=function(a){f.canPlay=!0;u(a)};c.subscribeElementEvents(n,{progress:v,loadedmetadata:w,canplay:k,error:e(h,b)});var g=function(a,g,d){var k=c.createSource();k.addEventListener("error",b,!1);k.type=d;k.src=g;a.appendChild(k)};try{t?t.length&&t.forEach(function(a){g(n,c.checkMediaUrl(a[0]),a[1])}):g(n,h,"video/mp4"),c.appendToBody(n)}catch(q){b(q)}},function(a){f.video=a;f.ready=!0;f.size||(f.size=[a.width,a.height])},function(b){a.error(b?
b.message||b:"Unknown error")})};b.prototype.apply=function(a){this.video&&a.drawImage(this.video,0,0,this.video.videoWidth,this.video.videoHeight,0,0,this.size[0],this.size[1])};b.prototype.bounds=function(){return this.$bounds?this.$bounds:this.video?this.$bounds=new h(0,0,this.video.width,this.video.height):h.NONE};b.prototype.inside=function(a){return!0};b.prototype.play=function(a,b){if(!this.ready||this.playing)return!1;this.playing=!0;this.video.currentTime=(this.offset||0)+a;this.video.play()};
b.prototype.stop=function(){this.playing&&(this.video.pause(),this.playing=!1)};b.prototype.invalidate=function(){this.$bounds=null};b.prototype.dispose=function(){};b.prototype.clone=function(){var a=new b(this.url);a.offset=this.offset;return a};z.exports=b},{"../conf.js":11,"../constants.js":12,"../errors.js":13,"../graphics/bounds.js":16,"../log.js":28,"../resource_manager.js":35,engine:40}],31:[function(d,z,r){var b=d("./errors.js"),e={register:function(a,d){if(e[a])throw b.system("Module "+
a+" is already registered!");e[a]=d},get:function(a){return e[a]},isAccessible:function(a){return"undefined"!==typeof e[a]}};z.exports=e},{"./errors.js":13}],32:[function(d,z,r){function b(){this.id="";this.controls=this.ctx=this.canvas=this.anim=this.state=null;this.__canvasPrepared=!1;this.__instanceNum=++b.__instances;this.muted=!1}var e=d("./constants.js"),a=d("./utils.js"),f=a.is,c=d("./global_opts.js");d("./conf.js");var n=d("./log.js");r=d("./events.js").provideEvents;var h=d("./loc.js"),u=
h.Strings,w=h.Errors,m=d("./errors.js"),y=d("engine"),x=d("./resource_manager.js"),p=d("./player_manager.js"),A=d("./loader.js"),t=d("./ui/controls.js"),B=d("./animation/animation.js"),C=d("./animation/element.js"),F=d("./render.js"),v=d("./graphics/sheet.js");b.__instances=0;b.PREVIEW_POS=0;b.PEFF=0;b.NO_TIME=-1;b.DEFAULT_CONFIGURATION={debug:!1,repeat:void 0,autoPlay:!1,mode:e.M_VIDEO,zoom:1,speed:1,width:void 0,height:void 0,infiniteDuration:void 0,drawStill:void 0,audioEnabled:!0,volume:1,imagesEnabled:!0,
videoEnabled:!0,shadowsEnabled:!0,handleEvents:void 0,controlsEnabled:void 0,controlsInvisible:void 0,infoEnabled:void 0,loadingMode:e.LM_DEFAULT,thumbnail:void 0,bgColor:void 0,ribbonsColor:void 0,forceAnimationSize:!1,stretchToCanvas:!1,muteErrors:!1};b.EMPTY_BG="rgba(0,0,0,.05)";b.prototype.init=function(c,d){this.viewId=a.getObjectId();y.isDocReady()||n.warn(w.P.DOM_NOT_READY);this._initHandlers();this.on(e.S_ERROR,this.__onerror());if(this.canvas||this.wrapper)throw m.player(w.P.INIT_TWICE,this);
if(this.anim)throw m.player(w.P.INIT_AFTER_LOAD,this);this._prepare(c);this._addOpts(b.DEFAULT_CONFIGURATION);this._addOpts(y.extractUserOptions(this.canvas));this._addOpts(y.extractUserOptions(this.wrapper));try{window&&window.frameElement&&this._addOpts(y.extractUserOptions(window.frameElement))}catch(k){}this._addOpts(d||{});this._postInit();this._checkOpts();p.fire(e.S_NEW_PLAYER,this);return this};b.prototype.load=function(b,c,d,k){var v=this,t=v.state;if(t.happens===e.PLAYING||t.happens===e.PAUSED)throw m.player(w.P.COULD_NOT_LOAD_WHILE_PLAYING,
v);var h,p,u;if(b&&b.id&&v.anim&&v.anim.id==b.id)n.info("Animation with ID="+b.id+" is already loaded in player, skipping the call");else{var y=!1;if(c&&c.IMPORTER_ID||d&&d.IMPORTER_ID)throw m.player(w.P.IMPORTER_CONSTRUCTOR_PASSED,v);f.fun(c)?u=c:f.num(c)||!c?(f.num(c)&&(h=c,y=!0),f.obj(d)?(p=d,u=k):f.fun(d)&&(u=d)):f.obj(c)&&(p=c,u=d);if(v.loadingMode!=e.LM_ONPLAY||v._playLock){if(!b)throw v.anim=null,v._reset(),v.stop(),m.player(w.P.NO_ANIMATION_PASSED,v);if(!v.__canvasPrepared)throw m.player(w.P.CANVAS_NOT_PREPARED,
v);v._reset();t.happens=e.LOADING;v.fire(e.S_CHANGE_STATE,e.LOADING);c=function(b){var c=v.anim;v.__subscribePlayingEvents(c);v.handleEvents&&v.__subscribeDynamicEvents(c);var g=c._collectRemoteResources(v);g.length?(t.happens=e.RES_LOADING,v.fire(e.S_CHANGE_STATE,e.RES_LOADING),v.fire(e.S_RES_LOAD,g),x.subscribe(v.id,g,[function(c,g){v.anim===b&&a.postpone(function(){v.state.happens=e.LOADING;v.fire(e.S_CHANGE_STATE,e.LOADING);v.fire(e.S_LOAD,b);v._updateMediaVolumes();v.handleEvents||v.stop();v._callPostpones();
u&&u.call(v,b);v._applyTimeOptionsIfSet()})}],function(a,b,c,g){v.fire(e.S_LOADING_PROGRESS,b);v.controlsEnabled&&v.controls&&(v.controls.loadingProgress=c,v.controls.loadingErrors=g)}),c._loadRemoteResources(v)):(v.fire(e.S_LOAD,b),v.handleEvents||v.stop(),u&&u.call(v,b),v._applyTimeOptionsIfSet())};v.anim&&(v.__unsubscribePlayingEvents(v.anim),v.__unsubscribeDynamicEvents(v.anim),v.anim.traverse(function(a){a.removeMaskCanvases()}));b?b instanceof B?(v._loadTarget=e.LT_ANIMATION,A.loadAnimation(v,
b,c)):f.arr(b)||b instanceof C?(v._loadTarget=e.LT_ELEMENTS,A.loadElements(v,b,c)):f.str(b)?(v._loadTarget=e.LT_URL,v._loadSrc=b,A.loadFromUrl(v,b,p,c)):(v._loadTarget=e.LT_IMPORT,A.loadFromObj(v,b,p,c)):(v._loadTarget=e.LT_ANIMATION,v.anim=new B,c(v.anim));y&&(v.anim.duration=h);return v}if(v._postponedLoad)throw m.player(w.P.LOAD_WAS_ALREADY_POSTPONED,v);v._lastReceivedAnimationId=null;v._postponedLoad=[b,h,p,u];v.stop()}};y.getRequestFrameFunc();var k=y.getCancelFrameFunc();b.prototype.play=function(a,
c,d){var k=this;k._ensureHasState();var f=k.state;if(f.happens!==e.PLAYING||!k.infiniteDuration)if(k.loadingMode!==e.LM_ONPLAY||k._lastReceivedAnimationId)if(k.loadingMode===e.LM_ONREQUEST&&f.happens===e.RES_LOADING)k._postpone("play",arguments);else{k._ensureHasAnim();var v=k.anim;f.happens===e.STOPPED&&v.reset();f.__lastPlayConf=[a,c,d];f.from=a||0;f.time=b.NO_TIME;f.speed=(c||1)*(k.speed||1)*(v.speed||1);f.stop="undefined"!==typeof d?d:f.stop;f.duration=k.infiniteDuration?Infinity:v.duration||
(v.isEmpty()?0:B.DEFAULT_DURATION);if(void 0===f.duration)throw m.player(w.P.DURATION_IS_NOT_KNOWN,k);f.__startTime=Date.now();f.__redraws=0;f.__rsec=0;f.__prevt=0;f.happens!==e.STOPPED||k.repeating||k.fire(e.S_REPORT_STATS);y.getAnmProps(k.ctx).factor=this.factor();f.happens=e.PLAYING;f.__lastReq=F.loop(k.ctx,k,v,k.__beforeFrame(v),k.__afterFrame(v),k.__userBeforeRender,k.__userAfterRender);k.fire(e.S_CHANGE_STATE,e.PLAYING);k.fire(e.S_PLAY,f.from);return k}else if(!k._playLock){k._playLock=!0;var f=
k._postponedLoad,t=arguments;if(!f)throw m.player(w.P.NO_LOAD_CALL_BEFORE_PLAY,k);var h=f[3];f[3]=function(){h&&h.apply(k,arguments);k._postponedLoad=null;k._playLock=!1;k._lastReceivedAnimationId=k.anim.id;b.prototype.play.apply(k,t)};b.prototype.load.apply(k,f)}};b.prototype.stop=function(){this._ensureHasState();var a=this.state;if(a.happens===e.RES_LOADING&&this.loadingMode===e.LM_ONREQUEST)this._postpone("stop",arguments);else{a.happens!==e.PLAYING&&a.happens!==e.PAUSED||k(a.__lastReq);a.time=
b.NO_TIME;a.from=0;a.stop=b.NO_TIME;var c=this.anim;c||this.loadingMode==e.LM_ONPLAY&&this._postponedLoad?(a.happens=e.STOPPED,this._drawStill(),this.fire(e.S_CHANGE_STATE,e.STOPPED)):a.happens!==e.ERROR&&(a.happens=e.NOTHING,this.controls||this._drawSplash(),this.fire(e.S_CHANGE_STATE,e.NOTHING));this.fire(e.S_STOP);c&&c.reset();return this}};b.prototype.pause=function(){if(this.state.happens===e.RES_LOADING&&this.loadingMode===e.LM_ONREQUEST)return this._postpone("pause",arguments),this;this._ensureHasState();
this._ensureHasAnim();var a=this.state;if(a.happens===e.STOPPED)return this.anim.reset(),this;a.happens===e.PLAYING&&(k(a.__lastReq),this.anim.handlePause());a.time>a.duration&&(a.time=a.duration);a.from=a.time;a.happens=e.PAUSED;a.time!==b.NO_TIME&&this.drawAt(a.time);this.fire(e.S_CHANGE_STATE,e.PAUSED);this.fire(e.S_PAUSE,a.time);return this};b.prototype.seek=function(a){return this.state.happens===e.PAUSED?this.play(a).pause():this.pause().play(a)};b.prototype.onerror=function(a){this.__err_handler=
a;return this};r(b,[e.S_IMPORT,e.S_CHANGE_STATE,e.S_LOAD,e.S_RES_LOAD,e.S_PLAY,e.S_PAUSE,e.S_STOP,e.S_COMPLETE,e.S_REPEAT,e.S_ERROR,e.S_LOADING_PROGRESS,e.S_TIME_UPDATE,e.S_INTERACTIVITY,e.S_REPORT_STATS]);b.prototype._prepare=function(c){if(!c)throw m.player(w.P.NO_WRAPPER_PASSED,this);var d;if(f.str(c)){if(d=y.getElementById(c),!c)throw m.player(a.strf(w.P.NO_WRAPPER_WITH_ID,[c]),this);}else c.id||(c.id="anm-player-"+b.__instances),d=c;c=y.assignPlayerToWrapper(d,this,"anm-player-"+b.__instances);
this.id=c.id;this.wrapper=c.wrapper;this.canvas=c.canvas;if(!y.checkPlayerCanvas(this.canvas))throw m.player(w.P.CANVAS_NOT_VERIFIED,this);this.ctx=y.getContext(this.canvas,"2d");this.state=b.createState(this);this.fire(e.S_CHANGE_STATE,e.NOTHING);this.subscribeEvents(this.canvas);this.__canvasPrepared=!0};b.prototype._addOpts=function(a){this.debug=f.defined(a.debug)?a.debug:this.debug;this.repeat=f.defined(a.repeat)?a.repeat:this.repeat;this.autoPlay=f.defined(a.autoPlay)?a.autoPlay:this.autoPlay;
this.startFrom=f.defined(a.startFrom)?a.startFrom:this.startFrom;this.stopAt=f.defined(a.stopAt)?a.stopAt:this.stopAt;this.zoom=a.zoom||this.zoom;this.speed=a.speed||this.speed;this.bgColor=a.bgColor||this.bgColor;this.width=a.width||this.width;this.height=a.height||this.height;this.ribbonsColor=a.ribbonsColor||this.ribbonsColor;this.thumbnailSrc=a.thumbnail||this.thumbnailSrc;this.loadingMode=f.defined(a.loadingMode)?a.loadingMode:this.loadingMode;this.audioEnabled=f.defined(a.audioEnabled)?a.audioEnabled:
this.audioEnabled;this.globalVolume=f.defined(a.volume)?a.volume:this.globalVolume;this.imagesEnabled=f.defined(a.imagesEnabled)?a.imagesEnabled:this.imagesEnabled;this.videoEnabled=f.defined(a.videoEnabled)?a.videoEnabled:this.videoEnabled;this.shadowsEnabled=f.defined(a.shadowsEnabled)?a.shadowsEnabled:this.shadowsEnabled;this.controlsEnabled=f.defined(a.controlsEnabled)?a.controlsEnabled:this.controlsEnabled;this.controlsInvisible=f.defined(a.controlsInvisible)?a.controlsInvisible:this.controlsInvisible;
this.infoEnabled=f.defined(a.infoEnabled)?a.infoEnabled:this.infoEnabled;this.handleEvents=f.defined(a.handleEvents)?a.handleEvents:this.handleEvents;this.drawStill=f.defined(a.drawStill)?a.drawStill:this.drawStill;this.infiniteDuration=f.defined(a.infiniteDuration)?a.infiniteDuration:this.infiniteDuration;this.forceAnimationSize=f.defined(a.forceAnimationSize)?a.forceAnimationSize:this.forceAnimationSize;this.stretchToCanvas=f.defined(a.stretchToCanvas)?a.stretchToCanvas:this.stretchToCanvas;this.muteErrors=
f.defined(a.muteErrors)?a.muteErrors:this.muteErrors;f.defined(a.mode)&&this.mode(a.mode)};b.prototype._checkOpts=function(){if(this.canvas){if(!this.width||!this.height){var a=y.getCanvasSize(this.canvas);this.width=a[0];this.height=a[1]}this._resize(this.width,this.height);this.bgColor&&y.setCanvasBackground(this.canvas,this.bgColor);this.anim&&this.handleEvents&&this.__subscribeDynamicEvents(this.anim);this.controlsEnabled&&!this.controls?(this._enableControls(),this.infoEnabled?this._enableInfo():
this._disableInfo()):!this.controlsEnabled&&this.controls&&(this._disableInfo(),this._disableControls());this.ctx&&(y.getAnmProps(this.ctx).skip_shadows=!this.shadowsEnabled);this.thumbnailSrc&&this.thumbnail(this.thumbnailSrc)}};b.prototype._postInit=function(){this.stop();var a=y.hasUrlToLoad(this.wrapper);a.url||(a=y.hasUrlToLoad(this.canvas));if(a.url){var b=null;a.importer_id&&anm.importers.isAccessible(a.importer_id)&&(b=anm.importers.create(a.importer_id));this.load(a.url,b)}};b.prototype.mode=
function(a){this.infiniteDuration=a&e.M_INFINITE_DURATION||void 0;this.handleEvents=a&e.M_HANDLE_EVENTS||void 0;this.controlsEnabled=a&e.M_CONTROLS_ENABLED||void 0;this.infoEnabled=a&e.M_INFO_ENABLED||void 0;this.drawStill=a&e.M_DRAW_STILL||void 0;return this};b.prototype.rect=function(a){if(!a)return{x:this.x,y:this.y,width:this.width,height:this.height};this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;this._moveTo(a.x,a.y);this._resize(a.width,a.height);return this};b.prototype.forceRedraw=
function(){switch(this.state.happens){case e.STOPPED:this.stop();break;case e.PAUSED:this.anim&&this.drawAt(this.state.time);break;case e.PLAYING:this.anim&&this._stopAndContinue();break;case e.NOTHING:this.controls||this._drawSplash()}};b.prototype.drawAt=function(c){if(c===b.NO_TIME)throw m.player(w.P.PASSED_TIME_VALUE_IS_NO_TIME,this);if(this.state.happens===e.RES_LOADING&&this.loadingMode===e.LM_ONREQUEST)this._postpone("drawAt",arguments);else{if(0>c||!this.infiniteDuration&&c>this.anim.duration)throw m.player(a.strf(w.P.PASSED_TIME_NOT_IN_RANGE,
[c]),this);var d=this.anim,k=this.__userBeforeRender,f=this.__userAfterRender;y.getAnmProps(this.ctx).factor=this.factor();d.__informEnabled=!1;F.at(c,0,this.ctx,this.anim,this.width,this.height,this.zoom,this.ribbonsColor,this.stretchToCanvas,k,function(a,b){f&&f(a,b);d.reset();d.__informEnabled=!0});return this}};b.prototype.size=function(a,b){if(!f.defined(a))return[this.width,this.height];this.__userSize=[a,b];this._resize();return this};b.prototype.factor=function(){return this.anim?this.anim.width===
this.width&&this.anim.height===this.height?1:Math.min(this.width/this.anim.width,this.height/this.anim.height):void 0};b.prototype.factorData=function(){if(this.anim){var b=a.fit_rects(this.width,this.height,this.anim.width,this.anim.height);return{factor:b[0],anim_rect:b[1],ribbon_one:b[2]||null,ribbon_two:b[3]||null}}};b.prototype.thumbnail=function(b,c,d){if(!b)return this.thumbnailSrc;var k=this;if(!(k.__thumbLoading||k.__thumb&&k.__thumb.src==b)){if(k.ctx){var f=y.PX_RATIO,t=k.ctx;t.save();t.clearRect(0,
0,k.width*f,k.height*f);t.restore()}var h=new v(b);k.__thumbLoading=!0;h.load(a.guid(),k,function(){k.__thumbLoading=!1;k.__thumb=h;if(c||d)k.__thumbSize=[c,d];k.state.happens!==e.PLAYING&&k.state.happens!==e.PAUSED&&k._drawStill()},function(){return!0})}};b.prototype.detach=function(){y.playerAttachedTo(this.wrapper,this)&&(p.fire(e.S_PLAYER_DETACH,this),this.stop(),this.controls&&this.controls.detach(this.wrapper),y.detachPlayer(this),this.ctx&&y.clearAnmProps(this.ctx),this._reset(),x.cancel(this.id))};
b.prototype.attachedTo=function(a){return y.playerAttachedTo(a,this)};b.prototype.isAttached=function(){return y.playerAttachedTo(this.wrapper,this)};b.attachedTo=function(a,b){return y.playerAttachedTo(a,b)};b.prototype.invalidate=function(){this.controls&&this.controls.update(this.canvas)};b.__invalidate=function(a){return function(b){a.invalidate()}};b.prototype.beforeFrame=function(a){if(this.state.happens===e.PLAYING)throw m.player(w.P.BEFOREFRAME_BEFORE_PLAY,this);this.__userBeforeFrame=a};
b.prototype.afterFrame=function(a){if(this.state.happens===e.PLAYING)throw m.player(w.P.AFTERFRAME_BEFORE_PLAY,this);this.__userAfterFrame=a};b.prototype.beforeRender=function(a){if(this.state.happens===e.PLAYING)throw m.player(w.P.BEFORENDER_BEFORE_PLAY,this);this.__userBeforeRender=a};b.prototype.afterRender=function(a){if(this.state.happens===e.PLAYING)throw m.player(w.P.AFTERRENDER_BEFORE_PLAY,this);this.__userAfterRender=a};b.prototype.subscribeEvents=function(a){var d=b.__invalidate(this);y.subscribeWindowEvents({load:d});
y.subscribeCanvasEvents(a,{mouseover:function(a){return function(b){c.autoFocus&&a.handleEvents&&a.canvas&&a.canvas.focus();return!0}}(this),mouseout:function(a){return function(b){c.autoFocus&&a.handleEvents&&a.canvas&&a.canvas.blur();return!0}}(this)})};b.prototype.mute=function(){this.muted||this.toggleMute()};b.prototype.unmute=function(){this.muted&&this.toggleMute()};b.prototype.toggleMute=function(){this.muted=!this.muted;this.anim&&this.anim.traverse(function(a){a.$audio&&a.$audio.toggleMute()})};
b.prototype.volume=function(a){if("undefined"===typeof a)return this.globalVolume;this.globalVolume=a;this._updateMediaVolumes()};b.prototype._updateMediaVolumes=function(){var a=this;a.anim&&a.anim.traverse(function(b){b.$audio&&b.$audio.setVolume(a.globalVolume)})};b.prototype._drawEmpty=function(){var a=this.ctx,c=this.width,d=this.height;a.save();var k=y.PX_RATIO;a.fillStyle=b.EMPTY_BG;a.fillRect(0,0,c*k,d*k);a.restore()};b.prototype._drawStill=function(){var a=this.state,c=this.anim;this.drawStill?
this.__thumb?this._drawThumbnail():c&&(!this.infiniteDuration&&f.finite(c.duration)?this.drawAt(c.duration*b.PREVIEW_POS):this.drawAt(a.from)):this._drawEmpty()};b.prototype._drawThumbnail=function(){var b=this.__thumbSize||this.__thumb.bounds(),c=b.width,d=b.height,k=this.width,e=this.height,f=y.PX_RATIO,b=this.ctx;b.save();1!=f&&b.scale(f,f);if(c!=k||d!=e){e=a.fit_rects(k,e,c,d);c=e[0];d=e[1];k=e[2];e=e[3];if(k||e)b.fillStyle=this.ribbonsColor||"#000",k&&b.fillRect(k[0],k[1],k[2],k[3]),e&&b.fillRect(e[0],
e[1],e[2],e[3]);d&&(b.beginPath(),b.rect(d[0],d[1],d[2],d[3]),b.clip(),b.translate(d[0],d[1]));1!=c&&b.scale(c,c)}this.__thumb.apply(b);b.restore()};b.prototype._drawSplash=function(){this.controls||this.__thumbLoading||this.__thumb&&this.drawStill&&this._drawThumbnail()};b.prototype._drawLoadingSplash=function(a){if(!this.controls){this._drawSplash();var b=this.ctx;b.save();b.setTransform(1,0,0,1,0,0);b.fillStyle="#006";b.font="12px sans-serif";b.fillText(a||u.LOADING,20,25);b.restore()}};b.prototype._drawErrorSplash=
function(a){if(this.canvas&&this.ctx&&!this.controls){this._drawSplash();var b=this.ctx;b.save();b.setTransform(1,0,0,1,0,0);b.fillStyle="#006";b.font="14px sans-serif";b.fillText(u.ERROR+(a?": "+(a.message||typeof Error):"")+".",20,25);b.restore()}};b.prototype.toString=function(){return"[ Player '"+this.id+"' ]"};b.prototype._reset=function(){var a=this.state;this.loadingMode===e.LM_ONREQUEST&&a.happens===e.RES_LOADING&&(this._clearPostpones(),x.cancel(this.id));a.happens=e.NOTHING;a.from=0;a.time=
b.NO_TIME;a.duration=void 0;this.fire(e.S_CHANGE_STATE,e.NOTHING);this.controls&&this.controls.reset();this.ctx.clearRect(0,0,this.width*y.PX_RATIO,this.height*y.PX_RATIO)};b.prototype._stopAndContinue=function(){var a=this.state,b=a.__lastPlayConf,a=a.time;this.stop();this.play(a,b[1],b[2])};b.prototype._moveTo=function(a,b){y.setCanvasPosition(this.canvas,a,b)};b.prototype._resize=function(a,b){var c=this.canvas,d=this.__userSize||[a,b],k=y.getCanvasParameters(c);if(!k||k[0]!==d[0]||k[1]!==d[1])return d[0]&&
d[1]||(d=k),y.setWrapperSize(this.wrapper,d[0],d[1]),y.setCanvasSize(c,d[0],d[1]),this.width=d[0],this.height=d[1],y.updateCanvasOverlays(c),this.ctx&&(y.getAnmProps(this.ctx).factor=this.factor()),this.controls&&this.controls.handleAreaChange(),this.forceRedraw(),d};b.prototype._restyle=function(a){y.setCanvasBackground(this.canvas,a);this.forceRedraw()};b.prototype._enableControls=function(){this.controls||(this.controls=new t(this));this.controls.enable()};b.prototype._disableControls=function(){this.controls&&
(this.controls.disable(),this.controls=null)};b.prototype._enableInfo=function(){this.controls&&this.controls.enableInfo()};b.prototype._disableInfo=function(){this.controls&&this.controls.disableInfo()};b.prototype.__subscribePlayingEvents=function(a){if(!this.__anim_handlers||!this.__anim_handlers[a.id]){var b={};b[e.A_START]=this.on(e.S_PLAY,function(){a.fire(e.A_START)});b[e.A_PAUSE]=this.on(e.S_PAUSE,function(){a.fire(e.A_PAUSE)});b[e.A_STOP]=this.on(e.S_STOP,function(){a.fire(e.A_STOP)});this.__anim_handlers||
(this.__anim_handlers={});this.__anim_handlers[a.id]=b}};b.prototype.__unsubscribePlayingEvents=function(a){if(this.__anim_handlers){var b=this.__anim_handlers[a.id];b&&(this.unbind(e.S_PLAY,b[e.A_START]),this.unbind(e.S_PAUSE,b[e.A_PAUSE]),this.unbind(e.S_STOP,b[e.STOP]),this.__anim_handlers[a.id]=null)}};b.prototype.__subscribeDynamicEvents=function(a){c.setTabindex&&y.setTabIndex(this.canvas,this.__instanceNum);if(a){var b=!1;if(this.__boundTo)for(var d=0,k=this.__boundTo,f=k.length;d<f;d++)a.id===
k[d][0]&&this.canvas===k[d][1]&&(b=!0);else this.__boundTo=[];b||(this.__boundTo.push([a.id,this.canvas]),a.on(e.X_ERROR,this.__onerror()),a.subscribeEvents(this.canvas))}};b.prototype.__unsubscribeDynamicEvents=function(a){c.setTabindex&&y.setTabIndex(this.canvas,void 0);if(a&&this.__boundTo){for(var b=-1,d=0,k=this.__boundTo,e=k.length;d<e;d++)a.id===k[d][0]&&(b=d,a.unsubscribeEvents(k[d][1]));0<=b&&this.__boundTo.splice(b,1)}};b.prototype._ensureHasState=function(){if(!this.state)throw m.player(w.P.NO_STATE,
this);};b.prototype._ensureHasAnim=function(){if(!this.anim)throw m.player(w.P.NO_ANIMATION,this);};b.prototype.__beforeFrame=function(a){return function(a,c,d,g){return function(k){d.clearAllLaters();if(c.happens!==e.PLAYING)return!1;if(c.stop!==b.NO_TIME&&k>=c.from+c.stop||f.finite(c.duration)&&k>c.duration+b.PEFF)return a.fire(e.S_COMPLETE),c.time=0,a.stop(),a.repeat||!f.defined(a.repeat)&&d.repeat?(a.repeating=!0,a.play(),a.fire(e.S_REPEAT)):!a.infiniteDuration&&f.finite(c.duration)&&a.drawAt(c.duration),
!1;g&&g(k,a.ctx);return!0}}(this,this.state,a,this.__userBeforeFrame)};b.prototype.__afterFrame=function(a){return function(a,b,c,d){return function(a){d&&d(a);c.invokeAllLaters();return!0}}(this,this.state,a,this.__userAfterFrame)};b.prototype.__onerror=function(){var a=this;return function(b){return a.__onerror_f(b)}};b.prototype.__onerror_f=function(a){var b=this.muteErrors,b=b&&!(a instanceof m.SystemError);try{this.state&&(this.state.happens=e.ERROR),this.__lastError=a,this.fire(e.S_CHANGE_STATE,
e.ERROR),this.anim=null}catch(c){throw c;}try{!this.state||this.state.happens==e.NOTHING&&this.state.happens==e.STOPPED||this.__unsafe_stop()}catch(c){}b=this.__err_handler&&this.__err_handler(a)||b;if(!b){try{this._drawErrorSplash(a)}catch(c){}throw a;}};b.prototype._clearPostpones=function(){this._queue=[]};b.prototype._postpone=function(a,b){this._queue||(this._queue=[]);this._queue.push([a,b])};b.prototype._callPostpones=function(){if(this._queue&&this._queue.length)for(var a=this._queue,b,c=
0,d=a.length;c<d;c++)b=a[c],this[b[0]].apply(this,b[1]);this._queue=[]};b.createState=function(a){return{happens:e.NOTHING,time:b.NO_TIME,from:0,stop:b.NO_TIME,afps:0,speed:1,duration:void 0,__startTime:-1,__redraws:0,__rsec:0}};b.forSnapshot=function(a,c,d,k,e){var f=new b;f.init(a,e);f.load(c,d,k);return f};b.prototype._applyUrlParamsToAnimation=function(a){f.defined(a.t)?(this.state.happens===e.PLAYING&&this.stop(),this.play(a.t/100)):f.defined(a.from)?(this.state.happens===e.PLAYING&&this.stop(),
this.play(a.from/100)):f.defined(a.p)?(this.state.happens===e.PLAYING&&this.stop(),this.play(a.p/100).pause()):f.defined(a.at)&&(this.state.happens===e.PLAYING&&this.stop(),this.play(a.at/100).pause())};b.prototype._applyTimeOptionsIfSet=function(){this.autoPlay?(this.state.happens===e.PLAYING&&this.stop(),this.play(this.startFrom||this.state.from||0)):this.startFrom?(this.state.happens===e.PLAYING&&this.stop(),this.play(this.startFrom)):this.stopAt&&this.pause(this.stopAt)};z.exports=b},{"./animation/animation.js":3,
"./animation/element.js":6,"./conf.js":11,"./constants.js":12,"./errors.js":13,"./events.js":14,"./global_opts.js":15,"./graphics/sheet.js":22,"./loader.js":26,"./loc.js":27,"./log.js":28,"./player_manager.js":33,"./render.js":34,"./resource_manager.js":35,"./ui/controls.js":36,"./utils.js":39,engine:40}],33:[function(d,z,r){function b(){this.hash={};this.instances=[];this._initHandlers()}r=d("./events.js");var e=d("./constants.js");d=d("engine");r.provideEvents(b,[e.S_NEW_PLAYER,e.S_PLAYER_DETACH]);
b.prototype.filterEvent=function(a,b){a==e.S_NEW_PLAYER&&(this.hash[b.id]=b,this.instances.push(b));return!0};b.prototype.getPlayer=function(a){return this.hash[a]};b.prototype.handleDocumentHiddenChange=function(a){var b,d;for(b=0;b<this.instances.length;b++)d=this.instances[b],a&&d.state.happens===e.PLAYING?(d._pausedViaHidden=!0,d.pause()):!a&&d._pausedViaHidden&&(d._pausedViaHidden=!1,d.play(d.state.from))};var a=new b;d.onDocumentHiddenChange(function(b){a.handleDocumentHiddenChange(b)});z.exports=
a},{"./constants.js":12,"./events.js":14,engine:40}],34:[function(d,z,r){function b(a,d,h,t,m,n,u){"undefined"===typeof y[d.id]&&(y[d.id]=0);var v=d.state;if(v.happens===c.PLAYING){var k=Date.now()-v.__startTime,g=k/1E3*v.speed+v.from,q=g-v.__prevt;v.time=g;v.__dt=q;v.__prevt=g;if(!t||t(g))if(0===v.__rsec&&(v.__rsec=k),1E3<=k-v.__rsec&&(v.afps=v.__redraws,v.__rsec=k,v.__redraws=0),v.__redraws++,e(g,q,a,h,d.width,d.height,d.zoom,d.ribbonsColor,d.stretchToCanvas,n,u),d.debug&&f(a,v.afps,g),!m||m(g))return y[d.id]+=
q,1<=y[d.id]&&(d.fire(c.S_TIME_UPDATE,g),y[d.id]=0),v.__lastReq=w(function(){b(a,d,h,t,m,n,u)})}}function e(b,c,d,e,f,h,m,v,k,g,q){d.save();var n=u.PX_RATIO;1!==n&&d.scale(n,n);f|=0;h|=0;n=f!=e.width||h!=e.height;e.factor=1*(m||1)*(e.zoom||1);var w=k?f/e.width*m:m,y=k?h/e.height*m:m;!n||k?(d.clearRect(0,0,e.width,e.height),g&&g(b,d),1==w&&1==y||d.scale(w,y),e.render(d,b,c),q&&q(b,d),d.restore()):a(d,e,f,h,e.width,e.height,v,function(a){d.clearRect(0,0,e.width,e.height);g&&g(b,d);1==w&&1==y||d.scale(w,
y);e.render(d,b,c);q&&q(b,d);d.restore()})}function a(a,b,c,d,e,f,h,v){f=m(c,d,e,f);c=f[0];d=f[1];e=f[2];f=f[3];a.save();if(e||f)a.save(),a.fillStyle=h||"#000",e&&(a.clearRect(e[0],e[1],e[2],e[3]),a.fillRect(e[0],e[1],e[2],e[3])),f&&(a.clearRect(f[0],f[1],f[2],f[3]),a.fillRect(f[0],f[1],f[2],f[3])),a.restore();d&&(a.beginPath(),u.isIE10&&(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])),a.rect(d[0],d[1],d[2],d[3]),a.clip(),a.translate(d[0],d[1]));b.factor*=c;
1!=c&&a.scale(c,c);v(c);a.restore()}function f(a,b,c){a.fillStyle="#999";a.font="20px sans-serif";a.fillText(Math.floor(b),8,20);a.font="10px sans-serif";a.fillText(Math.floor(1E3*c)/1E3,8,35)}var c=d("./constants.js");r=d("./animation/painter.js");var n=d("./animation/modifier.js"),h=d("./graphics/brush.js"),u=d("engine"),w=u.getRequestFrameFunc(),m=d("./utils.js").fit_rects;d={};var y={};d.loop=b;d.at=e;d.drawFPS=f;d.p_drawVisuals=new r(function(a){this.applyVisuals(a)},c.PNT_SYSTEM);d.p_applyAComp=
new r(function(a){this.applyAComp(a)},c.PNT_SYSTEM);d.p_drawBounds=new r(function(a,b){var c=this.myBounds();if(c&&!this.isEmpty()){var d=this.isEmpty()?"#f00":"#600",e=c.width,c=c.height;a.save();a.beginPath();a.lineWidth=1;a.strokeStyle=d;a.moveTo(0,0);a.lineTo(e,0);a.lineTo(e,c);a.lineTo(0,c);a.lineTo(0,0);a.closePath();a.stroke();a.restore()}},c.PNT_DEBUG);d.p_drawPivot=new r(function(a,b){if(b=b||this.$pivot){var c=this.myBounds(),d=this.isEmpty()?"#600":"#f00";a.save();c&&a.translate(b[0]*c.width,
b[1]*c.height);a.beginPath();a.lineWidth=1;a.strokeStyle=d;a.moveTo(0,-10);a.lineTo(0,0);a.moveTo(3,0);a.arc(0,0,3,0,2*Math.PI,!0);a.closePath();a.stroke();a.restore()}},c.PNT_DEBUG);d.p_drawReg=new r(function(a,b){if(b=b||this.$reg)a.save(),a.lineWidth=1,a.strokeStyle="#00f",a.fillStyle="rgba(0,0,255,.3)",a.translate(b[0],b[1]),a.beginPath(),a.moveTo(-4,-4),a.lineTo(4,-4),a.lineTo(4,4),a.lineTo(-4,4),a.lineTo(-4,-4),a.closePath(),a.stroke(),a.beginPath(),a.moveTo(0,-10),a.lineTo(0,0),a.moveTo(3,
0),a.closePath(),a.stroke(),a.restore()},c.PNT_DEBUG);d.p_drawName=new r(function(a,b){if(b=b||this.name)a.save(),a.fillStyle="#666",a.font="12px sans-serif",a.fillText(b,0,10),a.restore()},c.PNT_DEBUG);d.p_drawMPath=new r(function(a,b){if(b=b||this.$mpath)a.save(),h.qstroke(a,"#600",2),a.beginPath(),b.apply(a),a.closePath(),a.stroke(),a.restore()},c.PNT_DEBUG);d.m_checkBand=new n(function(a,b,c){if(c[0]>b*a||c[1]<b*a)return!1},c.MOD_SYSTEM);z.exports=d},{"./animation/modifier.js":7,"./animation/painter.js":8,
"./constants.js":12,"./graphics/brush.js":17,"./utils.js":39,engine:40}],35:[function(d,z,r){function b(b){a.logResMan&&f.debug(b)}function e(){this._cache={};this._errors={};this._waiting={};this._subscriptions={};this._onprogress={};this._url_to_subjects={}}var a=d("./conf.js"),f=d("./log.js"),c=d("./utils.js").is,n=d("./errors.js");e.prototype.subscribe=function(a,d,e,f){if(!a)throw n.system("Subject ID is empty");if(this._subscriptions[a])throw n.system("This subject ('"+a+"') is already subscribed to a bunch of resources, please group them in one.");
var y=[];b("subscribing "+e.length+" to "+d.length+" urls: "+d);for(var x={},p=0;p<d.length;p++)d[p]&&!x[d[p]]&&(x[d[p]]=!0,y.push(d[p]),this._url_to_subjects[d[p]]||(this._url_to_subjects[d[p]]=[]),this._url_to_subjects[d[p]].push(a));b("filtered from "+d.length+" to "+y.length);this._subscriptions[a]=[y,c.arr(e)?e:[e]];f&&(this._onprogress[a]=function(a){var b={},c=1/a.length,d=0,e=0;return function(a,k){var g=b[a]||0;-1!==k?(d+=(k-g)*c,b[a]=k):(d-=g,e+=g);f(a,k,d,e)}}(y))};e.prototype.loadOrGet=
function(a,c,d,e,f){var x=this;if(!a)throw n.system("Subject ID is empty");if(!c)throw n.system("Given URL is empty");var p=x._onprogress[a];b("request to load "+c);x._cache[c]?(b("> already received, trigerring success"),a=x._cache[c],e&&e(a),x.trigger(c,a),p&&p(c,1)):x._errors[c]?(b("> failed to load before, notifying with error"),f&&f(x._errors[c]),p&&p(c,-1)):x._waiting[a]&&x._waiting[a]&&x._waiting[a][c]?(b("> someone is already waiting for it, subscribing"),d=a,x._subscriptions[a]&&x._onprogress[a]&&
(d=a+"-"+Math.floor((new Date).getTime()+1E3*Math.random()),x._onprogress[d]=x._onprogress[a]),x.subscribe(d,[c],function(a){a[0]?(e(a[0]),p&&p(c,1)):(f(a[0]),p&&p(c,-1))})):(b("> not cached, requesting"),x._waiting[a]||(x._waiting[a]={}),x._waiting[a][c]=d,d(function(a){a=a||!0;b("file at "+c+" succeeded to load, triggering success");x.trigger(c,a);e&&e(a);p&&p(c,1);x.check()},function(a){b("file at "+c+" failed to load, triggering error");x.error(c,a);f&&f(a);p&&p(c,-1);x.check()},p?function(a){p(c,
a)}:function(){}))};e.prototype.trigger=function(a,c){if(this._cache[a]||this._errors[a])this.check();else{b("triggering success for url "+a);var d=this._url_to_subjects[a];if(d)for(var e=0,f=d.length;e<f;e++)this._waiting[d[e]]&&delete this._waiting[d[e]][a];this._cache[a]=c}};e.prototype.error=function(a,c){if(this._cache[a]||this._errors[a])this.check();else{b("triggering error for url "+a);var d=this._url_to_subjects[a];if(d)for(var e=0,f=d.length;e<f;e++)this._waiting[d[e]]&&delete this._waiting[d[e]][a];
this._errors[a]=c}};e.prototype.has=function(a){return"undefined"!==typeof this._cache[a]};e.prototype.check=function(){b("checking subscriptions");var a=this._subscriptions,c=this._cache,d=this._errors,e=null,f;for(f in a){b("subscription group '"+f+"'");var n=a[f][0],p=a[f][1],r=0,t=0,B;B=0;for(ul=n.length;B<ul;B++)d[n[B]]&&r++,c[n[B]]&&t++;b("success: "+t+", errors: "+r+", ready: "+(t+r===n.length));if(t+r===n.length){t=[];B=0;for(ul=n.length;B<ul;B++)t.push(c[n[B]]||d[n[B]]);b("notifying subscribers that "+
n+" are all ready");n=0;for(B=p.length;n<B;n++)p[n](t,r);e||(e=[]);e.push(f)}}if(e)for(c=0,d=e.length;c<d;c++)b("removing notified subscribers for subject '"+e[c]+"' from queue"),delete a[e[c]]};e.prototype.cancel=function(a){if(!a)throw n.system("Subject ID is empty");if(this._waiting[a]){var b=this._subscriptions[a][0];if(b)for(var c=0,d=b.length;c<d;c++)delete this._waiting[a][b[c]]}delete this._subscriptions[a]};e.prototype.clear=function(){this._cache={};this._errors={};this._waiting={};this._loaders=
{};this._subscriptions={}};z.exports=new e},{"./conf.js":11,"./errors.js":13,"./log.js":28,"./utils.js":39}],36:[function(d,z,r){function b(b){this.player=b;this.ctx=this.canvas=null;this.bounds=[];this.info=this.theme=null;this.invisible=b.controlsInvisible;this.state={happens:a.NOTHING,mpos:{x:0,y:0},alpha:1,click:!1,changed:!0,time:0,gtime:0,fadeTimer:0,fadeMode:0,mouseInteractedAt:0}}var e=d("../utils.js"),a=d("../constants.js");d("../loc.js");var f=d("engine");d("./infoblock.js");var c=b.DEFAULT_THEME=
d("./controls_theme.json");b.THEME=b.DEFAULT_THEME;b.LAST_ID=0;b.prototype.update=function(a){var c=this.canvas;c?f.updateOverlay(a,c):(c=f.addCanvasOverlay("ctrls-"+b.LAST_ID,a,[0,0,1,1],function(b){f.registerAsControlsElement(b,a)}),b.LAST_ID++,this.id=c.id,this.canvas=c,this.ctx=f.getContext(c,"2d"),this.subscribeEvents(c),this.changeTheme(b.THEME),this.setupRenderLoop());this.handleAreaChange();this.info&&this.info.update(a)};b.prototype.subscribeEvents=function(){var b=this;b.player.on(a.S_CHANGE_STATE,
function(a){b.state.happens=a;b.state.changed=!0});f.subscribeCanvasEvents(b.canvas,{mouseenter:function(a){b.handleMouseEnter(a)},mousemove:function(a){b.handleMouseMove(a)},mouseleave:function(a){b.handleMouseLeave()},mousedown:function(a){b.handleClick();f.preventDefault(a)},click:f.preventDefault,dblclick:f.preventDefault})};b.prototype.checkMouseTimeout=function(c){this.state.mouseInteracted?(this.state.mouseInteractedAt=c,this.state.mouseInteracted=!1,this.state.autoHidden=!1,this.show()):this.state.autoHidden||
!(c-this.state.mouseInteractedAt>this.theme.fadeTimes.idle)||this.state.happens!==a.PLAYING&&this.state.happens!==a.PAUSED||b.isInProgressArea(this.state.mpos,this.bounds[2],this.bounds[3])||(this.hide(),this.state.autoHidden=!0)};b.prototype.checkFade=function(a){var b=this.state,d=b.fadeMode,e=!1,f=b.alpha;0!==d&&(e=!0,b.fadeTimer-=a,f=1===d?Math.min(1,1-b.fadeTimer/c.fadeTimes.fadein):Math.max(0,b.fadeTimer/c.fadeTimes.fadeout),b.alpha=f,0>=b.fadeTimer&&(b.fadeTimer=0,b.fadeMode=0));return e};
b.prototype.render=function(b){this.checkMouseTimeout(b);var d=b-this.state.gtime;this.state.gtime=b;this.state.time=this.player.state.time;if(!this.invisible&&this.bounds&&this.state.changed){this.rendering=!0;b=this.checkFade(d);var d=this.state,n=this.player,h=d.happens,v=d.mpos,k=d.time,g=this.ctx,q=this.theme,u=this.player.state.duration,r=k/(0!==u?u:1),E=this.bounds[2],z=this.bounds[3],G=f.PX_RATIO;g.save();g.setTransform(1,0,0,1,0,0);1!=G&&g.scale(G,G);g.clearRect(0,0,E,z);g.globalAlpha=d.alpha;
if(h===a.PLAYING)u&&(m(g,q,E,z,r),g.save(),G=z-c.bottomControls.height,g.fillStyle=c.button.color,g.fillRect(9,G+3,3,9),g.fillRect(15,G+3,3,9),g.restore(),p(g,q,E,z,k,u,r,v),x(g,E,z,n.muted));else if(h===a.STOPPED)w(g,q,E,z),y(g,q,E,z,this.focused),d.changed=!1;else if(h===a.PAUSED)u&&(m(g,q,E,z,r),g.save(),G=z-c.bottomControls.height,g.strokeStyle="transparent",g.fillStyle=c.button.color,g.beginPath(),g.moveTo(9,G+3),g.lineTo(18,G+7),g.lineTo(9,G+11),g.lineTo(9,G+3),g.closePath(),g.fill(),g.restore(),
p(g,q,E,z,k,u,r,v),x(g,E,z,n.muted)),w(g,q,E,z),y(g,q,E,z,this.focused),d.changed=!1;else if(h===a.NOTHING)d.changed=!1;else if(h===a.LOADING||h===a.RES_LOADING){if(q=this.loadingProgress,n=this.loadingErrors,q||n)g.translate(0,z-c.loading.factorLineWidth),g.strokeStyle=c.loading.factorBackColor,g.lineWidth=c.loading.factorLineWidth,g.beginPath(),g.moveTo(0,0),g.lineTo(E,0),g.stroke(),g.strokeStyle=c.loading.factorDoneColor,g.beginPath(),g.moveTo(0,0),g.lineTo(E*q,0),g.stroke(),n&&(g.strokeStyle=
c.loading.factorErrorColor,g.moveTo(E*q,0),g.lineTo(E*n,0),g.stroke())}else h===a.ERROR&&(w(g,q,E,z),n=n.__lastError,g.save(),g.translate(E/2,z/2),g.rotate(Math.PI/4),g.strokeStyle="transparent",g.fillStyle=q.button.color,g.fillRect(-25,-3,50,6),g.fillRect(-3,-25,6,50),g.restore(),A(g,q,E/2,z/2*(1+q.circle.radius),1.2*q.font.statussize,n&&n.message?e.ell_text(n.message,q.error.statuslimit):n,q.error.color),d.changed=!1);g.restore();this.info&&(h!==a.NOTHING?(this._infoShown=!0,this.info.render()):
this._infoShown=!1);d.changed|=b;this.rendering=!1}};b.prototype.react=function(){if(!this.hidden){var d=this.player,f=this.state.happens,n=c.progress.buttonWidth;if(f!==a.NOTHING&&f!==a.LOADING&&f!==a.ERROR){var h=this.state.mpos,v=this.bounds[2],k=this.bounds[3];if(!this.invisible&&b.isInProgressArea(h,v,k)){if(h.x>n&&h.x<v-n){time=e.roundTo(d.state.duration*(h.x-n)/(v-2*n),1);time>d.anim.duration&&(time=d.anim.duration);d.seek(time);this.state.time=time;return}if(h.x>v-n){d.toggleMute();return}}f===
a.STOPPED?d.play(0):f===a.PAUSED?d.play(this.state.time):f===a.PLAYING&&d.pause()}}};b.prototype.handleAreaChange=function(){this.player&&this.player.canvas&&(this.bounds=f.getCanvasBounds(this.canvas))};b.prototype.handleMouseMove=function(c){this.state.mouseInteracted=!0;c=f.getEventPosition(c,this.canvas);this.state.mpos.x=c.x;this.state.mpos.y=c.y;if(this.state.happens===a.PLAYING||this.state.happens===a.PAUSED)b.isInProgressArea(this.state.mpos,this.bounds[2],this.bounds[3])?(this.state.changed=
!0,this.state.mouseInProgressArea=!0):(this.state.mouseInProgressArea&&(this.state.changed=!0),this.state.mouseInProgressArea=!1)};b.prototype.handleClick=function(){this.state.changed=!0;this.state.mouseInteracted=!0;this.show();this.react()};b.prototype.handleMouseEnter=function(){this.show();this.forceNextRedraw()};b.prototype.handleMouseLeave=function(){this.state.happens!==a.PLAYING&&this.state.happens!==a.PAUSED||this.hide()};b.prototype.hide=function(){0!==this.state.alpha&&2!==this.state.fadeMode&&
(this.state.fadeMode=2,this.state.fadeTimer=c.fadeTimes.fadeout-this.state.fadeTimer,this.state.changed=!0)};b.prototype.show=function(){1!==this.state.alpha&&1!==this.state.fadeMode&&(this.state.fadeMode=1,this.state.fadeTimer=c.fadeTimes.fadein-this.state.fadeTimer,this.state.changed=!0)};b.prototype.reset=function(){this.info&&this.info.reset()};b.prototype.detach=function(a){this.stopRenderLoop();f.detachElement(a,this.canvas);this.info&&this.info.detach(a);this.ctx&&f.clearAnmProps(this.ctx)};
b.prototype.changeTheme=function(a){this.theme=a;this.state.changed=!0};b.prototype.forceNextRedraw=function(){this.state.changed=!0};b.prototype.enable=function(){this.update(this.player.canvas)};b.prototype.disable=function(){this.hide();this.detach(this.player.wrapper)};b.prototype.enableInfo=function(){};b.prototype.disableInfo=function(){};var n=f.getRequestFrameFunc(),h=f.getCancelFrameFunc(),u=null;b.prototype.setupRenderLoop=function(){var a=this,b=function(c){a.render.call(a,c);u=n(b)};u=
n(b)};b.prototype.stopRenderLoop=function(){u&&h(u)};b.isInProgressArea=function(a,b,d){return a.y<=d&&a.y>=d-c.bottomControls.height};var w=function(a,b,c,d,e){a.save();c/=2;d/=2;a.beginPath();a.fillStyle=b.circle.color;a.arc(c,d,b.circle.radius,0,2*Math.PI);a.fill();a.restore()},m=function(a,b,c,d,e){a.save();var k=b.progress.buttonWidth,g=b.bottomControls.height;a.fillStyle=b.progress.backColor;a.fillRect(0,d-g,c,g);a.fillStyle=b.progress.inactiveColor;a.fillRect(k,d-10,c-2*k,5);c=Math.round(e*
(c-2*k));a.fillStyle=b.progress.activeColor;a.fillRect(k,d-10,c,5);a.restore()},y=function(a,b,c,d,e){a.save();c/=2;d/=2;a.strokeStyle="transparent";a.fillStyle=b.button.color;a.beginPath();a.moveTo(c-12,d-20);a.lineTo(c-12,d+20);a.lineTo(c+18,d);a.lineTo(c-12,d-20);a.closePath();a.fill();a.restore()},x=function(a,b,d,e){a.save();b-=c.progress.buttonWidth;d-=c.bottomControls.height;a.strokeStyle="transparent";a.lineWidth=1;a.fillStyle=c.button.color;a.beginPath();a.translate(b,d);a.moveTo(3,6);a.lineTo(6,
6);a.lineTo(12,3);a.lineTo(12,12);a.lineTo(6,9);a.lineTo(3,9);a.lineTo(3,6);a.closePath();a.fill();a.lineWidth=1;a.strokeStyle=c.button.color;a.beginPath();if(e)a.moveTo(15,5),a.lineTo(21,10),a.moveTo(15,10),a.lineTo(21,5),a.stroke();else for(e=0;3>e;e++)a.beginPath(),a.moveTo(15+3*e,3),a.bezierCurveTo(18+3*e,7,18+3*e,8,15+3*e,12),a.stroke();a.restore()},p=function(a,c,d,f,v,k,g,q){var n=c.progress.buttonWidth;b.isInProgressArea(q,d,f)&&q.x>n&&q.x<d-n&&(g=(q.x-n)/(d-2*n),v=Math.round(k*g));k=n+Math.round(g*
(d-2*n));a.beginPath();a.fillStyle=c.progress.backColor;a.strokeStyle="transparent";a.clearRect(0,f-40,d,20);d=Math.min(Math.max(1,k-17),d-35);k=f-40;g=d+34;q=k+20;a.moveTo(d+3,k);a.lineTo(g-3,k);a.quadraticCurveTo(g,k,g,k+3);a.lineTo(g,k+20-3);a.quadraticCurveTo(g,q,g-3,q);a.lineTo(d+3,q);a.quadraticCurveTo(d,q,d,q-3);a.lineTo(d,k+3);a.quadraticCurveTo(d,k,d+3,k);a.moveTo(d+17-3,k+20);a.lineTo(d+17,k+20+3);a.lineTo(d+17+3,k+20);a.closePath();a.fill();A(a,c,d+17,f-30,8,e.fmt_time(v))},A=function(a,
b,c,d,e,k,g,f){a.save();a.font=b.font.weight+" "+Math.floor(e||15)+"pt "+b.font.face;a.textAlign=f||"center";a.textBaseline="middle";a.fillStyle=g||b.font.color;a.fillText(k,c,d);a.restore()};z.exports=b},{"../constants.js":12,"../loc.js":27,"../utils.js":39,"./controls_theme.json":37,"./infoblock.js":38,engine:40}],37:[function(d,z,r){z.exports={font:{face:"Arial, sans-serif",weight:"bold",timesize:13.5,statussize:8.5,infosize_a:10,infosize_b:8,color:"white"},circle:{radius:40,color:"rgba(0,0,0,0.7)"},
bottomControls:{height:15},progress:{backColor:"rgba(0,0,0,0.7)",activeColor:"white",inactiveColor:"rgba(255,255,255,0.5)",buttonWidth:27},button:{color:"white"},loading:{factorBackColor:"rgba(0,0,0,0.7)",factorDoneColor:"rgba(255,255,255,0.8)",factorErrorColor:"rgba(255,0,0,0.8)",factorLineWidth:14},fadeTimes:{fadein:300,fadeout:300,idle:2500},error:{statusLimit:40,color:"darkred"}}},{}],38:[function(d,z,r){z.exports=function(b,d){}},{}],39:[function(d,z,r){(function(b){function e(){}d("./constants.js");
d("./errors.js");var a={defined:function(a){return!("undefined"===typeof a||null===a||void 0===a)}};a.finite=b.isFinite;a.nan=b.isNaN;a.arr=Array.isArray;a.integer=function(b){return a.num(b)&&Math.floor(b)==b};a.num=function(d){d=b.parseFloat(d);return!a.nan(d)&&a.finite(d)};a.fun=function(a){return"function"===typeof a};a.obj=function(a){return"object"===typeof a};a.str=function(a){return"string"===typeof a};a.not_empty=function(a){return Object.keys?0<Object.keys(a).length:0<Object.getOwnPropertyNames(a).length};
a.modifier=function(a){return a instanceof anm.Modifier};a.painter=function(a){return a instanceof anm.Painter};a.tween=function(b){return a.modifier(b)&&b.is_tween};a.equal=function(b,c){if(b===c)return!0;if(!(b instanceof Object&&c instanceof Object)||b.constructor!==c.constructor)return!1;for(var d in b)if(b.hasOwnProperty(d)&&(!c.hasOwnProperty(d)||b[d]!==c[d]&&("object"!==typeof b[d]||!a.equal(b[d],c[d]))))return!1;for(d in c)if(c.hasOwnProperty(d)&&!b.hasOwnProperty(d))return!1;return!0};z.exports=
{fmt_time:function(b){if(!a.finite(b))return"\u221e";var c=Math.abs(b),d=Math.floor(c/3600),e=Math.floor((c-3600*d)/60),c=Math.floor(c-3600*d-60*e);return(0>b?"-":"")+(0<d?(10>d?"0"+d:d)+":":"")+(10>e?"0"+e:e)+":"+(10>c?"0"+c:c)},ell_text:function(a,b){if(!a)return"";var d=a.length;if(d<=b)return a;var e=Math.floor(d/2)-2;return a.slice(0,e)+"..."+a.slice(d-e)},compareFloat:function(a,b,d){0!==d&&(d=d||2);d=Math.pow(10,d);return Math.round(a*d)==Math.round(b*d)},roundTo:function(a,b){if(!b)return Math.round(a);
var d=Math.pow(10,b);return Math.round(a*d)/d},interpolateFloat:function(a,b,d){return a*(1-d)+b*d},paramsToObj:function(a){var b={};a=a.split("&");for(var d=a.length,e;d--;)e=a[d].split("="),b[e[0]]=e[1];return b},obj_clone:function(a){var b={},d;for(d in a)b[d]=a[d];return b},mrg_obj:function(b,c,d){if(!c)return b;d=d||{};for(var e in c)d[e]=a.defined(b[e])?b[e]:c[e];return d},strf:function(b,c){return b.replace(/{(\d+)}/g,function(b,d){return a.defined(c[d])?c[d]:b})},guid:function(){return Math.random().toString(36).substring(2,
10)+Math.random().toString(36).substring(2,10)},fit_rects:function(a,b,d,e){var u=a/d,w=b/e,m=Math.min(u,w);a=(a-d*m)/2;var r=(b-e*m)/2,x=d*m,p=e*m;return 1!=u||1!=w?(e=[a,r,x,p],0!==a?[m,e,[0,0,a,b],[a+x,0,a,b]]:0!==r?[m,e,[0,0,d,r],[0,r+p,d,r]]:[m,e]):[1,[0,0,d,e]]},is:a,iter:function(a){if(a.__iter)return a.__iter.reset(),a.__iter;var b=0,d=a.length;return a.__iter={next:function(){if(b<d)return a[b++];b=0;throw new e;},hasNext:function(){return b<d},remove:function(){d--;return a.splice(--b,1)},
reset:function(){b=0;d=a.length},get:function(){return a[b]},each:function(a,b){for(this.reset();this.hasNext();)!1===a(this.next())&&(b?b(this.remove()):this.remove())}}},keys:function(a,b){if(Object.keys)for(var d=Object.keys(a),e=0;e<d.length&&!1!==b(d[e],a[d[e]]);e++);else for(d in a)if(!1===b(d,a[d]))break},removeElement:function(b,c){if(a.arr(b)){var d=b.indexOf(c);-1<d&&b.splice(d,1)}else b[c]=null},postpone:function(a){setTimeout(a,0)},makeApiUrl:function(a,b,d){var e="//"+a+".animatron.com"+
b;a="//"+a+".animatron-test.com"+b;var u=b=!1;"string"===typeof d?(b=-1!==d.indexOf("animatron-test.com"),u=-1!==d.indexOf("animatron.com")):window&&window.location&&(d=window.location.hostname,b=-1!==d.indexOf("animatron-test.com"),u=-1!==d.indexOf("animatron.com"));if(b)return a;if(u)return e},getObjectId:function(){return((new Date).getTime()/1E3|0).toString(16)+"xxxxxxxxxxxxxxxx".replace(/[x]/g,function(){return(16*Math.random()|0).toString(16)}).toLowerCase()}}}).call(this,"undefined"!==typeof global?
global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./constants.js":12,"./errors.js":13}],40:[function(d,z,r){(function(b){for(var e="undefined"!==typeof window?window:{},a="undefined"!==typeof window?window.document:{},f="undefined"!==typeof b?b:{},c={},n=f.requestAnimationFrame,h=f.cancelAnimationFrame,u=0,w=["ms","moz","webkit","o"],m=0;m<w.length&&!f.requestAnimationFrame;++m)n=f[w[m]+"RequestAnimationFrame"],h=f[w[m]+"CancelAnimationFrame"]||f[w[m]+"CancelRequestAnimationFrame"];
n||(n=function(a,b){var c=(new Date).getTime(),d=Math.max(0,16-(c-u)),f=e.setTimeout(function(){a(c+d)},d);u=c+d;return f});h||(h=function(a){clearTimeout(a)});c.getRequestFrameFunc=function(){return n};c.getCancelFrameFunc=function(){return h};c.PX_RATIO=e.devicePixelRatio||1;c.ajax=function(a,b,d,f,h,m,n){var p;n="boolean"===typeof n?n:!0;p=c.isIE9?new e.XDomainRequest:new e.XMLHttpRequest;if(!p)throw Error("Failed to create XMLHttp instance");p.onreadystatechange=function(){if(4==p.readyState)if(200==
p.status)b&&b(p);else{var c=Error("AJAX request for "+a+" returned "+p.status+" instead of 200");if(d)d(c,p);else throw c;}};c.isIE9&&(p.onload=function(){b(p)},p.onerror=function(){d&&d(Error("XDomainRequest Error"),p)});p.open(f||"GET",a,n);if(h&&!c.isIE9)for(var t in h)p.setRequestHeader(t,h[t]);p.send(m)};c.getCookie=function(b){var c=a.cookie,d;if(c)for(d=0,c=c.split("; ");d<c.length;d++)if(c[d]=c[d].split("=",2),unescape(c[d][0])==b)return unescape(c[d][1]);return null};c.onDocReady=function(b){if(c.isDocReady())b();
else{var d;a.addEventListener?d=a.addEventListener("DOMContentLoaded",function(){a.removeEventListener("DOMContentLoaded",d,!1);b()},!1):a.attachEvent&&(d=function(){"complete"===a.readyState&&(a.detachEvent("onreadystatechange",d),b())},a.attachEvent("onreadystatechange",d))}};c.isDocReady=function(){return"complete"===a.readyState||"interactive"===a.readyState};c.__stylesTag=null;c.WRAPPER_CLASS="anm-wrapper";c.WRAPPER_INSTANCE_CLASS_PREFIX="anm-wrapper-";c.PLAYER_CLASS="anm-player";c.PLAYER_INSTANCE_CLASS_PREFIX=
"anm-player-";c.CONTROLS_CLASS="anm-controls";c.CONTROLS_INSTANCE_CLASS_PREFIX="anm-controls-";c.INFO_CLASS="anm-controls";c.INFO_INSTANCE_CLASS_PREFIX="anm-controls-";c.ensureGlobalStylesInjected=function(){if(!c.__stylesTag){var b=a.getElementById("anm-player-styles");if(!b){b=a.createElement("style");b.id="anm-player-styles";var e=d("../../res/player.css");b.innerHTML=e;a.head.appendChild(b)}c.__stylesTag=b}};c.injectElementStyles=function(a,b,d){a.classList?(a.classList.add(b),a.classList.add(d)):
a.className=a.className?a.className+(b+" "+d):b+" "+d;a=c.getAnmProps(a);a.gen_class=b;a.inst_class=d};c.__textBuf=a.getElementById("anm-text-measurer");c.createTextMeasurer=function(){var b=c.__textBuf;if(!b)c.onDocReady(function(){var d=a.createElement("div"),e=a.createElement("span");e.id="anm-text-measurer";d.id="anm-text-measurer-container";d.appendChild(e);a.body.appendChild(d);c.__textBuf=e;b=c.__textBuf});return function(a,c){var d="undefined"!==typeof c?c:a.lines;b.style.font=a.$font;b.style.whiteSpace=
"pre";if(anm.utils.is.arr(d)){for(var e=0,f=0,h=0,m=d.length;h<m;h++)b.textContent=d[h]||" ",e=Math.max(b.offsetWidth,e),f+=b.offsetHeight;return[e,f]}b.textContent=d.toString()||"";return[b.offsetWidth,b.offsetHeight]}};c.getElementById=function(b){return a.getElementById(b)};c.findElementPosition=function(a){if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),[a.left,a.top];var b=0,c=0;do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return[b,c]};c.findScrollAwarePosition=function(b){var c=
0,d=0;if(b.getBoundingClientRect){var e=b.getBoundingClientRect();do c+=b!==a.body?b.scrollLeft:a.documentElement.scrollLeft,d+=b!==a.body?b.scrollTop:a.documentElement.scrollTop;while(b=b.offsetParent);return[e.left-c,e.top-d]}do c+=b.offsetLeft-(b!==a.body?b.scrollLeft:a.documentElement.scrollLeft),d+=b.offsetTop-(b!==a.body?b.scrollTop:a.documentElement.scrollTop);while(b=b.offsetParent);return[c,d]};c.moveElementTo=function(a,b,d){var e=c.hasAnmProps(a);(e&&e.inst_rule||a).style.left=0===b?"0":
b+"px";(e&&e.inst_rule||a).style.top=0===d?"0":d+"px"};c.__trashBin=null;c.disposeElement=function(b){var d=c.__trashBin;d||(d=a.createElement("div"),d.id="trash-bin",d.style.display="none",a.body.appendChild(d),c.__trashBin=d);d.appendChild(b);d.innerHTML=""};c.detachElement=function(a,b){(a||b.parentNode).removeChild(b)};c.showElement=function(a){a.style.visibility="visible"};c.hideElement=function(a){a.style.visibility="hidden"};c.clearChildren=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};
c.newCanvas=function(){var b=a.createElement("canvas");b.style.outline="none";return b};c.createCanvas=function(a,b,d,e){var f=c.newCanvas();c.setCanvasSize(f,a,b,e);d&&c.setCanvasBackground(f,d);return f};c.assignPlayerToWrapper=function(b,d,g){if(!b)throw Error("Element passed to anm.Player initializer does not exist.");anm.utils.is.str(b)&&(b=a.getElementById(b));var f="canvas"==b.tagName||"CANVAS"==b.tagName;f&&e.console&&console.warn("NB: A <canvas> tag was passed to the anm.Player as an element to attach to. This is not a recommended way since version 1.2; this <canvas> will be moved inside a <div>-wrapper because of it, so it may break document flow and/or CSS styles. Please pass any container such as <div> to a Player instead of <canvas> to fix it.");
var h=b.cloneNode(!1);g=f?b:c.newCanvas();b=f?a.createElement("div"):b;if(b.getAttribute("anm-player"))throw Error("Player is already attached to element '"+(b.id||g.id)+"'.");b.setAttribute("anm-player",!0);b.hasAttribute("anm-player-target")&&b.removeAttribute("anm-player-target");g.hasAttribute("anm-player-target")&&g.removeAttribute("anm-player-target");var m=g.id;g.id="";b.id||(b.id=m);g.id=b.id+"-cvs";m=c.getAnmProps(g);m.wrapper=b;m.was_before=h;h=b.id;m.id=h;if(f)if(f=g.parentNode||a.body)f.replaceChild(b,
g),b.appendChild(g);else throw Error("Provided canvas tag has no parent");else b.appendChild(g);c.ensureGlobalStylesInjected();c.injectElementStyles(b,c.WRAPPER_CLASS,c.WRAPPER_INSTANCE_CLASS_PREFIX+(h||"no-id"));c.injectElementStyles(g,c.PLAYER_CLASS,c.PLAYER_INSTANCE_CLASS_PREFIX+(h||"no-id"));c.subscribeWrapperToStateChanges(b,d);return{wrapper:b,canvas:g,id:h}};c.playerAttachedTo=function(a,b){if(c.hasAnmProps(a)){var d=c.getAnmProps(a);if(d.wrapper)return d.wrapper.hasAttribute("anm-player")}return a.hasAttribute("anm-player")};
c.findPotentialPlayers=function(){return a.querySelectorAll("[anm-player-target]")};c.hasAnmProps=function(a){return a.__anm};c.getAnmProps=function(a){a.__anm||(a.__anm={});return a.__anm};c.clearAnmProps=function(a){a&&a.__anm&&delete a.__anm};c.detachPlayer=function(b){var d=b.canvas,e=b.wrapper;e&&e.removeAttribute("anm-player");var f=e.parentNode||a.body,h=e.nextSibling,m=c.getAnmProps(d);c.clearChildren(e);m.was_before&&(f.removeChild(e),f.insertBefore(m.was_before,h));c.clearAnmProps(e);c.clearAnmProps(d);
b.controls&&(c.clearAnmProps(b.controls.canvas),b.controls.info&&c.clearAnmProps(b.controls.info.canvas));b.statImg&&c.detachElement(null,b.statImg)};c.getContext=function(a,b){return a.getContext(b)};c.extractUserOptions=function(a){function b(a){if("undefined"!==typeof a){if(null===a)return null;if("0"==a)return!1;if("1"==a)return!0;if("false"==a)return!1;if("true"==a)return!0;if("off"==a)return!1;if("on"==a)return!0;if("no"==a)return!1;if("yes"==a)return!0}}function d(a){return"undefined"===typeof a?
void 0:null===a?null:a?Number.parseFloat(a)/100:0}var e=c.PX_RATIO,f=a.getAttribute("anm-width");f||(f=a.hasAttribute("width")?a.getAttribute("width")/e:void 0);var h=a.getAttribute("anm-height");h||(h=a.hasAttribute("height")?a.getAttribute("height")/e:void 0);return{debug:b(a.getAttribute("anm-debug")),mode:a.getAttribute("anm-mode"),repeat:b(a.getAttribute("anm-repeat")),zoom:a.getAttribute("anm-zoom"),speed:a.getAttribute("anm-speed"),width:f,height:h,autoPlay:b(a.getAttribute("anm-autoplay")||
a.getAttribute("anm-auto-play")),startFrom:d(a.getAttribute("anm-start-from")),stopAt:d(a.getAttribute("anm-stop-at")),bgColor:a.getAttribute("anm-bgcolor")||a.getAttribute("anm-bg-color"),ribbonsColor:a.getAttribute("anm-ribbons")||a.getAttribute("anm-ribcolor")||a.getAttribute("anm-rib-color"),drawStill:b(a.getAttribute("anm-draw-still")||a.getAttribute("anm-draw-thumbnail")||a.getAttribute("anm-draw-thumb")),imagesEnabled:b(a.getAttribute("anm-images")||a.getAttribute("anm-images-enabled")),shadowsEnabled:b(a.getAttribute("anm-shadows")||
a.getAttribute("anm-shadows-enabled")),audioEnabled:b(a.getAttribute("anm-audio")||a.getAttribute("anm-audio-enabled")),controlsEnabled:b(a.getAttribute("anm-controls")||a.getAttribute("anm-controls-enabled")),infoEnabled:b(a.getAttribute("anm-info")||a.getAttribute("anm-info-enabled")),handleEvents:b(a.getAttribute("anm-events")||a.getAttribute("anm-handle-events")),infiniteDuration:b(a.getAttribute("anm-infinite")||a.getAttribute("anm-infinite-duration")),forceSceneSize:b(a.getAttribute("anm-scene-size")||
a.getAttribute("anm-force-scene-size")),inParent:void 0,muteErrors:b(a.getAttribute("anm-mute-errors")),loadingMode:a.getAttribute("anm-loading-mode"),thumbnail:a.getAttribute("anm-thumbnail")}};c.checkPlayerCanvas=function(a){return!0};c.hasUrlToLoad=function(a){return{url:a.getAttribute("anm-url")||a.getAttribute("anm-src"),importer_id:a.getAttribute("anm-importer")}};c.setTabIndex=function(a,b){a.setAttribute("tabindex",b)};c.getCanvasParameters=function(a){if(!c.hasAnmProps(a))return null;a=c.getAnmProps(a);
return a.width&&a.height?[a.width,a.height,c.PX_RATIO]:null};c.getCanvasSize=function(a){return a.getBoundingClientRect?(a=a.getBoundingClientRect(),[a.width,a.height]):[a.getAttribute("clientWidth")||a.clientWidth,a.getAttribute("clientHeight")||a.clientHeight]};c.getCanvasPosition=function(a){return c.findScrollAwarePosition(a)};c.getCanvasBounds=function(a){var b=c.getCanvasParameters(a);if(!b)return null;a=c.getCanvasPosition(a);return[a[0],a[1],b[0],b[1],b[2]]};c.setCanvasSize=function(a,b,d,
e){e=e||c.PX_RATIO;b|=0;d|=0;var f=c.getAnmProps(a);f.ratio=e;f.width=b;f.height=d;a.style.width=b+"px";a.style.height=d+"px";a.setAttribute("width",b*(e||1));a.setAttribute("height",d*(e||1));c._saveCanvasPos(a);return[b,d]};c.setCanvasPosition=function(a,b,d){var e=c.getAnmProps(a);e.usr_x=b;e.usr_y=d;c._saveCanvasPos(a)};c.setCanvasBackground=function(a,b){a.style.backgroundColor=b};c._saveCanvasPos=function(b){var d=a.defaultView&&a.defaultView.getComputedStyle,e=d?parseInt(d(b,null).paddingLeft,
10)||0:0,f=d?parseInt(d(b,null).paddingTop,10)||0:0,h=d?parseInt(d(b,null).borderLeftWidth,10)||0:0,d=d?parseInt(d(b,null).borderTopWidth,10)||0:0,m=a.body.parentNode,n=m.offsetLeft,p=m.offsetTop,t=b,m=e+h+n,w=f+d+p;if(void 0!==t.offsetParent){do m+=t.offsetLeft,w+=t.offsetTop;while(t=t.offsetParent)}m+=e+h+n;w+=f+d+p;b=c.getAnmProps(b);b.offset_left=m||b.usr_x;b.offset_top=w||b.usr_y};c.setWrapperSize=function(a,b,d){b|=0;d|=0;var e=c.getAnmProps(a);e.width=b;e.height=d;a.style.width=b+"px";a.style.height=
d+"px";return[b,d]};c.addCanvasOverlay=function(b,d,g,f){var h=c.getAnmProps(d),m=h.wrapper||d.parentNode||a.body,n=g[0],p=g[1],t=g[2],w=g[3];g=c.getCanvasSize(d);var u=g[0],r=g[1],x=e.getComputedStyle?e.getComputedStyle(d):d.currentStyle;g=parseFloat(x.getPropertyValue("border-left-width"));x=parseFloat(x.getPropertyValue("border-top-width"));t*=u;w*=r;u=c.newCanvas();u.id=h.id?"__"+h.id+"_"+b:"__anm_"+b;b=c.getAnmProps(u);f&&f(u,d);c.setCanvasSize(u,t,w);c.moveElementTo(u,n*t+g,p*w-x);(m||a.body).insertBefore(u,
d.nextSibling);b.ref_canvas=d;h.overlays||(h.overlays=[]);h.overlays.push(u);return u};c.updateCanvasOverlays=function(a){var b=c.getAnmProps(a),d=b.overlays;if(d)for(var e=0,f=d.length;e<f;e++)c.updateOverlay(a,d[e],b)};c.updateOverlay=function(a,b,d){d=d||c.getAnmProps(a);c.setCanvasSize(b,d.width,d.height)};c.registerAsControlsElement=function(a,b){c.injectElementStyles(a,c.CONTROLS_CLASS,c.CONTROLS_INSTANCE_CLASS_PREFIX+(b.id||"no-id"))};c.registerAsInfoElement=function(a,b){c.injectElementStyles(a,
c.INFO_CLASS,c.INFO_INSTANCE_CLASS_PREFIX+(b.id||"no-id"))};c.getEventPosition=function(a,b){if(b){var d=c.findElementPosition(b);return{x:a.clientX-d[0],y:a.clientY-d[1]}}return{x:a.x,y:a.y}};c.subscribeElementEvents=function(a,b){for(var c in b)a.addEventListener(c,b[c],!1)};c.unsubscribeElementEvents=function(a,b){for(var c in b)a.removeEventListener(c,b[c],!1)};c.subscribeWindowEvents=function(a){c.subscribeElementEvents(e,a)};c.subscribeCanvasEvents=c.subscribeElementEvents;c.unsubscribeCanvasEvents=
c.unsubscribeElementEvents;c.keyEvent=function(a){return{key:null!==a.keyCode?a.keyCode:a.which,ch:a.charCode}};c.mouseEvent=function(a,b){return{pos:c.getEventPosition(a,b)}};c.preventDefault=function(a){a.stopPropagation();a.preventDefault()};var r=c.keyEvent,x=c.mouseEvent;c.subscribeAnimationToEvents=function(a,b,d){if(!a.__anm.subscribed||!a.__anm.subscribed[b.id]){a.__anm.handlers||(a.__anm.handlers={});a.__anm.subscribed||(a.__anm.subscribed={});var e=a.__anm.subscribed[b.id]||{click:function(c){b.fire(d.click,
x(c,a))},dblclick:function(c){b.fire(d.dblclick,x(c,a))},mouseup:function(c){b.fire(d.mouseup,x(c,a))},mousedown:function(c){b.fire(d.mousedown,x(c,a))},mousemove:function(c){b.fire(d.mousemove,x(c,a))},keypress:function(a){b.fire(d.keypress,r(a))},keyup:function(a){b.fire(d.keyup,r(a))},keydown:function(a){b.fire(d.keydown,r(a))}};a.__anm.handlers[b.id]=e;a.__anm.subscribed[b.id]=!0;c.subscribeCanvasEvents(a,e)}};c.unsubscribeAnimationFromEvents=function(a,b){if(a.__anm.handlers&&a.__anm.subscribed&&
a.__anm.subscribed[b.id]){var d=a.__anm.handlers[b.id];d&&c.unsubscribeCanvasEvents(a,d)}};c.subscribeWrapperToStateChanges=function(a,b){if(a.classList){var c=anm.constants;b.on(c.S_CHANGE_STATE,function(d){var e=[];switch(d){case c.NOTHING:e=["anm-state-nothing"];break;case c.STOPPED:e=["anm-state-stopped"];break;case c.PLAYING:e=["anm-state-playing"];break;case c.PAUSED:e=["anm-state-paused"];break;case c.LOADING:e=["anm-state-loading"];break;case c.RES_LOADING:e=["anm-state-loading","anm-state-resources-loading"];
break;case c.ERROR:e=["anm-state-error"]}if(e.length){d=a.classList;var f,h;if(b.__prev_classes&&b.__prev_classes.length){var m=b.__prev_classes;f=0;for(h=m.length;f<h;f++)d.remove(m[f])}else d.contains("anm-state-nothing")&&d.remove("anm-state-nothing");f=0;for(h=e.length;f<h;f++)d.add(e[f]);b.__prev_classes=e}})}};c.createStatImg=function(){var b=a.createElement("img");b.style.position="absolute";b.style.top="-9999px";b.style.left="-9999px";b.style.visibility="hidden";a.body.appendChild(b);return b};
c.getWebfontStyleObject=function(){var b=document.getElementById("anm-webfonts");if(b)return b;b=a.createElement("style");b.type="text/css";b.id="anm-webfonts";b.innerHTML="";document.body.appendChild(b);return b};c.createAudio=function(){return a.createElement("audio")};c.createVideo=function(b,c){var d=a.createElement("video");d.width=b;d.height=c;return d};c.createSource=function(){return a.createElement("source")};c.appendToBody=function(b){a.body.appendChild(b)};w=a.createElement?c.newCanvas():
{};c.canvasSupported=!(!w.getContext||!w.getContext("2d"));c.isHttps=e.location&&"https:"===e.location.protocol;var p=e.location&&"file:"===e.location.protocol;c.isLocal=p;c.checkMediaUrl=function(a){return p&&"//"===a.substring(0,2)?(c.isHttps?"https:":"http:")+a:c.isHttps?a.replace("http:","https:"):a};w=(new Function("/*@cc_on return @_jscript_version; @*/"))();c.isIE9=9==w;c.isIE10=10==w;var A,t;"undefined"!==typeof a.hidden?(A="hidden",t="visibilitychange"):"undefined"!==typeof a.mozHidden?(A=
"mozHidden",t="mozvisibilitychange"):"undefined"!==typeof a.msHidden?(A="msHidden",t="msvisibilitychange"):"undefined"!==typeof a.webkitHidden&&(A="webkitHidden",t="webkitvisibilitychange");"undefined"===typeof a[A]&&"undefined"===typeof a.addEventListener||a.addEventListener(t,function(){B&&B(a[A])},!1);var B=null;c.onDocumentHiddenChange=function(a){B=a};c.Path2D=f.Path2D;c.isInIframe=function(){return f.self!==f.top};var C=c.isInIframe()?b:null,F=C?C.document.referrer.split("/",3).join("/"):"*";
c.getIframeOrigin=function(){return F};c.getIframeSrc=function(){return C?C.location.href:null};c.addMessageListener=function(a){f.addEventListener&&f.addEventListener("message",a,!1)};c.postToContentWindow=function(a){C&&C.top.postMessage(JSON.stringify(a),F||"*")};return z.exports=c}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../../res/player.css":2}],41:[function(d,z,r){(function(b){var e=d("./anm/constants.js"),a=d("engine"),
f=d("./anm/player.js");a.onDocReady(function(){for(var b=a.findPotentialPlayers(),c=0,d=b.length;c<d;c++)u.createPlayer(b[c])});var c=d("./anm/animation/element.js"),n=d("./anm/graphics/sheet.js"),h=d("./anm/graphics/segments.js"),u={global:b,constants:e,C:e,loc:d("./anm/loc.js"),errors:d("./anm/errors.js"),utils:d("./anm/utils.js"),conf:d("./anm/conf.js"),log:d("./anm/log.js"),modules:d("./anm/modules.js"),importers:d("./anm/importers.js"),engine:a,events:d("./anm/events.js"),resource_manager:d("./anm/resource_manager.js"),
player_manager:d("./anm/player_manager.js"),Player:f,Animation:d("./anm/animation/animation.js"),Element:c,Clip:c,Modifier:d("./anm/animation/modifier.js"),Tween:d("./anm/animation/tween.js"),Painter:d("./anm/animation/painter.js"),Brush:d("./anm/graphics/brush.js"),Color:d("./anm/graphics/color.js"),Path:d("./anm/graphics/path.js"),MSeg:h.MSeg,LSeg:h.LSeg,CSeg:h.CSeg,Text:d("./anm/graphics/text.js"),Sheet:n,Image:n,shapes:d("./anm/graphics/shapes.js"),Audio:d("./anm/media/audio.js"),Video:d("./anm/media/video.js"),
interop:{playerjs:d("./anm/interop/playerjs-io.js")},createPlayer:function(b,c){if(!a.canvasSupported)return document.getElementById(b).innerHTML=u.loc.Errors.S.SAD_SMILEY_HTML,null;var d=new f;d.init(b,c);return d},createImporter:function(a){window.console&&console.warn("anm.createImporter is deprecated and will be removed soon. Please use anm.importers.create instead");return u.importers.create(a)}};b.anm=u;z.exports=u}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:
"undefined"!==typeof window?window:{})},{"./anm/animation/animation.js":3,"./anm/animation/element.js":6,"./anm/animation/modifier.js":7,"./anm/animation/painter.js":8,"./anm/animation/tween.js":10,"./anm/conf.js":11,"./anm/constants.js":12,"./anm/errors.js":13,"./anm/events.js":14,"./anm/graphics/brush.js":17,"./anm/graphics/color.js":18,"./anm/graphics/path.js":19,"./anm/graphics/segments.js":20,"./anm/graphics/shapes.js":21,"./anm/graphics/sheet.js":22,"./anm/graphics/text.js":23,"./anm/importers.js":24,
"./anm/interop/playerjs-io.js":25,"./anm/loc.js":27,"./anm/log.js":28,"./anm/media/audio.js":29,"./anm/media/video.js":30,"./anm/modules.js":31,"./anm/player.js":32,"./anm/player_manager.js":33,"./anm/resource_manager.js":35,"./anm/utils.js":39,engine:40}],42:[function(d,z,r){"undefined"!==typeof z&&(z.exports=function(){var b=["monospace","sans-serif","serif"],d=document.getElementsByTagName("body")[0],a=document.createElement("span");a.style.fontSize="72px";a.style.position="absolute";a.style.top=
"-9999px";a.style.left="-9999px";a.innerHTML="mmmmmmmmmmlli";var f={},c={},n;for(n in b)a.style.fontFamily=b[n],d.appendChild(a),f[b[n]]=a.offsetWidth,c[b[n]]=a.offsetHeight,d.removeChild(a);this.detect=function(h){var n=!1,w;for(w in b){a.style.fontFamily=h.face+","+b[w];a.style.fontStyle=h.style;a.style.fontWeight=h.weight;d.appendChild(a);var m=a.offsetWidth!=f[b[w]]||a.offsetHeight!=c[b[w]];d.removeChild(a);n=n||m}return n}})},{}],43:[function(d,z,r){function b(){this.m=[1,0,0,1,0,0]}b.prototype.reset=
function(){this.m=[1,0,0,1,0,0]};b.prototype.multiply=function(b){var a=this.m[1]*b.m[0]+this.m[3]*b.m[1],d=this.m[0]*b.m[2]+this.m[2]*b.m[3],c=this.m[1]*b.m[2]+this.m[3]*b.m[3],n=this.m[0]*b.m[4]+this.m[2]*b.m[5]+this.m[4],h=this.m[1]*b.m[4]+this.m[3]*b.m[5]+this.m[5];this.m[0]=this.m[0]*b.m[0]+this.m[2]*b.m[1];this.m[1]=a;this.m[2]=d;this.m[3]=c;this.m[4]=n;this.m[5]=h};b.prototype.invert=function(){var b=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),a=-this.m[1]*b,d=-this.m[2]*b,c=this.m[0]*b,n=
b*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),h=b*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*b;this.m[1]=a;this.m[2]=d;this.m[3]=c;this.m[4]=n;this.m[5]=h};b.prototype.rotate=function(b){var a=Math.cos(b);b=Math.sin(b);var d=this.m[1]*a+this.m[3]*b,c=this.m[0]*-b+this.m[2]*a,n=this.m[1]*-b+this.m[3]*a;this.m[0]=this.m[0]*a+this.m[2]*b;this.m[1]=d;this.m[2]=c;this.m[3]=n};b.prototype.rotateDegrees=function(b){var a=b*Math.PI/180;b=Math.cos(a);var a=Math.sin(a),d=this.m[1]*b+this.m[3]*
a,c=this.m[0]*-a+this.m[2]*b,n=this.m[1]*-a+this.m[3]*b;this.m[0]=this.m[0]*b+this.m[2]*a;this.m[1]=d;this.m[2]=c;this.m[3]=n};b.prototype.translate=function(b,a){this.m[4]+=this.m[0]*b+this.m[2]*a;this.m[5]+=this.m[1]*b+this.m[3]*a};b.prototype.scale=function(b,a){this.m[0]*=b;this.m[1]*=b;this.m[2]*=a;this.m[3]*=a};b.prototype.transformPoint=function(b,a){return{x:b*this.m[0]+a*this.m[2]+this.m[4],y:b*this.m[1]+a*this.m[3]+this.m[5]}};b.prototype.transformPointInverse=function(b,a){this.invert();
var d=this.transformPoint(b,a);this.invert();return d};b.prototype.shear=function(b,a){var d=this.m[1]+this.m[3]*a,c=this.m[0]*b+this.m[2],n=this.m[1]*b+this.m[3];this.m[0]+=this.m[2]*a;this.m[1]=d;this.m[2]=c;this.m[3]=n};b.prototype.apply=function(b){var a=this.m;b.transform(a[0],a[1],a[2],a[3],a[4],a[5])};b.prototype.clone=function(){var d=new b;d.m[0]=this.m[0];d.m[1]=this.m[1];d.m[2]=this.m[2];d.m[3]=this.m[3];d.m[4]=this.m[4];d.m[5]=this.m[5];return d};b.prototype.inverted=function(){var b=
this.clone();b.invert();return b};"undefined"!==typeof z&&(z.exports=b)},{}]},{},[41]);
var AnimatronImporter=function(){function d(a){A.error(a)}function z(a){this.buf=a;this.bitsBuf=this.bitPos=this.pos=0}function r(){}function b(){this.hash2val={}}function e(){}var a=anm.constants,f=anm.Animation,c=anm.Element,n=anm.Path,h=anm.Text,u=anm.Brush,w=anm.Tween,m=anm.Audio,y=anm.Video,x=anm.utils.is,p=anm.utils.roundTo,A=anm.log,t={},B;t._find=function(a,b){b[a]||d("Element with index "+a+" was not found"+(b?" among "+b.length+" elements.":"."));return b[a]};t._type=function(a){return a[0]};
t.project=function(a){anm.conf.logImport&&A.debug(a);B=anm.utils.guid();anm.lastImportedProject=a;anm.lastImportId=B;var c=a.anim.scenes;c.length||d("No scenes found in given project");var e=new f,h=a.anim.elements,m=[0,0];e.__import_id=B;e.meta=t.meta(a);e.fonts=t.fonts(a);t.root=e;t._paths=a.anim.paths||[];t._path_cache=new b;t.anim(a,e);a.meta.duration&&(e.duration=a.meta.duration);var n;a=function(a){var b=a.gband;a.gband=[m[1]+b[0],m[1]+b[1]]};for(var p=0,v=c.length;p<v;p++){n=t._find(c[p],h);
t._type(n)!=C&&d("Given Scene ID "+c[p]+" points to something else");n=t.node(n,null,h,null,e);if(0<p){var w=n.gband;n.gband=[m[1]+w[0],m[1]+w[1]];n.lband=n.gband;n.traverse(a)}m=n.gband;e.add(n)}0<c.length&&(n.gband=[m[0],Infinity],n.lband=n.gband);t._paths=void 0;t._path_cache=void 0;return e};t.meta=function(a){a=a.meta;return{title:a.name,author:a.author,copyright:a.copyright,version:a.version,description:a.description,duration:a.duration,created:a.created,modified:a.modified,_anm_id:a.id}};t.fonts=
function(a){return a.anim.fonts};t.anim=function(a,b){var c=a.anim;b.fps=c.framerate;b.width=c.dimension?Math.floor(c.dimension[0]):void 0;b.height=c.dimension?Math.floor(c.dimension[1]):void 0;b.bgfill=c.background?t.fill(c.background):void 0;b.zoom=c.zoom||1;b.speed=c.speed||1;!c.loop||!0!==c.loop&&"true"!==c.loop||(b.repeat=!0);a.anim.script&&(b.actions=a.anim.script)};var C=2;t.node=function(a,b,c,d,e){var f=t._type(a),h=null;1==f||f==C||9==f||28==f||29==f?h=t.branch(f,a,b,c,e):0!=f&&(h=t.leaf(f,
a,b,d,e));h&&(h._anm_type=f,t.callCustom(h,a,f));return h};L_VISIBLE=4;t.branch=function(b,e,f,h,m){var n=new c;n.name=e[1];var p=b==C?e[3]:e[2],v=[];b===C?(n.gband=[0,e[2]],n.lband=[0,e[2]]):(n.gband=[0,Infinity],n.lband=[0,Infinity]);for(e=p.length;e--;){var u=p[e],r=t._find(u[0],h);if(r&&(r=t.node(r,u,h,n,m))){r.name=u[1];var x=u[6];r.disabled=!(x&L_VISIBLE);var y=9===b&&f&&f[2]?f[2]:[0,0],z=t.band(u[2]);r.lband=[z[0]-y[0],z[1]-y[0]];r.gband=z;r.$pivot=[0,0];r.$reg=u[4]||[0,0];if(u[7]){for(var y=
0,z=Infinity,A=0,B=u[7],F=0,I=B.length;F<I;F++){var H=t.tween(B[F]);H&&(x&1&&H.tween_type===a.T_ROTATE&&(z=Math.min(z,H.$band[0]),A=Math.max(A,H.$band[1]),y++),r.tween(H))}x&1&&(y?(0<z&&Infinity>z&&r.tween(w.rotate().start(0).stop(z).from(0).to(0)),0<A&&Infinity>A&&r.tween(w.rotate().start(A).stop(r.lband[1]-r.lband[0]).from(0).to(0))):r.tween(w.rotate().start(0).stop(Infinity).from(0).to(0)),r.tween(w.rotatetopath().start(0).stop(Infinity)))}u[5]?(r.mode=t.mode(u[5][0]),1<u[5].length&&(r.nrep=u[5][1]||
Infinity)):r.mode=t.mode(null);1===r._anm_type&&r.mode!==a.R_ONCE&&(r.asClip([0,r.lband[1]-r.lband[0]],r.mode,r.nrep),r.lband=[r.lband[0],Infinity],r.gband=[r.gband[0],Infinity],r.mode=a.R_STAY,r.nrep=Infinity);if(u[3])for(x=r,y=u[3],z=v.length,y>z&&(d("No layers collected to apply mask, expected "+y+", got "+z),y=z);y;)v[z-y].mask(x),y--;else n.add(r),v.push(r);t.callCustom(r,u,255);r.$audio&&r.$audio.master&&(r.lband=[r.lband[0],Infinity],r.gband=[r.gband[0],Infinity],n.remove(r),m.add(r))}}if(28===
b)for(n.layer2Bone=Array(p.length),b=n.children.length,f=n.children[b-1],e=f.children.length;e--;)f.children[e].$from=b-f.children[e].$from-1,f.children[e].$to=b-f.children[e].$to-1,n.layer2Bone[f.children[e].$to]=f.children[e];return n};t.leaf=function(b,d,e,f,h){e=new c;if(!d[1]&&(8===b||14===b||26===b))return null;8==b?e.$image=t.sheet(d):4==b?e.$text=t.text(d):14==b?(e.type=a.ET_AUDIO,e.$audio=t.audio(d),e.$audio.connect(e,h)):26==b?(e.type=a.ET_VIDEO,e.$video=t.video(d),e.$video.connect(e,h)):
30==b?(e.$from=d[1],e.$to=d[2]):e.$path=t.path(d);if(e.$path||e.$text)e.$fill=t.fill(d[1]),e.$stroke=t.stroke(d[2]),e.$shadow=t.shadow(d[3]);return e};t.callCustom=function(a,b,d){if(c._customImporters&&c._customImporters.length)for(var e=c._customImporters,f=0,h=e.length;f<h;f++)e[f].call(a,b,d,"ANM",B)};t.band=function(a){if(!a||!a.length)return[0,Infinity];if(1==a.length)return[a[0],Infinity];if(2==a.length)return a;d("Unknown format of band: "+a)};t.path=function(a){if(a=t._pathDecode(a[4]))return new n(a)};
t._pathDecode=function(a){if(x.str(a))return a;if(!x.num(a)||-1==a)return null;a=t._paths[a];if(!a)return null;var b=t._path_cache.get(a);if(!b){b=t._decodeBinaryPath(a);if(!b)return null;t._path_cache.put(a,b)}return b};t._decodeBinaryPath=function(a){var b="";if(a){a=a.replace(/\s/g,"");try{var c=r.decode(a),e=new z(c),c=[0,0];if(e)for(var f=!0;f;){var h;switch(e.readBits(2)){case 0:c=h=t._pathReadPoint(e,c);b+=" M "+h.join(",");break;case 1:c=h=t._pathReadPoint(e,c);b+=" L "+h.join(",");break;
case 2:var m=" C";h=c;for(var n=0;3>n;n++)h=t._pathReadPoint(e,h),m+=" "+h.join(",");c=h;b+=m;break;default:f=!1}}else return d('Unable to decode Path "'+a+'"'),null}catch(p){return d('Unable to decode Path "'+a+'"'),null}}return b};t._pathReadPoint=function(a,b){b=b||[0,0];var c=a.readBits(5);if(0>=c)throw Error("Failed to decode path, wrong length (<= 0)");var d=a.readSBits(c),c=a.readSBits(c);return[p(b[0]+d/1E3,2),p(b[1]+c/1E3,2)]};t.text=function(a){var b=x.arr(a[6])?a:a[6].split("\n");return new h(1<
b.length?b:b[0],a[4],a[5],a[7]&2?"middle":"bottom",a[7]&1?!0:!1)};t.sheet=function(a){var b=new anm.Sheet(a[1]);a[2]&&(b._dimen=a[2]);return b};t.tween=function(a){var b=t.tweentype(a[0]);if(!b)return null;b=w[b](t.tweendata(b,a[3])).band(t.band(a[1]));(a=t.easing(a[2]))&&b.easing(a);return b};t.tweentype=function(b){if(0===b)return a.T_ALPHA;if(1===b)return a.T_ROTATE;if(2===b)return a.T_SCALE;if(3===b)return a.T_SHEAR;if(4===b)return a.T_TRANSLATE;if(7===b)return a.T_VOLUME;if(9===b)return a.T_FILL;
if(10===b)return a.T_STROKE;if(11===b)return a.T_SHADOW;if(12===b)return a.T_SWITCH;if(13===b)return a.T_BONE_ROTATE;if(14===b)return a.T_BONE_LENGTH};t.tweendata=function(b,c){if(null===c)return null;if(b===a.T_TRANSLATE)return t.pathval(c);if(b===a.T_ROTATE||b===a.T_ALPHA||b===a.T_BONE_ROTATE||b===a.T_BONE_LENGTH){if(2==c.length)return c;if(1==c.length)return[c[0],c[0]]}if(b===a.T_SCALE||b===a.T_SHEAR){if(4==c.length)return[[c[0],c[1]],[c[2],c[3]]];if(2==c.length)return[[c[0],c[1]],[c[0],c[1]]];
if(1==c.length)return[[c[0],c[0]],[c[0],c[0]]]}if(b===a.T_FILL)return[t.fill(c[0]),t.fill(c[1])];if(b===a.T_STROKE)return[t.stroke(c[0]),t.stroke(c[1])];if(b===a.T_SHADOW)return[t.shadow(c[0]),t.shadow(c[1])];if(b===a.T_VOLUME){if(2==c.length)return c;if(1==c.length)return[c[0],c[0]]}if(b===a.T_SWITCH)return c};t.easing=function(b){if(!b)return null;if(x.str(b))return{type:a.E_PATH,data:t.pathval("M0 0 "+b+" Z")};if(x.num(b))return{type:a.E_STDF,data:b}};t.mode=function(b){if(!b||0===b)return a.R_ONCE;
if(1===b)return a.R_LOOP;if(2===b)return a.R_BOUNCE;if(3===b)return a.R_STAY};t.fill=function(a){if(!a)return u.fill("transparent");if(x.str(a))return u.fill(a);if(x.arr(a))return x.arr(a[0])?u.fill(t.grad(a)):u.fill(t.pattern(a));d("Unknown type of brush")};t.stroke=function(b){if(!b)return null;var c;x.str(b[1])?c=b[1]:x.arr(b[1])&&(c=x.arr(b[1][0])?t.grad(b[1]):t.pattern(b[1]));return u.stroke(c,b[0],b[2]||a.PC_ROUND,b[3]||a.PC_ROUND,b[4])};t.shadow=function(a){return a?u.shadow(a[3],a[2],a[0],
a[1]):null};t.grad=function(a){var b=a[0],c=a[1];a=a[2];c.length!=a.length&&d("Number of colors do not corresponds to number of offsets in gradient");for(var e=[],f=0;f<a.length;f++)e.push([a[f],c[f]]);if(4==b.length)return{dir:[[b[0],b[1]],[b[2],b[3]]],stops:e};if(6==b.length)return{r:[b[2],b[5]],dir:[[b[0],b[1]],[b[3],b[4]]],stops:e};d("Unknown type of gradient with "+b.length+" points")};var F=["no-repeat","repeat","repeat-x","repeat-y"];t.pattern=function(a){var b=anm.lastImportedProject.anim.elements[a[0]];
if(b=t.leaf(t._type(b),b))return b.alpha=a[5],b.disabled=!0,t.root.add(b),{elm:b,repeat:F[a[1]],w:a[2],h:a[3],bounds:a[4]}};t.pathval=function(a){return new n(t._pathDecode(a))};t.audio=function(a){var b=new m(a[1]);b.offset=a[2];b.master=a[3];return b};t.video=function(a){var b=new y(a[1],a[3],a[4]);b.offset=a[2];return b};z.prototype.readBits=function(a){for(var b=0;;){var c=a-this.bitPos;if(0<c)b|=this.bitBuf<<c,a-=this.bitPos,this.bitBuf=this.readUByte(),this.bitPos=8;else return c=-c,b|=this.bitBuf>>
c,this.bitPos=c,this.bitBuf&=(1<<c)-1,b}};z.prototype.readUByte=function(){return this.buf[this.pos++]&255};z.prototype.readSBits=function(a){var b=this.readBits(a);0!==(b&1<<a-1)&&(b|=-1<<a);return b};r.decode=function(a){return r.str2ab(r._decode(a))};var v=window.Int8Array||Array;r.str2ab=function(a){for(var b=new v(a.length),c=0,d=a.length;c<d;c++)b[c]=a.charCodeAt(c);return b};r._decode=function(a){if(window.atob)return atob(a);var b,c,d,e,f,h=0,m=0;e="";var n=[];if(!a)return a;a+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),
c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),d=b<<18|c<<12|e<<6|f,b=d>>16&255,c=d>>8&255,d&=255,64==e?n[m++]=String.fromCharCode(b):64==f?n[m++]=String.fromCharCode(b,c):n[m++]=String.fromCharCode(b,c,d);while(h<a.length);return e=n.join("")};b.prototype.put=function(a,
b){this.hash2val[this.hash(a)]=b};b.prototype.get=function(a){return this.hash2val[this.hash(a)]};b.prototype.hash=function(a){var b=0,c,d;if(0===a.length)return b;c=0;for(l=a.length;c<l;c++)d=a.charCodeAt(c),b=(b<<5)-b+d,b|=0;return b};e.prototype.load=t.project;e.Import=t;e.IMPORTER_ID="ANM";return e}();anm.importers.register("animatron",AnimatronImporter);
